{"id":"generation-2026-02-12-07-13-55-0c8","title":"Implement issue-tracking CLI create command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4.1 create command)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F1 create, S1-S2)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases 1-3)\n- cmd/cupboard/set.go (generic set command for reference)\n- pkg/types/crumb.go (Crumb struct, SetProperty)\n\n## Files to Create/Modify\n- cmd/cupboard/create.go (create) — issue-tracking create command\n- cmd/cupboard/root.go (modify) — register create command\n\n## Requirements\n- Implement `cupboard create --type \u003ctype\u003e --title \u003ctitle\u003e [--description \u003cdesc\u003e] [--labels \u003ccsv\u003e] [--json]`\n- Create a crumb with properties set: type, description, owner, labels\n- Set initial state to draft\n- Output created crumb ID (or full JSON with --json)\n- Validate --type against known categories (task, epic, bug, chore)\n- Exit 1 if --title is missing\n\n## Design Decisions\n- create is a convenience wrapper around set + property operations\n- Uses attachBackend helper from existing commands\n- Sets properties via Crumb.SetProperty before Table.Set\n\n## Acceptance Criteria\n- [ ] `cupboard create --type task --title \"Test\"` creates crumb with type=task, exit 0\n- [ ] `cupboard create` without --title exits 1 with error\n- [ ] `cupboard create --type task --title \"T\" --json` outputs JSON with crumb details\n- [ ] Created crumb has all built-in properties initialized\n- [ ] Command registered in root.go init()","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.344972-05:00","created_by":"petardjukic","updated_at":"2026-02-12T14:57:07.344972-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-0c8","depends_on_id":"generation-2026-02-12-07-13-55-10x","type":"blocks","created_at":"2026-02-12T14:57:08.283924-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-10x","title":"Add property enforcement CLI validation (S10-S15)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S10-S15 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 10-15)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3 generic table commands)\n- cmd/cupboard/set.go (set command patterns)\n- cmd/cupboard/list.go (list command patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (modify) — add CLI-based tests\n\n## Requirements\n- Test creating property via CLI: cupboard set properties (S10)\n- Test listing properties via CLI: cupboard list properties (S11)\n- Test creating crumb via CLI shows auto-initialized properties (S12)\n- Test defining new property via CLI backfills existing crumbs (S13)\n- Test category operations via CLI: set categories, list categories (S14-S15)\n- Use os/exec to run cupboard binary, parse JSON output\n\n## Design Decisions\n- Extend the existing property enforcement test file with CLI test functions\n- Use --json flag for machine-readable output verification\n- Build cupboard binary once per test suite, reuse across test cases\n\n## Acceptance Criteria\n- [ ] CLI tests cover S10-S15 from the use case\n- [ ] Tests verify JSON output contains expected property values\n- [ ] Tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] road-map.yaml updated to mark rel02.0-uc001-property-enforcement as done","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.942087-05:00","created_by":"petardjukic","updated_at":"2026-02-12T14:57:06.942087-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-10x","depends_on_id":"generation-2026-02-12-07-13-55-90v","type":"blocks","created_at":"2026-02-12T14:57:07.981662-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-16k","title":"Implement issue-tracking CLI create command (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4.1 create command)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F1 create, S1-S2)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases 1-3)\n- cmd/cupboard/set.go (generic set command for reference)\n- cmd/cupboard/helpers.go (attachBackend helper)\n- pkg/types/crumb.go (Crumb struct, SetProperty)\n\n## Files to Create/Modify\n- cmd/cupboard/create.go (create) — issue-tracking create command\n- cmd/cupboard/root.go (modify) — register create command\n\n## Requirements\n- Implement `cupboard create --type \u003ctype\u003e --title \u003ctitle\u003e [--description \u003cdesc\u003e] [--labels \u003ccsv\u003e] [--json]`\n- Create a crumb with properties set: type, description, owner, labels\n- Set initial state to draft\n- Output created crumb ID (or full JSON with --json)\n- Validate --type against known categories (task, epic, bug, chore)\n- Exit 1 if --title is missing\n\n## Design Decisions\n- create is a convenience wrapper around set + property operations\n- Uses attachBackend helper from existing commands\n- Sets properties via Crumb.SetProperty before Table.Set\n\n## Acceptance Criteria\n- [ ] `cupboard create --type task --title \"Test\"` creates crumb with type=task, exit 0\n- [ ] `cupboard create` without --title exits 1 with error\n- [ ] `cupboard create --type task --title \"T\" --json` outputs JSON with crumb details\n- [ ] Created crumb has all built-in properties initialized\n- [ ] Command registered in root.go init()","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:33.055686-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:46:33.055686-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-16k","depends_on_id":"generation-2026-02-12-07-13-55-40r","type":"blocks","created_at":"2026-02-12T17:46:33.552069-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-2ej","title":"Add integration tests for flat self-hosting workflow","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc005-flat-self-hosting.yaml (test cases: init, create, list, get, update, delete, end-to-end workflows, persistence)\n- docs/specs/use-cases/rel01.1-uc005-flat-self-hosting.yaml (S1-S10 success criteria)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (after task 2 — CLI test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc005_flat_self_hosting_test.go (create)\n\n## Requirements\n- Test full issue-tracking workflow using only generic table commands:\n  - Initialize cupboard (S1)\n  - Create crumb with set (S2)\n  - List all crumbs (S3)\n  - List with State=draft filter (S4)\n  - Update state to taken (S5)\n  - Update state to pebble/close (S6)\n  - Get crumb details (S7)\n  - Do-work cycle: create -\u003e list draft -\u003e claim (taken) -\u003e close (pebble) (S8)\n  - Make-work cycle: list existing -\u003e create multiple new crumbs (S9)\n  - JSONL persistence survives database deletion (S10)\n- Use os/exec to run cupboard binary\n- Parse JSON output to extract CrumbIDs for subsequent operations\n\n## Design Decisions\n- Tests mirror the do-work.sh and make-work.sh workflow patterns\n- Each end-to-end test runs the full sequence in a single temp directory\n- JSON parsing with encoding/json for output verification\n- Reuse runCupboard helper from generic table CLI tests if in same package\n\n## Acceptance Criteria\n- [ ] All 10 success criteria (S1-S10) have test coverage\n- [ ] Do-work cycle test runs full create -\u003e claim -\u003e close workflow\n- [ ] Make-work cycle test creates multiple crumbs and verifies count\n- [ ] JSONL persistence test deletes .db file and verifies data survives\n- [ ] Tests pass with `go test ./tests/integration/... -run TestFlatSelfHosting`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.350884-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:07:37.954017-05:00","closed_at":"2026-02-12T15:07:37.954017-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-2ej","depends_on_id":"generation-2026-02-12-07-13-55-l8y","type":"blocks","created_at":"2026-02-12T12:08:19.225646-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-2j0","title":"Implement JSONL forward-compatibility for regeneration use case","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S4 forward compatibility)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases 1-4)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R2 JSONL format)\n- internal/sqlite/loader.go (JSONL parsing)\n- pkg/types/ (entity struct definitions)\n\n## Files to Create/Modify\n- internal/sqlite/loader.go (modify) — ensure unknown JSON fields are tolerated during JSONL loading\n- internal/sqlite/loader_test.go (modify or create) — tests for forward compatibility\n\n## Requirements\n- JSONL loader must tolerate unknown fields in entity JSON (forward compatibility)\n- Unknown fields must be preserved through read-write cycle (round-trip fidelity)\n- Verify that generation N+1 can read generation N's JSONL files\n- Verify that adding new entity fields does not break existing JSONL files\n\n## Design Decisions\n- Use json.Decoder with DisallowUnknownFields disabled (Go default behavior)\n- For round-trip preservation, consider storing raw JSON alongside typed struct\n- If round-trip preservation is too complex, at minimum ensure unknown fields do not cause errors\n\n## Acceptance Criteria\n- [ ] JSONL loader does not error on unknown fields\n- [ ] Entity structs can be loaded from JSONL with extra fields\n- [ ] Unit tests verify loading JSONL with future fields\n- [ ] Existing JSONL round-trip tests continue to pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.074809-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:50:52.154559-05:00","closed_at":"2026-02-12T17:50:52.154559-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-2j0","depends_on_id":"generation-2026-02-12-07-13-55-2ys","type":"blocks","created_at":"2026-02-12T14:57:08.081754-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-2ys","title":"Close stale issues and update road-map.yaml statuses","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- All open beads issues (bd list --status open)\n- All in-progress beads issues (bd list --status in_progress)\n- tests/integration/test_rel01_1_uc005_flat_self_hosting_test.go (confirms flat self-hosting is done)\n- cmd/cupboard/delete.go (confirms delete command is done)\n- cmd/cupboard/config.go (confirms config loading is done)\n- internal/paths/paths.go (confirms paths package is done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel01.1-uc005-flat-self-hosting status to done\n\n## Requirements\n- Update rel01.1-uc005-flat-self-hosting status to done in road-map.yaml (code and tests exist and pass)\n- Close stale beads issues that duplicate already-completed work:\n  - generation-...-uss (delete command) — already implemented, close it\n  - generation-...-2ej (flat self-hosting tests) — already implemented, close it\n  - generation-...-3st (config.yaml with Viper) — already implemented, close it\n  - generation-...-9yb (init --config-dir) — already implemented, close it\n  - generation-...-b17 (config loading tests) — already implemented, close it\n  - generation-...-adl (road-map update) — will be addressed by this task, close it\n- Verify rel01.1-uc003-configuration-loading and rel01.1-uc004-generic-table-cli remain correctly marked done\n- Verify no other road-map statuses need correction\n\n## Acceptance Criteria\n- [ ] road-map.yaml shows rel01.1-uc005-flat-self-hosting as done\n- [ ] All stale duplicate issues closed with explanatory comments\n- [ ] road-map.yaml statuses match actual implementation state\n- [ ] Release 01.1 shows 4/5 done (only go-install remains)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.261251-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:20:08.299294-05:00","closed_at":"2026-02-12T15:20:08.299294-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-3st","title":"Implement config.yaml loading with Viper","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R7 config.yaml, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (F4 load config.yaml, F6 create on first run, S6-S8)\n- cmd/cupboard/root.go (existing flag handling)\n- internal/paths/paths.go (after task 3 — ResolveConfigDir)\n\n## Files to Create/Modify\n- cmd/cupboard/config.go (create) — Viper-based config loading\n- cmd/cupboard/root.go (modify) — integrate config loading into PersistentPreRunE\n\n## Requirements\n- Load config.yaml from resolved config directory using Viper\n- Config file fields: backend (string, default \"sqlite\"), data_dir (string, optional)\n- Create config directory on first run if it does not exist\n- Create default config.yaml on first run if config dir exists but file does not\n- Missing config.yaml is not an error (use defaults)\n- Integrate into root command's PersistentPreRunE so all subcommands benefit\n- Pass resolved data_dir from config.yaml to resolveDataDir pipeline\n\n## Design Decisions\n- Use spf13/viper for config file parsing (per go-style standard ecosystem)\n- Config loading happens once in PersistentPreRunE, not per-command\n- Keep it minimal: only load data_dir and backend from config.yaml\n\n## Acceptance Criteria\n- [ ] config.yaml is loaded from resolved config directory\n- [ ] data_dir from config.yaml is respected when no --data-dir flag provided\n- [ ] Missing config.yaml uses defaults without error\n- [ ] Config directory created on first run if absent\n- [ ] Default config.yaml created on first run if absent\n- [ ] PersistentPreRunE integrates config loading for all commands","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.089282-05:00","created_by":"petardjukic","updated_at":"2026-02-12T14:58:24.741554-05:00","closed_at":"2026-02-12T14:58:24.741554-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-3st","depends_on_id":"generation-2026-02-12-07-13-55-a31","type":"blocks","created_at":"2026-02-12T12:08:19.032953-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-40r","title":"Add property enforcement CLI validation tests (S10-S15)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S10-S15 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 10-15)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3 generic table commands)\n- cmd/cupboard/set.go (set command patterns)\n- cmd/cupboard/list.go (list command patterns)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (CLI test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (modify) — add CLI-based tests\n- docs/road-map.yaml (modify) — mark rel02.0-uc001-property-enforcement as done\n\n## Requirements\n- Test creating property via CLI: cupboard set properties (S10)\n- Test listing properties via CLI: cupboard list properties (S11)\n- Test creating crumb via CLI shows auto-initialized properties (S12)\n- Test defining new property via CLI backfills existing crumbs (S13)\n- Test category operations via CLI: cupboard set categories, cupboard list categories (S14-S15)\n- Use os/exec to run cupboard binary, parse JSON output\n\n## Design Decisions\n- Extend the existing property enforcement test file with CLI test functions\n- Use --json flag for machine-readable output verification\n- Build cupboard binary once per test suite, reuse across test cases\n\n## Acceptance Criteria\n- [ ] CLI tests cover S10-S15 from the use case\n- [ ] Tests verify JSON output contains expected property values\n- [ ] Tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] road-map.yaml updated to mark rel02.0-uc001 as done","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.918917-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:46:32.918917-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-40r","depends_on_id":"generation-2026-02-12-07-13-55-p57","type":"blocks","created_at":"2026-02-12T17:46:33.45282-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-57l","title":"Define Config struct, Cupboard interface, and Table interface in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R1-R3, R7-R8)\n- docs/ARCHITECTURE.md § Main Interface, § Design Decisions\n\n## Files to Create/Modify\n- pkg/types/config.go (create) - Config struct with Backend, DataDir fields; config validation errors (ErrBackendEmpty, ErrBackendUnknown, ErrSyncStrategyUnknown, ErrBatchSizeInvalid, ErrBatchIntervalInvalid); Validate() method\n- pkg/types/cupboard.go (create) - Cupboard interface with GetTable, Attach, Detach; standard table name constants; cupboard lifecycle errors (ErrCupboardDetached, ErrAlreadyAttached, ErrTableNotFound)\n- pkg/types/table.go (create) - Table interface with Get, Set, Delete, Fetch; table operation errors (ErrNotFound, ErrInvalidID, ErrInvalidData, ErrInvalidFilter); Filter type alias\n\n## Requirements\n- Config struct with Backend (string) and DataDir (string) fields per prd001 R1\n- Config.Validate() checks Backend not empty, Backend recognized, DataDir not empty when Backend is \"sqlite\"\n- Cupboard interface: GetTable(name string) (Table, error), Attach(config Config) error, Detach() error\n- Table interface: Get(id string) (any, error), Set(id string, data any) (string, error), Delete(id string) error, Fetch(filter map[string]any) ([]any, error)\n- Standard table name constants: crumbs, trails, properties, metadata, links, stashes\n- All sentinel errors defined per prd001 R7 with errors.New\n- Filter type alias: type Filter = map[string]any\n\n## Design Decisions\n- Interfaces in pkg/types (shared contract layer); implementations in internal/\n- Config struct, not interface, for serialization compatibility\n- Sentinel errors for errors.Is compatibility\n\n## Acceptance Criteria\n- [ ] Config struct compiles with Backend and DataDir fields\n- [ ] Config.Validate() returns correct errors for empty/unknown backend, empty DataDir\n- [ ] Cupboard interface compiles with GetTable, Attach, Detach\n- [ ] Table interface compiles with Get, Set, Delete, Fetch\n- [ ] All 6 standard table name constants defined\n- [ ] All sentinel errors from prd001 R7.1-R7.3 defined\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.592955-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:21:38.136407-05:00","closed_at":"2026-02-12T07:21:38.136407-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-5w8","title":"Unit tests for pkg/types: Config, Crumb, Trail entity methods","description":"## Required Reading\n- pkg/types/config.go (Config struct, Validate)\n- pkg/types/crumb.go (Crumb struct, state methods, property methods)\n- pkg/types/trail.go (Trail struct, Complete, Abandon)\n- docs/specs/test-suites/test-rel01.0-uc001-cupboard-lifecycle.yaml (config validation test cases)\n- docs/specs/test-suites/test-rel01.0-uc003-crumb-lifecycle.yaml (state transition test cases)\n\n## Files to Create/Modify\n- pkg/types/config_test.go (create) - Table-driven tests for Config.Validate: valid config, empty backend, unknown backend, empty DataDir for sqlite\n- pkg/types/crumb_test.go (create) - Table-driven tests for SetState (valid states, invalid state, idempotent), Pebble (from taken OK, from other states fails), Dust (from any state OK, idempotent), property methods (SetProperty, GetProperty, ClearProperty)\n- pkg/types/trail_test.go (create) - Table-driven tests for Complete (from active OK, from other states fails), Abandon (from active OK, from other states fails)\n\n## Requirements\n- Use testify/assert for assertions\n- Table-driven tests: each YAML test case maps to one row\n- Test edge cases: zero values, nil Properties map, empty strings\n- Test all error conditions return correct sentinel errors\n\n## Design Decisions\n- Tests in pkg/types package (white-box testing of entity methods)\n- Use testify for readable assertions\n\n## Acceptance Criteria\n- [ ] Config validation tests cover all error paths\n- [ ] Crumb state transition tests cover all valid/invalid transitions\n- [ ] Crumb property method tests cover set/get/clear/not-found\n- [ ] Trail lifecycle tests cover Complete and Abandon\n- [ ] All tests pass: go test ./pkg/types/...\n- [ ] No test uses hardcoded UUIDs (generate or use constants)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.54853-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:50:06.634981-05:00","closed_at":"2026-02-12T07:50:06.634981-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-5w8","depends_on_id":"generation-2026-02-12-07-13-55-eow","type":"blocks","created_at":"2026-02-12T07:18:37.516488-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-68l","title":"Define SQLite backend configuration and constructor in internal/sqlite","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R1 directory layout, R4 startup, R16 sync strategy)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R1 Config, R4 Attach)\n- pkg/types/config.go (Config struct)\n- pkg/types/cupboard.go (Cupboard interface)\n\n## Files to Create/Modify\n- internal/sqlite/backend.go (create) - SQLiteBackend struct implementing Cupboard interface; SQLiteConfig struct with SyncStrategy, BatchSize, BatchInterval; NewBackend() constructor; GetTable, Attach, Detach method stubs; attached/detached state tracking\n- internal/sqlite/schema.go (create) - SQL schema DDL strings (all 9 CREATE TABLE statements, all 12 CREATE INDEX statements from prd002 R3)\n\n## Requirements\n- SQLiteBackend struct with: db connection, attached flag, mutex for state, map of table accessors, config\n- NewBackend() returns *SQLiteBackend (not attached)\n- Attach(config): validate config, create DataDir if needed, create empty JSONL files if needed, delete existing cupboard.db, create new cupboard.db with schema, mark as attached; return ErrAlreadyAttached if already attached\n- Detach(): mark as detached, close db; idempotent\n- GetTable(name): return table accessor from map or ErrTableNotFound; return ErrCupboardDetached if detached\n- Schema DDL as const strings per prd002 R3.2 and R3.3\n\n## Design Decisions\n- Use modernc.org/sqlite (pure Go, no CGO) per architecture doc\n- Single backend.go for the struct and lifecycle; schema.go for DDL constants\n- Table accessors created during Attach and cached\n\n## Acceptance Criteria\n- [ ] SQLiteBackend implements Cupboard interface (compile check)\n- [ ] NewBackend returns unattached backend\n- [ ] Attach creates DataDir and JSONL files\n- [ ] Attach creates cupboard.db with correct schema\n- [ ] Detach closes connection and marks detached\n- [ ] GetTable returns ErrTableNotFound for unknown names\n- [ ] GetTable returns ErrCupboardDetached after Detach\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.991338-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:30:16.365319-05:00","closed_at":"2026-02-12T07:30:16.365319-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-68l","depends_on_id":"generation-2026-02-12-07-13-55-eow","type":"blocks","created_at":"2026-02-12T07:18:37.109887-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-6dx","title":"Implement metadata, stashes table accessors and JSONL loading","description":"## Required Reading\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (Metadata entity, schemas)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (Stash entity, history, operations)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R4 startup sequence, R9 built-in properties seeding)\n- internal/sqlite/backend.go (Attach method)\n\n## Files to Create/Modify\n- internal/sqlite/metadata_table.go (create) - metadataTable implementing Table; Fetch supports filter by table_name, crumb_id, property_id, content_contains, limit, offset\n- internal/sqlite/stashes_table.go (create) - stashesTable implementing Table; Set handles version increment and history append to stash_history; stash_history JSONL persistence\n- internal/sqlite/loader.go (create) - JSONL loading functions for startup: loadAllJSONL reads each JSONL file and inserts into SQLite tables; seedBuiltInProperties creates priority/type/description/owner/labels properties and categories if properties.jsonl is empty per prd002 R9\n- internal/sqlite/backend.go (modify) - Wire Attach to call loader, create all 6 table accessors, store in map\n\n## Requirements\n- metadataTable: hydrate/dehydrate Metadata per prd002 R14.5; Fetch with schema name, crumb_id, content_contains filters\n- stashesTable: hydrate/dehydrate Stash per prd002 R14.7; Set increments Version, records StashHistoryEntry, persists to stashes.jsonl and stash_history.jsonl\n- Loader: read each JSONL file line by line, parse JSON, insert into SQLite; skip malformed lines with warning; seed built-in properties per prd002 R9\n- Wire all 6 table accessors into backend.Attach\n\n## Design Decisions\n- Stash history append-only: never rewrite stash_history.jsonl, only append\n- Built-in properties seeded only if properties.jsonl is empty (first run)\n- Loader is transactional per prd002 R4.4\n\n## Acceptance Criteria\n- [ ] metadataTable implements Table with filtering\n- [ ] stashesTable implements Table with version/history tracking\n- [ ] Loader reads JSONL files into SQLite on Attach\n- [ ] Built-in properties seeded on first startup\n- [ ] Attach creates all 6 table accessors\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.409817-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:47:31.443682-05:00","closed_at":"2026-02-12T07:47:31.443682-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-6dx","depends_on_id":"generation-2026-02-12-07-13-55-ny9","type":"blocks","created_at":"2026-02-12T07:18:37.415895-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-6ep","title":"Add integration tests for configuration loading precedence","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc003-configuration-loading.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (S1-S9 success criteria)\n- internal/paths/paths.go (path resolution functions)\n- cmd/cupboard/config.go (config loading)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc003_configuration_loading_test.go (create)\n\n## Requirements\n- Test platform default paths return expected values (S1)\n- Test CRUMBS_CONFIG_DIR env overrides config directory (S2)\n- Test CRUMBS_DATA_DIR env overrides data directory (S3)\n- Test --config-dir flag overrides env and default (S4)\n- Test --data-dir flag overrides config.yaml and default (S5)\n- Test missing config.yaml uses defaults without error (S6)\n- Test config.yaml data_dir is respected when no flag (S7)\n- Test config directory created on first run (S8)\n- Test commands work with each override method (S9)\n- Use os/exec to run cupboard binary with various flag/env combinations\n- Use temp directories for isolation\n\n## Design Decisions\n- Set env vars with t.Setenv for automatic cleanup\n- Each test case creates its own temp directory\n- Write config.yaml to temp dir for config file tests\n\n## Acceptance Criteria\n- [ ] All 9 success criteria (S1-S9) have test coverage\n- [ ] Tests use table-driven pattern where applicable\n- [ ] Tests pass on macOS (current platform)\n- [ ] Each test is independent and uses isolated temp dirs","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.813863-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:28:59.606714-05:00","closed_at":"2026-02-12T12:28:59.606714-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-6ep","depends_on_id":"generation-2026-02-12-07-13-55-6y0","type":"blocks","created_at":"2026-02-12T08:33:20.64595-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-6rc","title":"Extract shared CLI helpers: parseEntityJSON to helpers.go","description":"## Required Reading\n- cmd/cupboard/helpers.go (existing attachBackend, validTableNames, error checkers)\n- cmd/cupboard/set.go (parseEntityJSON currently lives here)\n- cmd/cupboard/get.go, list.go, delete.go (verify no other duplicated patterns)\n- pkg/types/cupboard.go (standard table name constants)\n- pkg/types/*.go (all entity structs)\n\n## Files to Create/Modify\n- cmd/cupboard/helpers.go (modify) — move parseEntityJSON here\n- cmd/cupboard/set.go (modify) — remove parseEntityJSON, use from helpers\n\n## Requirements\n- Move `parseEntityJSON(tableName string, data []byte) (any, error)` from set.go to helpers.go\n- Verify no other duplicated logic exists across the four command files (get, set, list, delete)\n- Follow go-style rule: no duplicated code, extract when pattern appears twice\n\n## Design Decisions\n- helpers.go already contains attachBackend, validTableNames, and error checkers\n- parseEntityJSON is only used by set.go today but belongs in shared helpers for future reuse\n\n## Acceptance Criteria\n- [ ] parseEntityJSON lives in helpers.go\n- [ ] set.go imports it from helpers (same package, no import needed)\n- [ ] All four commands (get, set, list, delete) use shared helpers where applicable\n- [ ] `go build ./cmd/cupboard` succeeds\n- [ ] All existing tests still pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.69291-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:35:18.404296-05:00","closed_at":"2026-02-12T12:35:18.404296-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-6rc","depends_on_id":"generation-2026-02-12-07-13-55-dc3","type":"blocks","created_at":"2026-02-12T12:08:18.839964-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-6y0","title":"Implement config.yaml loading with Viper","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R7 config.yaml, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (F4 load config.yaml, F6 create on first run, S6-S8)\n- cmd/cupboard/root.go (existing flag handling)\n- internal/paths/paths.go (after task 6 — ResolveConfigDir)\n\n## Files to Create/Modify\n- cmd/cupboard/config.go (create) — Viper-based config loading\n- cmd/cupboard/root.go (modify) — integrate config loading into PersistentPreRunE\n\n## Requirements\n- Load config.yaml from resolved config directory using Viper\n- Config file fields: backend (string, default \"sqlite\"), data_dir (string, optional)\n- Create config directory on first run if it does not exist\n- Create default config.yaml on first run if config dir exists but file does not\n- Missing config.yaml is not an error (use defaults)\n- Integrate into root command's PersistentPreRunE so all subcommands benefit\n- Pass resolved data_dir from config.yaml to resolveDataDir pipeline\n\n## Design Decisions\n- Use spf13/viper for config file parsing (per go-style standard ecosystem)\n- Config loading happens once in PersistentPreRunE, not per-command\n- Keep it minimal: only load data_dir and backend from config.yaml\n\n## Acceptance Criteria\n- [ ] config.yaml is loaded from resolved config directory\n- [ ] data_dir from config.yaml is respected when no --data-dir flag provided\n- [ ] Missing config.yaml uses defaults without error\n- [ ] Config directory created on first run if absent\n- [ ] Default config.yaml created on first run if absent\n- [ ] PersistentPreRunE integrates config loading for all commands","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.675509-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:23:52.543312-05:00","closed_at":"2026-02-12T12:23:52.543312-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-6y0","depends_on_id":"generation-2026-02-12-07-13-55-rpi","type":"blocks","created_at":"2026-02-12T08:33:20.548002-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-755","title":"Wire CLI with cobra: init and version commands using Cupboard","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (init, version commands)\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (config/data directory defaults)\n- docs/specs/use-cases/rel01.0-uc004-scaffolding-validation.yaml (CLI version, tables accessible)\n- cmd/cupboard/main.go (existing entry point)\n- pkg/crumbs/version.go (version constant)\n\n## Files to Create/Modify\n- cmd/cupboard/main.go (modify) - Replace print-only main with cobra root command\n- cmd/cupboard/root.go (create) - Root cobra command with --config-dir, --data-dir, --json global flags\n- cmd/cupboard/init.go (create) - Init command: creates data directory, initializes backend (Attach + Detach), seeds built-in properties\n- cmd/cupboard/version.go (create) - Version command: prints version string\n\n## Requirements\n- Root command \"cupboard\" with persistent flags: --config-dir, --data-dir, --json, --help, --version\n- \"cupboard init\" creates .crumbs-db directory (or custom data-dir), calls Attach to initialize backend and JSONL files, then Detach\n- \"cupboard version\" prints version string from pkg/crumbs/version.go\n- Exit codes: 0 success, 1 user error, 2 system error per prd009\n- Config/data directory defaults per prd010: $(CWD)/.crumbs for config, $(CWD)/.crumbs-db for data\n\n## Design Decisions\n- Use cobra for CLI framework per go-style rule\n- Minimal CLI: only init and version for release 01.0\n- Wire real SQLiteBackend in init command\n\n## Acceptance Criteria\n- [ ] cupboard version prints version and exits 0\n- [ ] cupboard init creates data directory with JSONL files\n- [ ] cupboard init seeds built-in properties\n- [ ] cupboard --help shows available commands\n- [ ] go build ./cmd/cupboard succeeds\n- [ ] go install ./cmd/cupboard succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.814753-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:01:19.208259-05:00","closed_at":"2026-02-12T08:01:19.208259-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-755","depends_on_id":"generation-2026-02-12-07-13-55-6dx","type":"blocks","created_at":"2026-02-12T07:18:37.712143-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-7gs","title":"Implement JSONL forward-compatibility for regeneration (rel02.0-uc002)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S4 forward compatibility)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases 1-4)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R2 JSONL format)\n- internal/sqlite/loader.go (JSONL parsing)\n- pkg/types/ (entity struct definitions)\n\n## Files to Create/Modify\n- internal/sqlite/loader.go (modify) — verify unknown JSON fields are tolerated\n- internal/sqlite/loader_test.go (modify or create) — forward compatibility tests\n\n## Requirements\n- JSONL loader must tolerate unknown fields in entity JSON (Go default json.Unmarshal behavior)\n- Verify that entity structs can be loaded from JSONL with extra fields\n- Verify that adding new fields to entity structs does not break loading old JSONL\n- Unit tests with JSONL containing future fields that don't exist in current structs\n\n## Design Decisions\n- Go's json.Unmarshal silently ignores unknown fields by default (verify this is the case)\n- Write explicit tests confirming this behavior to prevent regressions\n- Test both direct unmarshaling and through the loader pipeline\n\n## Acceptance Criteria\n- [ ] JSONL loader does not error on unknown fields\n- [ ] Unit tests verify loading JSONL with future fields\n- [ ] Existing JSONL round-trip tests continue to pass","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.649173-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:46:32.649173-05:00"}
{"id":"generation-2026-02-12-07-13-55-7up","title":"Add integration tests for generic table CLI commands","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc004-generic-table-cli.yaml (test cases to implement)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (success criteria S1-S12)\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (existing test patterns)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (existing test patterns)\n- cmd/cupboard/get.go, set.go, list.go, delete.go (commands under test)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (create) — CLI integration tests\n\n## Requirements\n- Implement table-driven tests exercising the cupboard CLI binary via os/exec\n- Build cupboard binary in TestMain or test setup, use temp directory for data\n- Test cases per test suite YAML:\n  - Get: valid entity returns JSON (S1), missing entity exit 1 (S2), unknown table exit 1 with valid names (S3)\n  - Set: create with empty ID returns JSON with generated ID (S4), update with existing ID (S5), invalid JSON exit 1 (S6)\n  - List: all entities returns JSON array (S7), with State=draft filter (S8), invalid filter exit 1 (S9)\n  - Delete: removes entity prints confirmation (S10), missing entity exit 1 (S11)\n  - Cross-table: commands work for crumbs, trails, links (S12)\n- Each test case uses a fresh cupboard init in a temp directory\n\n## Design Decisions\n- Use os/exec.Command to run the built binary (true CLI integration test)\n- Build binary once in TestMain, store path in package-level var\n- Helper: runCupboard(t, args...) (stdout, stderr, exitCode) for clean test assertions\n\n## Acceptance Criteria\n- [ ] All 12 success criteria (S1-S12) have at least one test case\n- [ ] Tests use table-driven pattern\n- [ ] Tests build and run the cupboard binary via os/exec\n- [ ] Tests pass with `go test ./tests/integration/... -run TestGenericTableCLI`\n- [ ] Each test case is independent (uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.392357-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:17:14.794723-05:00","closed_at":"2026-02-12T12:17:14.794723-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-7up","depends_on_id":"generation-2026-02-12-07-13-55-qg7","type":"blocks","created_at":"2026-02-12T08:33:20.45016-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-90v","title":"Add integration tests for property enforcement use case (S1-S9)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S1-S9 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 1-9)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (integration test patterns)\n- internal/sqlite/seed.go (built-in property seeding)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (create)\n\n## Requirements\n- Test built-in properties exist after attach (S1-S3)\n- Test auto-initialization on crumb creation (S4-S6)\n- Test backfill on property definition (S7-S9)\n- Use table-driven tests mapping to YAML test cases\n- Test via Go API (Cupboard.GetTable, Table.Set/Get/Fetch), not CLI\n\n## Design Decisions\n- Integration tests use the real SQLite backend with temp directories\n- Each test case starts from preconditions (fresh cupboard)\n- Verify property values by getting crumb and checking Properties map\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S9 from the use case\n- [ ] Tests use table-driven pattern\n- [ ] All tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] Tests are independent (each uses its own temp directory)","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.806531-05:00","created_by":"petardjukic","updated_at":"2026-02-12T14:57:06.806531-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-90v","depends_on_id":"generation-2026-02-12-07-13-55-yzx","type":"blocks","created_at":"2026-02-12T14:57:07.879642-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-9eh","title":"Implement generic table CLI get command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.1 get command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R2 Cupboard interface, R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S1-S3 success criteria for get)\n- cmd/cupboard/root.go (existing CLI structure, global flags, resolveDataDir helper)\n- cmd/cupboard/init.go (pattern for backend initialization)\n- internal/sqlite/backend.go (NewBackend, Attach, GetTable)\n\n## Files to Create/Modify\n- cmd/cupboard/get.go (create) — get command implementation\n- cmd/cupboard/root.go (modify) — register get command\n\n## Requirements\n- Implement `cupboard get \u003ctable\u003e \u003cid\u003e` per prd009-cupboard-cli R3.1\n- Accept table name and entity ID as positional arguments (cobra.ExactArgs(2))\n- Resolve data dir, create backend, attach, get table, call Table.Get(id)\n- Output JSON object with 2-space indentation per R7.3\n- Exit 1 with \"unknown table\" message listing valid names if table not found\n- Exit 1 with \"entity not found\" message if entity not found\n- Exit 2 for system errors (backend initialization failures)\n- Error messages to stderr per R7.4\n\n## Design Decisions\n- Extract a shared helper function `attachBackend()` that resolves data dir, creates backend, and attaches — reuse across get/set/list/delete commands. Place in cmd/cupboard/helpers.go or inline in a shared file.\n- Use json.MarshalIndent for output formatting\n- Entity returned as `any` from Table.Get — marshal directly to JSON\n\n## Acceptance Criteria\n- [ ] `cupboard get crumbs \u003cvalid-id\u003e` returns JSON with exit 0\n- [ ] `cupboard get crumbs \u003cnonexistent-id\u003e` returns exit 1 with not-found message\n- [ ] `cupboard get unknown-table \u003cid\u003e` returns exit 1 with valid table names\n- [ ] Error messages written to stderr\n- [ ] JSON output uses 2-space indentation\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:18.715736-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:36:36.326814-05:00","closed_at":"2026-02-12T08:36:36.326814-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-9yb","title":"Add init command --config-dir support and config directory creation","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R1.2, R1.6 config directory creation)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (F6 create on first run, S8)\n- cmd/cupboard/init.go (existing init command)\n- cmd/cupboard/root.go (global flags)\n- internal/paths/paths.go (after task 3 — path resolution)\n\n## Files to Create/Modify\n- cmd/cupboard/init.go (modify) — create config directory alongside data directory\n\n## Requirements\n- When `cupboard init` runs, also create the config directory (resolved via --config-dir \u003e env \u003e default)\n- Create default config.yaml in config directory if it does not exist\n- Print both config and data directory paths on successful init\n- Integrate with internal/paths.ResolveConfigDir\n\n## Design Decisions\n- init already creates the data directory; extend it to also create config directory\n- Use os.MkdirAll for idempotent directory creation\n- Default config.yaml contains only backend: sqlite\n\n## Acceptance Criteria\n- [ ] `cupboard init` creates config directory\n- [ ] `cupboard init` creates default config.yaml with backend: sqlite\n- [ ] `cupboard init --config-dir=/tmp/cfg` uses specified config directory\n- [ ] Existing data directory creation still works\n- [ ] `go build ./cmd/cupboard` succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.612596-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:11:48.742575-05:00","closed_at":"2026-02-12T15:11:48.742575-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-9yb","depends_on_id":"generation-2026-02-12-07-13-55-3st","type":"blocks","created_at":"2026-02-12T12:08:19.320851-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-a1t","title":"Implement crumbs table accessor with Get, Set, Delete, Fetch","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R12-R15 table routing, interface impl, hydration, persistence)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R3 creation, R6-R10 retrieval/update/delete/filter/query)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface, R8 UUID v7)\n- internal/sqlite/backend.go (SQLiteBackend, schema)\n- pkg/types/crumb.go (Crumb struct)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_table.go (create) - crumbsTable struct implementing Table interface; Get (query by ID, hydrate to *Crumb), Set (create with UUID v7 if empty ID, update if exists; validate Name non-empty; dehydrate to SQL), Delete (remove crumb + cascade property values/metadata/links), Fetch (build WHERE from filter map, hydrate results)\n- internal/sqlite/jsonl.go (create) - JSONL read/write helpers: readJSONL(path) ([]json.RawMessage, error), writeJSONL(path, records) with atomic write pattern (temp file, fsync, rename); loadCrumbsJSONL, persistCrumbsJSONL\n\n## Requirements\n- crumbsTable.Get: query crumbs table by crumb_id, hydrate row to *Crumb per prd002 R14.2, return ErrNotFound/ErrInvalidID\n- crumbsTable.Set: type-assert data to *Crumb, validate Name non-empty (ErrInvalidName), generate UUID v7 if CrumbID empty, set CreatedAt/UpdatedAt/State=draft on create, INSERT or UPDATE, persist to crumbs.jsonl atomically\n- crumbsTable.Delete: delete from crumbs table + cascade (crumb_properties, metadata, links where from_id or to_id), persist affected JSONL files, return ErrNotFound/ErrInvalidID\n- crumbsTable.Fetch: support filters (states, trail_id, parent_id, limit, offset), order by created_at DESC, return []any of *Crumb\n- JSONL helpers: atomic write (write temp, fsync, rename), read line-by-line skipping empty/malformed\n- UUID v7 generation using google/uuid package\n\n## Design Decisions\n- Each table accessor owns its JSONL persistence\n- Atomic write pattern per prd002 R5.2\n- Filter keys map to SQL WHERE clauses; trail_id and parent_id require JOIN on links table\n\n## Acceptance Criteria\n- [ ] crumbsTable implements Table interface\n- [ ] Get returns hydrated *Crumb or ErrNotFound\n- [ ] Set creates crumb with UUID v7 and correct defaults\n- [ ] Set updates existing crumb\n- [ ] Delete cascades to properties, metadata, links\n- [ ] Fetch with empty filter returns all crumbs\n- [ ] Fetch respects states, limit, offset filters\n- [ ] JSONL atomic write pattern works (temp, fsync, rename)\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.124514-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:33:42.169793-05:00","closed_at":"2026-02-12T07:33:42.169793-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-a1t","depends_on_id":"generation-2026-02-12-07-13-55-68l","type":"blocks","created_at":"2026-02-12T07:18:37.208079-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-a31","title":"Implement configuration loading with platform defaults and precedence chain","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R1-R2 directory structure, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (flow F1-F7, success criteria S1-S9)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R6 global flags)\n- cmd/cupboard/root.go (existing resolveDataDir, global flags)\n\n## Files to Create/Modify\n- internal/paths/paths.go (create) — platform-specific default paths and resolution functions\n- internal/paths/paths_test.go (create) — unit tests for path resolution\n- cmd/cupboard/root.go (modify) — replace resolveDataDir with paths.ResolveDataDir, add resolveConfigDir\n\n## Requirements\n- Implement DefaultConfigDir() and DefaultDataDir() per prd010 R1.2 and R2.2:\n  - Linux: XDG_CONFIG_HOME/crumbs and XDG_DATA_HOME/crumbs (fallback ~/.config/crumbs and ~/.local/share/crumbs)\n  - macOS: ~/Library/Application Support/crumbs (both config and data)\n  - Windows: %APPDATA%/crumbs (both config and data)\n- Implement ResolveConfigDir(flag, env string) string: flag \u003e CRUMBS_CONFIG_DIR env \u003e DefaultConfigDir()\n- Implement ResolveDataDir(flag, configYAMLValue, env string) string: flag \u003e config.yaml data_dir \u003e CRUMBS_DATA_DIR env \u003e DefaultDataDir()\n- For CWD-relative defaults: when --data-dir is empty and no config or env override, use $(CWD)/.crumbs-db (current behavior preserved)\n\n## Design Decisions\n- Use runtime.GOOS for platform detection\n- Use os.UserHomeDir() and os.UserConfigDir() for cross-platform home paths\n- Keep CWD-relative defaults as the primary mode (matching current behavior)\n\n## Acceptance Criteria\n- [ ] DefaultConfigDir returns correct path per platform\n- [ ] DefaultDataDir returns correct path per platform\n- [ ] ResolveConfigDir follows flag \u003e env \u003e default precedence\n- [ ] ResolveDataDir follows flag \u003e config \u003e env \u003e default precedence\n- [ ] Unit tests verify each precedence level\n- [ ] root.go resolveDataDir uses the new paths package","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.95817-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:38:03.114987-05:00","closed_at":"2026-02-12T12:38:03.114987-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-a4s","title":"Implement generic table CLI list command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.4 list command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface, Filter type)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S7-S9 success criteria for list)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n- internal/sqlite/crumbs_table.go (Fetch filter keys: states, trail_id, parent_id, limit, offset)\n\n## Files to Create/Modify\n- cmd/cupboard/list.go (create) — list command implementation\n- cmd/cupboard/root.go (modify) — register list command\n\n## Requirements\n- Implement `cupboard list \u003ctable\u003e [key=value...]` per prd009-cupboard-cli R3.4\n- Accept table name as first arg, remaining args as key=value filter pairs\n- Parse filters: split on '=' to get key and value; exit 1 for malformed filters\n- Special handling: if key is \"states\" or \"State\", wrap value in []string for the filter map\n- Call Table.Fetch(filter) and output JSON array with 2-space indentation\n- Empty results output `[]` (not null)\n- Exit 1 with \"unknown table\" for invalid table, exit 1 with \"invalid filter\" for bad syntax\n\n## Design Decisions\n- Filters passed as positional args after table name (not flags) for simplicity\n- The filter map is passed directly to Table.Fetch — each table implementation handles its own filter keys\n\n## Acceptance Criteria\n- [ ] `cupboard list crumbs` returns JSON array of all crumbs\n- [ ] `cupboard list crumbs State=draft` returns filtered results\n- [ ] `cupboard list crumbs` on empty table returns `[]`\n- [ ] `cupboard list crumbs bad-filter` returns exit 1 with expected format message\n- [ ] `cupboard list unknown-table` returns exit 1 with valid table names\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:18.992567-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:40:58.649132-05:00","closed_at":"2026-02-12T08:40:58.649132-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-a4s","depends_on_id":"generation-2026-02-12-07-13-55-9eh","type":"blocks","created_at":"2026-02-12T08:33:20.155811-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-a7y","title":"Add integration tests for flat self-hosting workflow","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc005-flat-self-hosting.yaml (test cases: init, create, list, get, update, delete, end-to-end workflows, persistence)\n- docs/specs/use-cases/rel01.1-uc005-flat-self-hosting.yaml (S1-S10 success criteria)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (after task 5 — CLI test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc005_flat_self_hosting_test.go (create)\n\n## Requirements\n- Test full issue-tracking workflow using only generic table commands:\n  - Initialize cupboard (S1)\n  - Create crumb with set (S2)\n  - List all crumbs (S3)\n  - List with State=draft filter (S4)\n  - Update state to taken (S5)\n  - Update state to pebble/close (S6)\n  - Get crumb details (S7)\n  - Do-work cycle: create → list draft → claim (taken) → close (pebble) (S8)\n  - Make-work cycle: list existing → create multiple new crumbs (S9)\n  - JSONL persistence survives database deletion (S10)\n- Use os/exec to run cupboard binary\n- Parse JSON output to extract CrumbIDs for subsequent operations\n\n## Design Decisions\n- Tests mirror the do-work.sh and make-work.sh workflow patterns\n- Each end-to-end test runs the full sequence in a single temp directory\n- JSON parsing with encoding/json for output verification\n\n## Acceptance Criteria\n- [ ] All 10 success criteria (S1-S10) have test coverage\n- [ ] Do-work cycle test runs full create → claim → close workflow\n- [ ] Make-work cycle test creates multiple crumbs and verifies count\n- [ ] JSONL persistence test deletes .db file and verifies data survives\n- [ ] Tests pass with `go test ./tests/integration/... -run TestFlatSelfHosting`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.957723-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:33:33.395426-05:00","closed_at":"2026-02-12T12:33:33.395426-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-a7y","depends_on_id":"generation-2026-02-12-07-13-55-7up","type":"blocks","created_at":"2026-02-12T08:33:20.748175-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-adl","title":"Update road-map.yaml use case statuses to reflect actual implementation state","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- All existing issue descriptions (from beads)\n- cmd/cupboard/ directory (verify which commands exist)\n- internal/paths/ directory (verify if paths package exists)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — correct use case statuses\n\n## Requirements\n- Review each use case marked 'done' in road-map.yaml and verify that:\n  - The code is actually implemented and passes tests\n  - Integration tests exist\n- If a use case is marked 'done' but code or tests are missing, change status to appropriate value\n- Specifically verify:\n  - rel01.1-uc003-configuration-loading: marked 'done' but internal/paths does not exist and config.go not implemented\n  - rel01.1-uc004-generic-table-cli: marked 'done' but delete command not implemented\n- Update statuses to reflect ground truth\n\n## Acceptance Criteria\n- [ ] road-map.yaml use case statuses match actual implementation state\n- [ ] No use case marked 'done' that lacks implementation or tests","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.742837-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:17:26.762506-05:00","closed_at":"2026-02-12T15:17:26.762506-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-b17","title":"Add integration tests for configuration loading precedence","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc003-configuration-loading.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (S1-S9 success criteria)\n- internal/paths/paths.go (path resolution functions)\n- cmd/cupboard/config.go (config loading)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc003_configuration_loading_test.go (create)\n\n## Requirements\n- Test platform default paths return expected values (S1)\n- Test CRUMBS_CONFIG_DIR env overrides config directory (S2)\n- Test CRUMBS_DATA_DIR env overrides data directory (S3)\n- Test --config-dir flag overrides env and default (S4)\n- Test --data-dir flag overrides config.yaml and default (S5)\n- Test missing config.yaml uses defaults without error (S6)\n- Test config.yaml data_dir is respected when no flag (S7)\n- Test config directory created on first run (S8)\n- Test commands work with each override method (S9)\n- Use os/exec to run cupboard binary with various flag/env combinations\n- Use temp directories for isolation\n\n## Design Decisions\n- Set env vars with cmd.Env for subprocess isolation (not t.Setenv, which affects the test process)\n- Each test case creates its own temp directory\n- Write config.yaml to temp dir for config file tests\n\n## Acceptance Criteria\n- [ ] All 9 success criteria (S1-S9) have test coverage\n- [ ] Tests use table-driven pattern where applicable\n- [ ] Tests pass on macOS (current platform)\n- [ ] Each test is independent and uses isolated temp dirs","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.219391-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:03:28.49137-05:00","closed_at":"2026-02-12T15:03:28.49137-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-b17","depends_on_id":"generation-2026-02-12-07-13-55-3st","type":"blocks","created_at":"2026-02-12T12:08:19.129217-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-bpu","title":"Implement property auto-initialization on crumb creation","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R4 auto-initialization)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R2 creation)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S4-S6 auto-initialization)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 4-6)\n- internal/sqlite/crumbs_table.go (Set method)\n- internal/sqlite/properties_table.go (property operations)\n- pkg/types/crumb.go (Crumb struct, Properties field)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_table.go (modify) — add auto-initialization in Set when creating new crumb\n- internal/sqlite/crumbs_table_test.go (modify or create) — tests for auto-init\n\n## Requirements\n- When Table.Set creates a new crumb (empty ID), auto-initialize all defined properties with their type defaults\n- Type defaults per prd004: categorical=first category or null, text=\"\", integer=0, boolean=false, timestamp=null, list=[]\n- Properties must be persisted to crumb_properties table\n- Crumb.Properties map must be populated after creation\n- If crumb already has a property value set explicitly, do not override with default\n\n## Design Decisions\n- Auto-init happens inside the Set transaction so it is atomic\n- Query properties table for all defined properties, compute defaults, insert into crumb_properties\n- Only on create (empty ID), not on update\n\n## Acceptance Criteria\n- [ ] New crumb has all defined properties initialized with type defaults\n- [ ] Explicitly set property values are not overridden\n- [ ] Properties appear in Crumb.Properties map after Get\n- [ ] Unit tests verify auto-init for each value type\n- [ ] Existing tests continue to pass","status":"in_progress","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.53792-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:26:04.866364-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-bpu","depends_on_id":"generation-2026-02-12-07-13-55-mdx","type":"blocks","created_at":"2026-02-12T14:57:07.680208-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-c5f","title":"Mark rel01.1-uc001-go-install as done and add JSONL roundtrip test (rel01.1-uc002)","description":"## Required Reading\n- docs/specs/use-cases/rel01.1-uc002-jsonl-git-roundtrip.yaml (S1-S14 success criteria)\n- docs/specs/test-suites/test-rel01.1-uc002-jsonl-git-roundtrip.yaml (28 test cases)\n- tests/integration/test_rel01_1_uc001_go_install_test.go (already exists and passes)\n- internal/sqlite/backend.go (Attach/Detach, sync strategies)\n- internal/sqlite/jsonl.go (JSONL persistence)\n- internal/sqlite/loader.go (JSONL loading on startup)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R4 startup, R5 persistence, R14 sync)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc002_jsonl_git_roundtrip_test.go (create)\n- docs/road-map.yaml (modify) — mark rel01.1-uc001 as done (tests already pass), mark rel01.1-uc002 as done after tests pass\n\n## Requirements\n- S1-S5: JSONL files created, content correct, committable to git, cupboard.db gitignored\n- S6-S9: Database deletion and rebuild (delete cupboard.db, re-attach, verify data intact)\n- S10-S11: State changes persist to JSONL and survive rebuild cycles\n- S12: on_close sync strategy defers writes until Detach\n- S13: batch sync strategy flushes at threshold\n- S14: immediate sync strategy (default) persists every write\n- Test via Go API (Cupboard.Attach, GetTable, Table.Set/Get/Fetch/Delete) with temp dirs\n- Simulate git roundtrip by creating data, deleting DB, and re-attaching\n\n## Design Decisions\n- Use Go API directly (not git CLI) for roundtrip simulation\n- Create JSONL data, delete cupboard.db file, re-Attach to verify reload\n- Test sync strategies by configuring Backend with different SyncStrategy values\n- Table-driven tests grouped by success criteria\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S14 from the use case\n- [ ] Tests pass with go test ./tests/integration/... -run TestJSONLGitRoundtrip\n- [ ] road-map.yaml marks rel01.1-uc001 as done and rel01.1-uc002 as done","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.108552-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:46:32.108552-05:00"}
{"id":"generation-2026-02-12-07-13-55-czg","title":"Add integration tests for regeneration compatibility (S1-S8)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S8 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases)\n- internal/sqlite/loader.go (JSONL loading with forward compat)\n- tests/integration/test_rel01_1_uc002_jsonl_git_roundtrip_test.go (roundtrip test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc002_regeneration_compatibility_test.go (create)\n\n## Requirements\n- Test that JSONL files with unknown fields load without error (S1-S2)\n- Test that crumb data survives a simulated regeneration cycle (S3-S4)\n- Test that adding a new property to existing JSONL data works (S5)\n- Test that removing a field from struct still loads old JSONL (S6)\n- Test concurrent JSONL access from two cupboard instances (S7, if applicable)\n- Test that JSONL files remain valid after write-back with new struct version (S8)\n\n## Design Decisions\n- Simulate regeneration by creating JSONL files with extra fields, then loading\n- Use real SQLite backend with temp directories\n- Test both loader.go directly and via Cupboard.Attach\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S8 from the use case\n- [ ] Tests pass with go test ./tests/integration/... -run TestRegenerationCompatibility\n- [ ] road-map.yaml updated to mark rel02.0-uc002-regeneration-compatibility as done (after all tests pass)","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.208654-05:00","created_by":"petardjukic","updated_at":"2026-02-12T14:57:07.208654-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-czg","depends_on_id":"generation-2026-02-12-07-13-55-2j0","type":"blocks","created_at":"2026-02-12T14:57:08.182681-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-dc3","title":"Implement generic table CLI delete command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.3 delete command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S10-S11 success criteria for delete)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n- cmd/cupboard/helpers.go (attachBackend, error checkers)\n\n## Files to Create/Modify\n- cmd/cupboard/delete.go (create) — delete command implementation\n- cmd/cupboard/root.go (modify) — register delete command\n\n## Requirements\n- Implement `cupboard delete \u003ctable\u003e \u003cid\u003e` per prd009-cupboard-cli R3.3\n- Accept table name and entity ID as positional arguments (cobra.ExactArgs(2))\n- Call Table.Delete(id) and output \"Deleted \u003ctable\u003e/\u003cid\u003e\" on success\n- Exit 1 with \"entity not found\" for missing entity\n- Exit 1 with \"unknown table\" for invalid table name\n- Error messages to stderr\n\n## Design Decisions\n- Reuse attachBackend() helper from helpers.go\n- Reuse isTableNotFound() and isEntityNotFound() helpers\n- Follow the pattern established by get.go\n\n## Acceptance Criteria\n- [ ] `cupboard delete crumbs \u003cvalid-id\u003e` removes entity, prints confirmation, exit 0\n- [ ] `cupboard delete crumbs \u003cnonexistent-id\u003e` returns exit 1 with not-found message\n- [ ] `cupboard delete unknown-table \u003cid\u003e` returns exit 1 with valid table names\n- [ ] Command registered in root.go init()\n- [ ] `go build ./cmd/cupboard` succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.556295-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:34:27.588474-05:00","closed_at":"2026-02-12T12:34:27.588474-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-eow","title":"Define Crumb property methods and remaining entity structs in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R5 property methods)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail struct)\n- docs/specs/product-requirements/prd004-properties-interface.yaml (Property and Category structs)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (Metadata struct)\n- docs/specs/product-requirements/prd007-links-interface.yaml (Link struct)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (Stash struct)\n- pkg/types/crumb.go (existing Crumb struct)\n\n## Files to Create/Modify\n- pkg/types/crumb.go (modify) - Add property methods: SetProperty, GetProperty, GetProperties, ClearProperty\n- pkg/types/trail.go (create) - Trail struct with ID, State, CreatedAt, CompletedAt; Complete() and Abandon() methods\n- pkg/types/property.go (create) - Property struct, Category struct, value type constants, built-in property names\n- pkg/types/metadata.go (create) - Metadata struct, Schema struct, built-in schema constants\n- pkg/types/link.go (create) - Link struct, link type constants (belongs_to, child_of, branches_from, scoped_to)\n- pkg/types/stash.go (create) - Stash struct, StashHistoryEntry struct, stash type constants, stash methods\n- pkg/types/errors.go (create) - Entity-specific errors not already in table.go (ErrInvalidState, ErrInvalidTransition, ErrInvalidName, ErrPropertyNotFound, ErrTypeMismatch, ErrInvalidCategory, etc.)\n\n## Requirements\n- Crumb property methods per prd003 R5: SetProperty, GetProperty, GetProperties, ClearProperty\n- Trail struct per prd006: TrailID, State, CreatedAt, CompletedAt (*time.Time); Complete(), Abandon() methods\n- Property and Category structs per prd004\n- Metadata struct per prd005\n- Link struct with link type constants per prd007\n- Stash and StashHistoryEntry structs per prd008\n- All entity-specific sentinel errors from prd001 R7.3\n\n## Design Decisions\n- Keep entity errors centralized in errors.go for discoverability\n- Property methods on Crumb do basic checks (key exists in map); full validation deferred to Table.Set\n- Trail.Complete requires active state; Trail.Abandon requires active state per prd006\n\n## Acceptance Criteria\n- [ ] Crumb property methods compile and modify Properties map\n- [ ] Trail struct with lifecycle methods compiles\n- [ ] Property, Category, Metadata, Link, Stash structs all compile with correct fields\n- [ ] All entity-specific errors defined\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.858479-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:27:10.750698-05:00","closed_at":"2026-02-12T07:27:10.750698-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-eow","depends_on_id":"generation-2026-02-12-07-13-55-g72","type":"blocks","created_at":"2026-02-12T07:18:37.012621-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-g72","title":"Define Crumb entity struct and state transition methods in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R1, R2, R4)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R7.3 for entity method errors)\n- pkg/types/table.go (error types already defined)\n\n## Files to Create/Modify\n- pkg/types/crumb.go (create) - Crumb struct, state constants, state transition methods\n\n## Requirements\n- Crumb struct: CrumbID (string), Name (string), State (string), CreatedAt (time.Time), UpdatedAt (time.Time), Properties (map[string]any)\n- State constants: draft, pending, ready, taken, pebble, dust\n- Valid states set for validation\n- SetState(state string) error: validates state is valid, updates State and UpdatedAt; idempotent; returns ErrInvalidState for invalid state\n- Pebble() error: requires current state is \"taken\", sets State to pebble, updates UpdatedAt; returns ErrInvalidTransition otherwise\n- Dust() error: sets State to dust from any state, updates UpdatedAt; idempotent\n\n## Design Decisions\n- State as string (not Go enum) for JSON compatibility per prd003 R2.4\n- Entity methods modify struct in memory; caller calls Table.Set to persist\n- Use a validStates map for O(1) lookup\n\n## Acceptance Criteria\n- [ ] Crumb struct has all 6 fields per prd003 R1.1\n- [ ] 6 state constants defined\n- [ ] SetState validates and transitions correctly\n- [ ] Pebble requires \"taken\" state, returns ErrInvalidTransition otherwise\n- [ ] Dust works from any state, is idempotent\n- [ ] All methods update UpdatedAt\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.726714-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:22:46.725029-05:00","closed_at":"2026-02-12T07:22:46.725029-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-g72","depends_on_id":"generation-2026-02-12-07-13-55-57l","type":"blocks","created_at":"2026-02-12T07:18:36.913338-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-grm","title":"Implement property auto-initialization on crumb creation","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R4 auto-initialization, R8 enforcement)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S4-S6 auto-init)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 4-6)\n- internal/sqlite/crumbs_table.go (Set method, lines 53-125)\n- internal/sqlite/properties_table.go (property operations, default value logic)\n- internal/sqlite/seed.go (built-in property seeding)\n- pkg/types/crumb.go (Crumb struct, Properties field)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_table.go (modify) — add auto-init in Set when creating new crumb (id == \"\")\n- internal/sqlite/crumbs_table_test.go (modify or create) — unit tests for auto-init\n\n## Requirements\n- When Set creates a new crumb (empty ID), query all defined properties\n- For each property, insert a crumb_properties row with the type default value\n- Type defaults per prd004: categorical=first category value, text=\"\", integer=0, boolean=false, timestamp=null, list=[]\n- Auto-init happens inside the Set transaction (atomic with crumb creation)\n- If crumb already has explicit property values in Properties map, do not override\n- Populate crumb.Properties map with initialized values before returning\n\n## Design Decisions\n- Auto-init runs within the same transaction as the INSERT\n- Query properties table for all defined properties, compute defaults using existing defaultValueJSON helper\n- Use INSERT OR IGNORE for crumb_properties to avoid conflicts\n- Only on create (id == \"\"), not on update\n\n## Acceptance Criteria\n- [ ] New crumb has all defined properties initialized with type defaults\n- [ ] Explicitly set property values are not overridden by defaults\n- [ ] Properties appear in Crumb.Properties map after Get\n- [ ] Unit tests verify auto-init for each value type\n- [ ] Existing crumb tests continue to pass","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.242959-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:46:32.242959-05:00"}
{"id":"generation-2026-02-12-07-13-55-h6b","title":"Add scaffolding validation integration tests (rel01.0-uc004)","description":"## Required Reading\n- docs/specs/use-cases/rel01.0-uc004-scaffolding-validation.yaml (S1-S11 success criteria)\n- docs/specs/test-suites/test-rel01.0-uc004-scaffolding-validation.yaml (30 test cases)\n- pkg/types/ (entity structs: crumb.go, trail.go, property.go, category.go, stash.go, metadata.go, link.go)\n- pkg/types/cupboard.go (Cupboard and Table interfaces)\n- internal/sqlite/backend.go (SQLite backend satisfies Cupboard interface)\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc004_scaffolding_validation_test.go (create)\n- docs/road-map.yaml (modify) — mark rel01.0-uc004 as done\n\n## Requirements\n- S1-S2: Verify module path and go build succeeds\n- S3-S4: Verify cupboard version prints version string and lists use cases\n- S5: Compile-time checks for all 7 entity structs (Crumb, Trail, Property, Category, Stash, Metadata, Link)\n- S6-S8: Compile-time interface satisfaction (Table, Cupboard, SQLite backend)\n- S9: Standard table name constants exist for all 6 tables\n- S10-S11: GetTable succeeds for all 6 tables, returns ErrTableNotFound for unknown\n\n## Design Decisions\n- Use compile-time interface satisfaction checks (var _ Interface = (*Impl)(nil))\n- Use Go API (not CLI) for GetTable tests to complement existing CLI tests\n- Table-driven tests for entity struct compilation and GetTable\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S11 from the use case\n- [ ] All tests pass with go test ./tests/integration/... -run TestScaffoldingValidation\n- [ ] road-map.yaml updated to mark rel01.0-uc004 as done","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:31.830903-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:46:31.830903-05:00"}
{"id":"generation-2026-02-12-07-13-55-hlm","title":"Implement property backfill on property definition","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R5 backfill)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S7-S9 backfill)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 7-9)\n- internal/sqlite/properties_table.go (Set method, existing backfill logic)\n- internal/sqlite/crumbs_table.go (Fetch for all crumbs)\n\n## Files to Create/Modify\n- internal/sqlite/properties_table.go (modify) — verify and fix backfill logic in Set\n- internal/sqlite/properties_table_test.go (modify or create) — backfill-specific tests\n\n## Requirements\n- When Table.Set creates a new property (empty ID), backfill all existing crumbs with the property's type default\n- Insert crumb_properties row for each existing crumb that lacks a value for this property\n- Backfill must be atomic (within same transaction as property creation)\n- Backfill must not override existing values if a crumb already has this property\n- Verify existing backfill implementation handles edge cases: no crumbs exist, all crumbs already have value\n\n## Design Decisions\n- Backfill runs inside the property Set transaction\n- Use INSERT OR IGNORE to avoid overriding existing crumb_properties rows\n- Fetch all crumb IDs and batch-insert crumb_properties\n\n## Acceptance Criteria\n- [ ] Defining a new property backfills all existing crumbs with type default\n- [ ] Existing property values are not overridden during backfill\n- [ ] Backfill is atomic with property creation\n- [ ] Unit tests verify backfill with multiple existing crumbs\n- [ ] Unit tests verify no override of existing values","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.378307-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:46:32.378307-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-hlm","depends_on_id":"generation-2026-02-12-07-13-55-grm","type":"blocks","created_at":"2026-02-12T17:46:33.154782-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-hq6","title":"Create go-install use case test suite and validate module installability","description":"## Required Reading\n- docs/specs/use-cases/rel01.1-uc001-go-install.yaml (S1-S5 success criteria)\n- docs/specs/test-suites/test-rel01.1-uc001-go-install.yaml (if exists, otherwise create)\n- go.mod (module path, Go version)\n- cmd/cupboard/main.go (entry point)\n\n## Files to Create/Modify\n- docs/specs/test-suites/test-rel01.1-uc001-go-install.yaml (create if missing)\n- tests/integration/test_rel01_1_uc001_go_install_test.go (create)\n\n## Requirements\n- Create test suite YAML if it does not exist (per test-case-format rule)\n- Implement integration tests that validate:\n  - `go build ./cmd/cupboard` succeeds (S1 proxy — go install requires published module)\n  - `cupboard --help` prints usage showing available commands (S2)\n  - `cupboard init` creates data directory with JSONL files (S3)\n  - `cupboard set crumbs` and `cupboard list crumbs` round-trips a crumb (S4)\n  - No manual steps beyond build and run (S5)\n- Since we work offline, test `go build` instead of `go install` (module not published)\n\n## Design Decisions\n- Test go build as a proxy for go install since the module is not published yet\n- Verify --help output contains expected command names\n- Reuse test helpers from existing integration tests\n\n## Acceptance Criteria\n- [ ] Test suite YAML exists at docs/specs/test-suites/test-rel01.1-uc001-go-install.yaml\n- [ ] Integration test validates build, help, init, and round-trip\n- [ ] Tests pass with `go test ./tests/integration/... -run TestGoInstall`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.483161-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:09:39.809098-05:00","closed_at":"2026-02-12T15:09:39.809098-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-l8y","title":"Add integration tests for generic table CLI commands","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc004-generic-table-cli.yaml (test cases to implement)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (success criteria S1-S12)\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (existing test patterns)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (existing test patterns)\n- cmd/cupboard/get.go, set.go, list.go, delete.go (commands under test)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (create)\n\n## Requirements\n- Implement table-driven tests exercising the cupboard CLI binary via os/exec\n- Build cupboard binary in TestMain or test setup, use temp directory for data\n- Test cases per test suite YAML:\n  - Get: valid entity returns JSON (S1), missing entity exit 1 (S2), unknown table exit 1 with valid names (S3)\n  - Set: create with empty ID returns JSON with generated ID (S4), update with existing ID (S5), invalid JSON exit 1 (S6)\n  - List: all entities returns JSON array (S7), with State=draft filter (S8), invalid filter exit 1 (S9)\n  - Delete: removes entity prints confirmation (S10), missing entity exit 1 (S11)\n  - Cross-table: commands work for crumbs, trails, links (S12)\n- Each test case uses a fresh cupboard init in a temp directory\n\n## Design Decisions\n- Use os/exec.Command to run the built binary (true CLI integration test)\n- Build binary once in TestMain, store path in package-level var\n- Helper: runCupboard(t, args...) (stdout, stderr, exitCode) for clean test assertions\n\n## Acceptance Criteria\n- [ ] All 12 success criteria (S1-S12) have at least one test case\n- [ ] Tests use table-driven pattern\n- [ ] Tests build and run the cupboard binary via os/exec\n- [ ] Tests pass with `go test ./tests/integration/... -run TestGenericTableCLI`\n- [ ] Each test case is independent (uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.826149-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:36:29.82977-05:00","closed_at":"2026-02-12T12:36:29.82977-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-l8y","depends_on_id":"generation-2026-02-12-07-13-55-6rc","type":"blocks","created_at":"2026-02-12T12:08:18.937576-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-mdx","title":"Validate built-in property seeding on backend attach","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R3 built-in properties, R3.1-R3.5)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R3 startup, R3.4 built-in property seeding)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S1-S3 built-in properties exist after attach)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 1-3)\n- internal/sqlite/backend.go (Attach method)\n- internal/sqlite/properties_table.go (property operations)\n- pkg/types/property.go (Property struct)\n\n## Files to Create/Modify\n- internal/sqlite/seed.go (create) — built-in property seeding logic\n- internal/sqlite/seed_test.go (create) — unit tests for seeding\n\n## Requirements\n- On Attach, seed built-in properties if they do not already exist: priority (categorical), type (categorical), description (text), owner (text), labels (list)\n- Seed built-in categories for priority (highest, high, medium, low, lowest) and type (task, epic, bug, chore)\n- Seeding must be idempotent (re-attach does not duplicate properties)\n- Verify seeded properties are retrievable via GetTable(\"properties\").Fetch(nil)\n\n## Design Decisions\n- Extract seeding into seed.go to keep backend.go focused on lifecycle\n- Use Table.Set operations for seeding (dogfood the interface)\n- Check existence before inserting to ensure idempotency\n\n## Acceptance Criteria\n- [ ] After Attach, properties table contains 5 built-in properties\n- [ ] After Attach, categories exist for priority and type\n- [ ] Re-attach does not duplicate properties or categories\n- [ ] Unit tests cover seed and idempotency\n- [ ] go build ./cmd/cupboard succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.400236-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:26:04.288553-05:00","closed_at":"2026-02-12T15:26:04.288553-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-mdx","depends_on_id":"generation-2026-02-12-07-13-55-2ys","type":"blocks","created_at":"2026-02-12T14:57:07.581003-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-ny9","title":"Implement trails, links, and properties table accessors","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R5.5-R5.7 trail cascade, R12 table routing)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail entity)\n- docs/specs/product-requirements/prd007-links-interface.yaml (Link entity, types, uniqueness)\n- docs/specs/product-requirements/prd004-properties-interface.yaml (Property, Category entities)\n- internal/sqlite/crumbs_table.go (existing pattern)\n- internal/sqlite/jsonl.go (JSONL helpers)\n\n## Files to Create/Modify\n- internal/sqlite/trails_table.go (create) - trailsTable implementing Table; Get, Set (with cascade on state change: completed removes belongs_to links, abandoned cascades crumb deletion), Delete, Fetch\n- internal/sqlite/links_table.go (create) - linksTable implementing Table; Get, Set (validate uniqueness constraint link_type+from_id+to_id), Delete, Fetch (filter by link_type, from_id, to_id)\n- internal/sqlite/properties_table.go (create) - propertiesTable implementing Table; Get, Set (with backfill: creating property seeds defaults for all existing crumbs), Delete, Fetch\n\n## Requirements\n- trailsTable: hydrate/dehydrate Trail per prd002 R14.3; Set detects state change to completed (remove belongs_to links) or abandoned (cascade delete crumbs + their properties/metadata/links) per prd002 R5.6-R5.7\n- linksTable: hydrate/dehydrate Link per prd002 R14.6; Set validates uniqueness of (link_type, from_id, to_id); Fetch supports filter by link_type, from_id, to_id\n- propertiesTable: hydrate/dehydrate Property per prd002 R14.4; Set triggers backfill of crumb_properties for all existing crumbs when creating a new property\n- Each table persists to its JSONL file atomically\n\n## Design Decisions\n- Trail cascade runs inside the same SQLite transaction as the state update\n- Link uniqueness enforced at SQL level (UNIQUE constraint) and returned as appropriate error\n- Property backfill queries all crumbs and inserts default property values\n\n## Acceptance Criteria\n- [ ] trailsTable implements Table; cascade on completed/abandoned works\n- [ ] linksTable implements Table; uniqueness enforced\n- [ ] propertiesTable implements Table; backfill on creation works\n- [ ] All tables persist to JSONL atomically\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.260855-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:40:40.849524-05:00","closed_at":"2026-02-12T07:40:40.849524-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-ny9","depends_on_id":"generation-2026-02-12-07-13-55-a1t","type":"blocks","created_at":"2026-02-12T07:18:37.306381-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-p57","title":"Add integration tests for property enforcement (S1-S9)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S1-S9 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 1-9)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (integration test patterns)\n- internal/sqlite/seed.go (built-in property seeding)\n- internal/sqlite/crumbs_table.go (auto-init on creation)\n- internal/sqlite/properties_table.go (backfill on definition)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (create)\n\n## Requirements\n- Test built-in properties exist after attach (S1-S3): priority, type, description, owner, labels all present with correct value types\n- Test auto-initialization on crumb creation (S4-S6): new crumb has all properties initialized with type defaults\n- Test backfill on property definition (S7-S9): defining new property backfills all existing crumbs\n- Use table-driven tests mapping to YAML test cases\n- Test via Go API (Cupboard.GetTable, Table.Set/Get/Fetch)\n\n## Design Decisions\n- Integration tests use real SQLite backend with temp directories\n- Each test case starts from preconditions (fresh cupboard)\n- Verify property values by getting crumb and checking Properties map\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S9 from the use case\n- [ ] Tests use table-driven pattern\n- [ ] All tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] Tests are independent (each uses its own temp directory)","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.514036-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:46:32.514036-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-p57","depends_on_id":"generation-2026-02-12-07-13-55-hlm","type":"blocks","created_at":"2026-02-12T17:46:33.255441-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-qg7","title":"Extract shared CLI helpers: attachBackend and entity JSON parsing","description":"## Required Reading\n- cmd/cupboard/get.go (after task 0 — backend initialization pattern)\n- cmd/cupboard/set.go (after task 1 — parseEntityJSON pattern)\n- cmd/cupboard/list.go (after task 2 — shared patterns)\n- cmd/cupboard/delete.go (after task 3 — shared patterns)\n- pkg/types/cupboard.go (standard table name constants)\n- pkg/types/*.go (all entity structs)\n\n## Files to Create/Modify\n- cmd/cupboard/helpers.go (create) — shared helper functions\n- cmd/cupboard/get.go (modify) — use shared helpers\n- cmd/cupboard/set.go (modify) — use shared helpers\n- cmd/cupboard/list.go (modify) — use shared helpers\n- cmd/cupboard/delete.go (modify) — use shared helpers\n\n## Requirements\n- Extract `attachBackend() (*sqlite.Backend, error)` that resolves data dir, creates backend, attaches with sqlite config\n- Extract `parseEntityJSON(tableName string, data []byte) (any, error)` that unmarshals JSON into the correct entity type based on table name\n- Extract `validTableNames` constant string for error messages listing valid tables\n- Deduplicate any repeated patterns across the four command files\n- Follow go-style rule: no duplicated code, extract when pattern appears twice\n\n## Acceptance Criteria\n- [ ] helpers.go contains attachBackend, parseEntityJSON, and validTableNames\n- [ ] All four commands (get, set, list, delete) use shared helpers\n- [ ] No duplicated backend initialization code across command files\n- [ ] All existing tests still pass\n- [ ] Each command file focuses on its specific logic only","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.259742-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:11:49.759987-05:00","closed_at":"2026-02-12T12:11:49.759987-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-qg7","depends_on_id":"generation-2026-02-12-07-13-55-vc2","type":"blocks","created_at":"2026-02-12T08:33:20.351836-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-rpi","title":"Implement configuration loading with platform defaults and precedence chain","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R1-R2 directory structure, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (flow F1-F7, success criteria S1-S9)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R6 global flags)\n- cmd/cupboard/root.go (existing resolveDataDir, global flags)\n\n## Files to Create/Modify\n- internal/paths/paths.go (create) — platform-specific default paths and resolution functions\n- internal/paths/paths_test.go (create) — unit tests for path resolution\n- cmd/cupboard/root.go (modify) — replace resolveDataDir with paths.ResolveDataDir, add resolveConfigDir\n\n## Requirements\n- Implement DefaultConfigDir() and DefaultDataDir() per prd010 R1.2 and R2.2:\n  - Linux: XDG_CONFIG_HOME/crumbs and XDG_DATA_HOME/crumbs (fallback ~/.config/crumbs and ~/.local/share/crumbs)\n  - macOS: ~/Library/Application Support/crumbs (both config and data)\n  - Windows: %APPDATA%/crumbs (both config and data)\n- Implement ResolveConfigDir(flag, env string) string: flag \u003e CRUMBS_CONFIG_DIR env \u003e DefaultConfigDir()\n- Implement ResolveDataDir(flag, configYAMLValue, env string) string: flag \u003e config.yaml data_dir \u003e CRUMBS_DATA_DIR env \u003e DefaultDataDir()\n- For CWD-relative defaults: when --data-dir is empty and no config or env override, use $(CWD)/.crumbs-db (current behavior preserved)\n\n## Design Decisions\n- Use runtime.GOOS for platform detection\n- Use os.UserHomeDir() and os.UserConfigDir() for cross-platform home paths\n- Keep CWD-relative defaults as the primary mode (matching current behavior); platform defaults are used only when env/flag overrides are provided\n\n## Acceptance Criteria\n- [ ] DefaultConfigDir returns correct path per platform\n- [ ] DefaultDataDir returns correct path per platform\n- [ ] ResolveConfigDir follows flag \u003e env \u003e default precedence\n- [ ] ResolveDataDir follows flag \u003e config \u003e env \u003e default precedence\n- [ ] Unit tests verify each precedence level\n- [ ] root.go resolveDataDir uses the new paths package","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.528459-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:20:28.056822-05:00","closed_at":"2026-02-12T12:20:28.056822-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-u5h","title":"Implement issue-tracking CLI ready and show commands","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4.2 ready, R4.5 show commands)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F2 ready, F5 show, S3-S4, S7)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases 4-5, 8)\n- cmd/cupboard/list.go (list command for reference)\n- cmd/cupboard/get.go (get command for reference)\n\n## Files to Create/Modify\n- cmd/cupboard/ready.go (create) — ready command (list open crumbs)\n- cmd/cupboard/show.go (create) — show command (display crumb details with properties)\n- cmd/cupboard/root.go (modify) — register ready and show commands\n\n## Requirements\n- `cupboard ready [--type \u003ctype\u003e] [--json]` — list crumbs in ready state, optionally filtered by type\n- `cupboard show \u003cid\u003e [--json]` — display crumb with all properties, metadata, and links\n- ready outputs table format by default (id, type, title, priority) or JSON with --json\n- show outputs human-readable detail by default or JSON with --json\n- Exit 1 if show receives nonexistent ID\n\n## Design Decisions\n- ready filters by state=ready using Table.Fetch\n- show combines data from crumbs table, properties, and metadata\n- Reuse attachBackend helper\n\n## Acceptance Criteria\n- [ ] `cupboard ready` lists crumbs in ready state\n- [ ] `cupboard ready --type task` filters by type property\n- [ ] `cupboard show \u003cid\u003e` displays crumb details with properties\n- [ ] `cupboard show \u003cinvalid-id\u003e` exits 1\n- [ ] Both commands support --json flag\n- [ ] Commands registered in root.go init()","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.481002-05:00","created_by":"petardjukic","updated_at":"2026-02-12T14:57:07.481002-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-u5h","depends_on_id":"generation-2026-02-12-07-13-55-0c8","type":"blocks","created_at":"2026-02-12T14:57:08.383706-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-uss","title":"Implement generic table CLI delete command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.3 delete command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S10-S11 success criteria for delete)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n\n## Files to Create/Modify\n- cmd/cupboard/delete.go (create) — delete command implementation\n- cmd/cupboard/root.go (modify) — register delete command\n\n## Requirements\n- Implement `cupboard delete \u003ctable\u003e \u003cid\u003e` per prd009-cupboard-cli R3.3\n- Accept table name and entity ID as positional arguments (cobra.ExactArgs(2))\n- Call Table.Delete(id) and output \"Deleted \u003ctable\u003e/\u003cid\u003e\" on success\n- Exit 1 with \"entity not found\" for missing entity\n- Exit 1 with \"unknown table\" for invalid table name\n- Error messages to stderr\n\n## Design Decisions\n- Reuse attachBackend() helper from get command\n- Simple command: no JSON output needed for delete (human message only, unless --json flag added later)\n\n## Acceptance Criteria\n- [ ] `cupboard delete crumbs \u003cvalid-id\u003e` removes entity, prints confirmation, exit 0\n- [ ] `cupboard delete crumbs \u003cnonexistent-id\u003e` returns exit 1 with not-found message\n- [ ] `cupboard delete unknown-table \u003cid\u003e` returns exit 1 with valid table names\n- [ ] Cascade delete works (deleting crumb removes its properties, metadata, links)\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.125864-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:18:28.818797-05:00","closed_at":"2026-02-12T15:18:28.818797-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-uss","depends_on_id":"generation-2026-02-12-07-13-55-9eh","type":"blocks","created_at":"2026-02-12T08:33:20.253722-05:00","created_by":"petardjukic"}],"comments":[{"id":1,"issue_id":"generation-2026-02-12-07-13-55-uss","author":"petardjukic","text":"Duplicate of generation-2026-02-12-07-13-55-dc3 which already implemented the delete command. cmd/cupboard/delete.go exists and tests pass. Closing as stale.","created_at":"2026-02-12T20:18:25Z"}]}
{"id":"generation-2026-02-12-07-13-55-vc2","title":"Implement generic table CLI set command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.2 set command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S4-S6 success criteria for set)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n- internal/sqlite/crumbs_table.go (Set behavior: empty ID creates, existing ID updates)\n\n## Files to Create/Modify\n- cmd/cupboard/set.go (create) — set command implementation\n- cmd/cupboard/root.go (modify) — register set command\n\n## Requirements\n- Implement `cupboard set \u003ctable\u003e \u003cid\u003e \u003cjson\u003e` per prd009-cupboard-cli R3.2\n- Accept table name, ID, and JSON payload as positional arguments (cobra.ExactArgs(3))\n- Empty string ID (\"\") creates a new entity; non-empty ID updates existing\n- Parse JSON payload into appropriate entity struct based on table name\n- Call Table.Set(id, entity) and output the result as pretty-printed JSON\n- Exit 1 with parse error details for invalid JSON\n- Exit 1 with \"unknown table\" message for invalid table name\n- Error messages to stderr\n\n## Design Decisions\n- Need a `parseEntityJSON(tableName string, data []byte) (any, error)` function that unmarshals JSON into the correct entity type (*types.Crumb, *types.Trail, etc.) based on table name\n- Reuse attachBackend() helper from get command\n\n## Acceptance Criteria\n- [ ] `cupboard set crumbs \"\" '{\"Name\":\"Test\",\"State\":\"draft\"}'` creates crumb, returns JSON with CrumbID\n- [ ] `cupboard set crumbs \u003cid\u003e \u003cjson\u003e` updates existing crumb\n- [ ] `cupboard set crumbs \"\" '{invalid}'` returns exit 1 with parse error\n- [ ] `cupboard set unknown-table \"\" '{}'` returns exit 1 with valid table names\n- [ ] Works across table types: crumbs, trails, links, properties, metadata, stashes\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:18.85488-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:38:54.810489-05:00","closed_at":"2026-02-12T08:38:54.810489-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-vc2","depends_on_id":"generation-2026-02-12-07-13-55-9eh","type":"blocks","created_at":"2026-02-12T08:33:20.056952-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-xa1","title":"Add integration tests for regeneration compatibility (S1-S8)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S8 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases)\n- internal/sqlite/loader.go (JSONL loading with forward compat)\n- internal/sqlite/loader_test.go (unit-level forward compat tests from task 6)\n- tests/integration/test_rel01_1_uc002_jsonl_git_roundtrip_test.go (roundtrip test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc002_regeneration_compatibility_test.go (create)\n- docs/road-map.yaml (modify) — mark rel02.0-uc002 as done\n\n## Requirements\n- Test JSONL files with unknown fields load without error (S1-S2)\n- Test crumb data survives simulated regeneration cycle (S3-S4)\n- Test adding a new property to existing JSONL data works (S5)\n- Test removing a field from struct still loads old JSONL (S6)\n- Test JSONL files remain valid after write-back with new struct version (S8)\n\n## Design Decisions\n- Simulate regeneration by creating JSONL files with extra fields, then loading via Cupboard.Attach\n- Use real SQLite backend with temp directories\n- Test both loader.go directly and via full Cupboard.Attach cycle\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S8 from the use case\n- [ ] Tests pass with go test ./tests/integration/... -run TestRegenerationCompatibility\n- [ ] road-map.yaml updated to mark rel02.0-uc002 as done","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.783514-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:46:32.783514-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-xa1","depends_on_id":"generation-2026-02-12-07-13-55-7gs","type":"blocks","created_at":"2026-02-12T17:46:33.353106-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-xxi","title":"Integration tests for SQLite backend: Cupboard lifecycle and crumbs CRUD","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc001-cupboard-lifecycle.yaml (all test cases)\n- docs/specs/test-suites/test-rel01.0-uc002-table-crud.yaml (all test cases)\n- docs/specs/test-suites/test-rel01.0-uc003-crumb-lifecycle.yaml (all test cases)\n- internal/sqlite/backend.go (SQLiteBackend)\n- internal/sqlite/crumbs_table.go (crumbsTable)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (create) - Table-driven tests: Attach with valid config, Attach with invalid config, Detach idempotent, GetTable for all standard names, GetTable for unknown name, operations after Detach return ErrCupboardDetached\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (create) - Table-driven tests: Set creates crumb with UUID v7, Get retrieves by ID, Get returns ErrNotFound, Delete removes crumb, Delete cascades, Fetch with empty filter, Fetch with state filter, Fetch with limit/offset, JSONL persistence after Set/Delete\n- tests/integration/test_rel01_0_uc003_crumb_lifecycle_test.go (create) - Table-driven tests: create draft crumb, transition through states, Pebble from taken, Pebble from non-taken fails, Dust from any state, persist and reload state\n\n## Requirements\n- Use t.TempDir() for DataDir isolation\n- Each test creates a fresh SQLiteBackend, Attaches, runs test cases, Detaches\n- Verify JSONL files are written correctly (read back and parse)\n- Test JSONL roundtrip: Attach, write data, Detach, delete cupboard.db, re-Attach, verify data loaded from JSONL\n- Use testify for assertions\n\n## Design Decisions\n- Integration tests in tests/integration/ per project layout\n- Each test suite file maps to one use case YAML\n- Table-driven tests with shared setup/teardown\n\n## Acceptance Criteria\n- [ ] Cupboard lifecycle tests cover attach/detach/error paths\n- [ ] CRUD tests cover all Table operations\n- [ ] Crumb lifecycle tests cover state machine\n- [ ] JSONL roundtrip test verifies data survives db deletion\n- [ ] All tests pass: go test ./tests/integration/...","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.681468-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:56:58.226051-05:00","closed_at":"2026-02-12T07:56:58.226051-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-xxi","depends_on_id":"generation-2026-02-12-07-13-55-6dx","type":"blocks","created_at":"2026-02-12T07:18:37.614696-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-yzx","title":"Implement property backfill on property definition","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R5 backfill)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S7-S9 backfill)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 7-9)\n- internal/sqlite/properties_table.go (Set method)\n- internal/sqlite/crumbs_table.go (Fetch for all crumbs)\n\n## Files to Create/Modify\n- internal/sqlite/properties_table.go (modify) — add backfill logic in Set when creating new property\n- internal/sqlite/properties_table_test.go (modify or create) — tests for backfill\n\n## Requirements\n- When Table.Set creates a new property (empty ID), backfill all existing crumbs with the property's type default\n- Insert crumb_properties row for each existing crumb that lacks a value for this property\n- Backfill must be atomic (within same transaction as property creation)\n- Backfill must not override existing values if a crumb already has this property\n\n## Design Decisions\n- Backfill runs inside the property Set transaction\n- Use INSERT OR IGNORE to avoid overriding existing crumb_properties rows\n- Fetch all crumb IDs and batch-insert crumb_properties in one SQL statement\n\n## Acceptance Criteria\n- [ ] Defining a new property backfills all existing crumbs with type default\n- [ ] Existing property values are not overridden during backfill\n- [ ] Backfill is atomic with property creation\n- [ ] Unit tests verify backfill with multiple existing crumbs\n- [ ] Unit tests verify no override of existing values","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.671983-05:00","created_by":"petardjukic","updated_at":"2026-02-12T14:57:06.671983-05:00","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-yzx","depends_on_id":"generation-2026-02-12-07-13-55-bpu","type":"blocks","created_at":"2026-02-12T14:57:07.780688-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-z0q","title":"Add crumbs table benchmark tests (rel01.0-uc005)","description":"## Required Reading\n- docs/specs/use-cases/rel01.0-uc005-crumbs-table-benchmarks.yaml (S1-S10 success criteria)\n- docs/specs/test-suites/test-rel01.0-uc005-crumbs-table-benchmarks.yaml (16 test cases)\n- internal/sqlite/crumbs_table.go (Get, Set, Delete, Fetch implementations)\n- internal/sqlite/backend.go (Attach for setup)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc005_crumbs_table_benchmarks_test.go (create)\n- docs/road-map.yaml (modify) — mark rel01.0-uc005 as done\n\n## Requirements\n- Benchmark Get at 4 scales: 10, 100, 1000, 10000 crumbs (S5)\n- Benchmark Set create at 2 scales: 10, 1000 existing crumbs (S6)\n- Benchmark Set update at 2 scales: 10, 1000 crumbs (S7)\n- Benchmark Delete at 2 scales: 10, 1000 crumbs (S8)\n- Benchmark Fetch all at 2 scales: 100, 1000 crumbs (S9)\n- Benchmark Fetch with state filter at 2 scales: 100, 1000 crumbs (S10)\n- Each benchmark reports ns/op, B/op, allocs/op (S1-S4)\n\n## Design Decisions\n- Use Go benchmark framework (testing.B) with -benchmem\n- Use StopTimer/StartTimer for Delete to exclude setup cost\n- Random ID selection for Get/Update benchmarks\n- Each benchmark function creates a fresh cupboard with temp directory\n\n## Acceptance Criteria\n- [ ] 16 benchmark functions covering all operations and scales\n- [ ] Benchmarks run with go test ./tests/integration/... -bench=BenchmarkCrumbs -benchmem\n- [ ] road-map.yaml updated to mark rel01.0-uc005 as done","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:31.968722-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:46:31.968722-05:00"}
