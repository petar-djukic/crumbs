{"id":"generation-2026-02-11-19-04-109","title":"Define core types and interfaces in pkg/types (prd001-cupboard-core R1-R8)","description":"## Required Reading\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (full PRD: Config, Cupboard, Table, errors, UUID v7)\n- docs/ARCHITECTURE.md ยง System Overview, ยง Main Interfaces, ยง Design Decisions\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (Crumb struct fields and states)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail struct)\n- docs/specs/product-requirements/prd004-properties-interface.yaml (Property and Category structs)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (Metadata struct)\n- docs/specs/product-requirements/prd007-links-interface.yaml (Link struct)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (Stash struct)\n- docs/specs/use-cases/rel01.0-uc001-cupboard-lifecycle.yaml (lifecycle flow and demo code)\n- docs/specs/use-cases/rel01.0-uc004-scaffolding-validation.yaml (all types must compile)\n\n## Files to Create/Modify\n- pkg/types/config.go (create) - Config struct, config validation errors (R1)\n- pkg/types/cupboard.go (create) - Cupboard interface, lifecycle errors (R2, R4-R6)\n- pkg/types/table.go (create) - Table interface, table operation errors, entity method errors (R3, R7)\n- pkg/types/crumb.go (create) - Crumb struct with all fields and state constants (from prd003 R1)\n- pkg/types/trail.go (create) - Trail struct with state constants (from prd006 R1)\n- pkg/types/property.go (create) - Property and Category structs (from prd004 R1)\n- pkg/types/metadata.go (create) - Metadata struct (from prd005 R1)\n- pkg/types/link.go (create) - Link struct and link type constants (from prd007 R1)\n- pkg/types/stash.go (create) - Stash struct and stash type constants (from prd008 R1)\n- pkg/types/tables.go (create) - Standard table name constants (R2.5)\n\n## Requirements\n- Define Config struct with Backend (string) and DataDir (string) fields per R1.1\n- Define config validation errors (ErrBackendEmpty, ErrBackendUnknown, ErrSyncStrategyUnknown, ErrBatchSizeInvalid, ErrBatchIntervalInvalid) per R1.4\n- Define Cupboard interface with GetTable, Attach, Detach per R2.2\n- Define Table interface with Get, Set (returning string, error), Delete, Fetch per R3.1\n- Define all standard error types from R7.1 (cupboard lifecycle), R7.2 (table operations), and R7.3 (entity methods)\n- Define standard table name constants (crumbs, trails, properties, metadata, links, stashes) per R2.5\n- Define all entity structs (Crumb, Trail, Property, Category, Metadata, Link, Stash) with fields from their respective PRDs\n- Define state constants for Crumb (draft, pending, ready, taken, pebble, dust) and Trail (draft, pending, active, completed, abandoned)\n- Define link type constants (belongs_to, child_of, branches_from, scoped_to)\n- Define stash type constants (resource, artifact, context, counter, lock)\n- All entity IDs are string type (UUID v7 generated by backend, not by types package)\n- Use time.Time for timestamps\n\n## Design Decisions\n- pkg/types is the contract layer: interfaces and structs only, no implementation\n- Entity structs use exported fields for JSON serialization\n- State values are string constants, not iota enums (matches JSONL persistence)\n- No constructor functions in pkg/types; backends and callers construct structs directly\n- Table interface uses any for entity types; callers use type assertions per R3.6\n- Config struct must be JSON/YAML serializable per constraints\n\n## Acceptance Criteria\n- [ ] All files compile: go build ./pkg/types/...\n- [ ] Config struct has Backend and DataDir fields\n- [ ] Cupboard interface has GetTable(string) (Table, error), Attach(Config) error, Detach() error\n- [ ] Table interface has Get(string) (any, error), Set(string, any) (string, error), Delete(string) error, Fetch(map[string]any) ([]any, error)\n- [ ] All 6 standard table name constants defined\n- [ ] All error sentinels from R1.4, R7.1, R7.2, R7.3 defined\n- [ ] All entity structs defined with fields matching their PRDs\n- [ ] State constants defined for Crumb and Trail\n- [ ] Link type and stash type constants defined\n- [ ] Package doc comment references prd001-cupboard-core and ARCHITECTURE","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-11T19:06:59.440833-05:00","created_by":"petardjukic","updated_at":"2026-02-11T19:09:43.739843-05:00","closed_at":"2026-02-11T19:09:43.739843-05:00","close_reason":"Closed"}
