{"id":"generation-2026-02-12-07-13-55-01h","title":"Validate self-hosting workflow end-to-end (rel02.1-uc003)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (all flows, S1-S7)\n- docs/specs/test-suites/test-rel02.1-uc003-self-hosting.yaml (validation scenarios)\n- scripts/do-work.sh (agent workflow script)\n- scripts/make-work.sh (issue creation script)\n- .claude/rules/cupboard-workflow.md (agent instructions)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_1_uc003_self_hosting_test.go (create) — self-hosting validation\n\n## Requirements\n- Test S1: cupboard ready returns available tasks as JSON\n- Test S2: cupboard create creates task with type, title, description\n- Test S3: cupboard update transitions state to in_progress\n- Test S4: cupboard close marks task as closed\n- Test S5: cupboard list --json returns all crumbs\n- Test S6: do-work.sh completes full cycle (pick, worktree, close)\n- Test S7: make-work.sh creates issues and commits JSONL\n- Use real scripts in test (not mocked)\n- Verify JSONL files committed to git\n- Verify worktree cleanup\n\n## Design Decisions\n- Integration test runs real scripts as subprocess\n- Test uses temp git repository for isolation\n- Test validates both script exit codes and side effects\n- Agent invocation in do-work.sh can be no-op for test\n\n## Acceptance Criteria\n- [ ] All S1-S7 success criteria validated\n- [ ] do-work.sh picks task, creates worktree, closes task\n- [ ] make-work.sh creates issues from JSON file\n- [ ] JSONL files committed to git after operations\n- [ ] Worktrees cleaned up after do-work.sh\n- [ ] Tests pass with go test ./tests/integration/... -run TestSelfHosting\n- [ ] Tests use temp directories and clean up","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.844324-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:02:08.25734-05:00","closed_at":"2026-02-13T01:02:08.25734-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-01h","depends_on_id":"generation-2026-02-12-07-13-55-rh1","type":"blocks","created_at":"2026-02-12T22:15:48.795655-05:00","created_by":"petardjukic"}],"comments":[{"id":23,"issue_id":"generation-2026-02-12-07-13-55-01h","author":"petardjukic","text":"duration: 6m35s | tokens: in=91 out=17362 | loc: +351 -1 files=2","created_at":"2026-02-13T06:02:08Z"}]}
{"id":"generation-2026-02-12-07-13-55-0c8","title":"Implement issue-tracking CLI create command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4.1 create command)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F1 create, S1-S2)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases 1-3)\n- cmd/cupboard/set.go (generic set command for reference)\n- pkg/types/crumb.go (Crumb struct, SetProperty)\n\n## Files to Create/Modify\n- cmd/cupboard/create.go (create) — issue-tracking create command\n- cmd/cupboard/root.go (modify) — register create command\n\n## Requirements\n- Implement `cupboard create --type \u003ctype\u003e --title \u003ctitle\u003e [--description \u003cdesc\u003e] [--labels \u003ccsv\u003e] [--json]`\n- Create a crumb with properties set: type, description, owner, labels\n- Set initial state to draft\n- Output created crumb ID (or full JSON with --json)\n- Validate --type against known categories (task, epic, bug, chore)\n- Exit 1 if --title is missing\n\n## Design Decisions\n- create is a convenience wrapper around set + property operations\n- Uses attachBackend helper from existing commands\n- Sets properties via Crumb.SetProperty before Table.Set\n\n## Acceptance Criteria\n- [ ] `cupboard create --type task --title \"Test\"` creates crumb with type=task, exit 0\n- [ ] `cupboard create` without --title exits 1 with error\n- [ ] `cupboard create --type task --title \"T\" --json` outputs JSON with crumb details\n- [ ] Created crumb has all built-in properties initialized\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.344972-05:00","created_by":"petardjukic","updated_at":"2026-02-12T23:13:12.052468-05:00","closed_at":"2026-02-12T23:13:12.052468-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-0c8","depends_on_id":"generation-2026-02-12-07-13-55-10x","type":"blocks","created_at":"2026-02-12T14:57:08.283924-05:00","created_by":"petardjukic"}],"comments":[{"id":13,"issue_id":"generation-2026-02-12-07-13-55-0c8","author":"petardjukic","text":"duration: 3m45s | tokens: in=80 out=8906 | loc: +0 -0 files=0","created_at":"2026-02-13T04:13:11Z"}]}
{"id":"generation-2026-02-12-07-13-55-10x","title":"Add property enforcement CLI validation (S10-S15)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S10-S15 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 10-15)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3 generic table commands)\n- cmd/cupboard/set.go (set command patterns)\n- cmd/cupboard/list.go (list command patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (modify) — add CLI-based tests\n\n## Requirements\n- Test creating property via CLI: cupboard set properties (S10)\n- Test listing properties via CLI: cupboard list properties (S11)\n- Test creating crumb via CLI shows auto-initialized properties (S12)\n- Test defining new property via CLI backfills existing crumbs (S13)\n- Test category operations via CLI: set categories, list categories (S14-S15)\n- Use os/exec to run cupboard binary, parse JSON output\n\n## Design Decisions\n- Extend the existing property enforcement test file with CLI test functions\n- Use --json flag for machine-readable output verification\n- Build cupboard binary once per test suite, reuse across test cases\n\n## Acceptance Criteria\n- [ ] CLI tests cover S10-S15 from the use case\n- [ ] Tests verify JSON output contains expected property values\n- [ ] Tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] road-map.yaml updated to mark rel02.0-uc001-property-enforcement as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.942087-05:00","created_by":"petardjukic","updated_at":"2026-02-12T23:09:25.823651-05:00","closed_at":"2026-02-12T23:09:25.823651-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-10x","depends_on_id":"generation-2026-02-12-07-13-55-90v","type":"blocks","created_at":"2026-02-12T14:57:07.981662-05:00","created_by":"petardjukic"}],"comments":[{"id":12,"issue_id":"generation-2026-02-12-07-13-55-10x","author":"petardjukic","text":"duration: 5m13s | tokens: in=62 out=13572 | loc: +196 -91 files=3","created_at":"2026-02-13T04:09:25Z"}]}
{"id":"generation-2026-02-12-07-13-55-16k","title":"Implement issue-tracking CLI create command (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4.1 create command)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F1 create, S1-S2)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases 1-3)\n- cmd/cupboard/set.go (generic set command for reference)\n- cmd/cupboard/helpers.go (attachBackend helper)\n- pkg/types/crumb.go (Crumb struct, SetProperty)\n\n## Files to Create/Modify\n- cmd/cupboard/create.go (create) — issue-tracking create command\n- cmd/cupboard/root.go (modify) — register create command\n\n## Requirements\n- Implement `cupboard create --type \u003ctype\u003e --title \u003ctitle\u003e [--description \u003cdesc\u003e] [--labels \u003ccsv\u003e] [--json]`\n- Create a crumb with properties set: type, description, owner, labels\n- Set initial state to draft\n- Output created crumb ID (or full JSON with --json)\n- Validate --type against known categories (task, epic, bug, chore)\n- Exit 1 if --title is missing\n\n## Design Decisions\n- create is a convenience wrapper around set + property operations\n- Uses attachBackend helper from existing commands\n- Sets properties via Crumb.SetProperty before Table.Set\n\n## Acceptance Criteria\n- [ ] `cupboard create --type task --title \"Test\"` creates crumb with type=task, exit 0\n- [ ] `cupboard create` without --title exits 1 with error\n- [ ] `cupboard create --type task --title \"T\" --json` outputs JSON with crumb details\n- [ ] Created crumb has all built-in properties initialized\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:33.055686-05:00","created_by":"petardjukic","updated_at":"2026-02-12T19:14:37.7473-05:00","closed_at":"2026-02-12T19:14:37.7473-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-16k","depends_on_id":"generation-2026-02-12-07-13-55-40r","type":"blocks","created_at":"2026-02-12T17:46:33.552069-05:00","created_by":"petardjukic"}],"comments":[{"id":3,"issue_id":"generation-2026-02-12-07-13-55-16k","author":"petardjukic","text":"duration: 3m43s | tokens: in=75 out=10124 | loc: +177 -1 files=4","created_at":"2026-02-13T00:14:37Z"}]}
{"id":"generation-2026-02-12-07-13-55-2ej","title":"Add integration tests for flat self-hosting workflow","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc005-flat-self-hosting.yaml (test cases: init, create, list, get, update, delete, end-to-end workflows, persistence)\n- docs/specs/use-cases/rel01.1-uc005-flat-self-hosting.yaml (S1-S10 success criteria)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (after task 2 — CLI test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc005_flat_self_hosting_test.go (create)\n\n## Requirements\n- Test full issue-tracking workflow using only generic table commands:\n  - Initialize cupboard (S1)\n  - Create crumb with set (S2)\n  - List all crumbs (S3)\n  - List with State=draft filter (S4)\n  - Update state to taken (S5)\n  - Update state to pebble/close (S6)\n  - Get crumb details (S7)\n  - Do-work cycle: create -\u003e list draft -\u003e claim (taken) -\u003e close (pebble) (S8)\n  - Make-work cycle: list existing -\u003e create multiple new crumbs (S9)\n  - JSONL persistence survives database deletion (S10)\n- Use os/exec to run cupboard binary\n- Parse JSON output to extract CrumbIDs for subsequent operations\n\n## Design Decisions\n- Tests mirror the do-work.sh and make-work.sh workflow patterns\n- Each end-to-end test runs the full sequence in a single temp directory\n- JSON parsing with encoding/json for output verification\n- Reuse runCupboard helper from generic table CLI tests if in same package\n\n## Acceptance Criteria\n- [ ] All 10 success criteria (S1-S10) have test coverage\n- [ ] Do-work cycle test runs full create -\u003e claim -\u003e close workflow\n- [ ] Make-work cycle test creates multiple crumbs and verifies count\n- [ ] JSONL persistence test deletes .db file and verifies data survives\n- [ ] Tests pass with `go test ./tests/integration/... -run TestFlatSelfHosting`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.350884-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:07:37.954017-05:00","closed_at":"2026-02-12T15:07:37.954017-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-2ej","depends_on_id":"generation-2026-02-12-07-13-55-l8y","type":"blocks","created_at":"2026-02-12T12:08:19.225646-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-2j0","title":"Implement JSONL forward-compatibility for regeneration use case","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S4 forward compatibility)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases 1-4)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R2 JSONL format)\n- internal/sqlite/loader.go (JSONL parsing)\n- pkg/types/ (entity struct definitions)\n\n## Files to Create/Modify\n- internal/sqlite/loader.go (modify) — ensure unknown JSON fields are tolerated during JSONL loading\n- internal/sqlite/loader_test.go (modify or create) — tests for forward compatibility\n\n## Requirements\n- JSONL loader must tolerate unknown fields in entity JSON (forward compatibility)\n- Unknown fields must be preserved through read-write cycle (round-trip fidelity)\n- Verify that generation N+1 can read generation N's JSONL files\n- Verify that adding new entity fields does not break existing JSONL files\n\n## Design Decisions\n- Use json.Decoder with DisallowUnknownFields disabled (Go default behavior)\n- For round-trip preservation, consider storing raw JSON alongside typed struct\n- If round-trip preservation is too complex, at minimum ensure unknown fields do not cause errors\n\n## Acceptance Criteria\n- [ ] JSONL loader does not error on unknown fields\n- [ ] Entity structs can be loaded from JSONL with extra fields\n- [ ] Unit tests verify loading JSONL with future fields\n- [ ] Existing JSONL round-trip tests continue to pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.074809-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:50:52.154559-05:00","closed_at":"2026-02-12T17:50:52.154559-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-2j0","depends_on_id":"generation-2026-02-12-07-13-55-2ys","type":"blocks","created_at":"2026-02-12T14:57:08.081754-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-2ys","title":"Close stale issues and update road-map.yaml statuses","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- All open beads issues (bd list --status open)\n- All in-progress beads issues (bd list --status in_progress)\n- tests/integration/test_rel01_1_uc005_flat_self_hosting_test.go (confirms flat self-hosting is done)\n- cmd/cupboard/delete.go (confirms delete command is done)\n- cmd/cupboard/config.go (confirms config loading is done)\n- internal/paths/paths.go (confirms paths package is done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel01.1-uc005-flat-self-hosting status to done\n\n## Requirements\n- Update rel01.1-uc005-flat-self-hosting status to done in road-map.yaml (code and tests exist and pass)\n- Close stale beads issues that duplicate already-completed work:\n  - generation-...-uss (delete command) — already implemented, close it\n  - generation-...-2ej (flat self-hosting tests) — already implemented, close it\n  - generation-...-3st (config.yaml with Viper) — already implemented, close it\n  - generation-...-9yb (init --config-dir) — already implemented, close it\n  - generation-...-b17 (config loading tests) — already implemented, close it\n  - generation-...-adl (road-map update) — will be addressed by this task, close it\n- Verify rel01.1-uc003-configuration-loading and rel01.1-uc004-generic-table-cli remain correctly marked done\n- Verify no other road-map statuses need correction\n\n## Acceptance Criteria\n- [ ] road-map.yaml shows rel01.1-uc005-flat-self-hosting as done\n- [ ] All stale duplicate issues closed with explanatory comments\n- [ ] road-map.yaml statuses match actual implementation state\n- [ ] Release 01.1 shows 4/5 done (only go-install remains)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.261251-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:20:08.299294-05:00","closed_at":"2026-02-12T15:20:08.299294-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-3cu","title":"Add benchmark suite for crumbs table operations (rel02.1-uc002)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc002-table-benchmarks.yaml (F1-F9 benchmark flows, S1-S9)\n- docs/specs/test-suites/test-rel02.1-uc002-table-benchmarks.yaml (all test cases)\n- tests/integration/test_rel01_0_uc005_crumbs_table_benchmarks_test.go (existing benchmark reference if exists)\n- internal/sqlite/crumbs_table.go (implementation to benchmark)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_bench_test.go (create) — benchmark suite for crumbs table\n\n## Requirements\n- Implement Get benchmarks: BenchmarkCrumbsGet10, Get100, Get1000, Get10000\n- Implement Set benchmarks for create: BenchmarkCrumbsSetCreate10, SetCreate1000\n- Implement Set benchmarks for update: BenchmarkCrumbsSetUpdate10, SetUpdate1000\n- Implement Delete benchmarks: BenchmarkCrumbsDelete10, Delete1000\n- Implement Fetch benchmarks: BenchmarkFetchAll, FetchState, FetchProperties, FetchLimit\n- Implement property benchmarks: BenchmarkCrumbSetProperty10, SetProperty1000\n- Each benchmark seeds data before b.ResetTimer()\n- Get operations use random selection from seeded IDs\n- Set create measures empty ID path (UUID v7 generation)\n- Set update measures existing ID path\n- Delete measures cascade including properties, metadata, links\n- Fetch benchmarks measure different filter types and index usage\n- Use -benchmem flag to capture allocations\n\n## Design Decisions\n- Follow Go benchmark conventions (func Benchmark*, *testing.B, b.N iterations)\n- Seed data outside timer to measure only the operation under test\n- Use temp directories for each benchmark suite run\n- JSONL sync cost included (immediate strategy per prd002 R16.2)\n- Random selection for Get to avoid cache effects\n\n## Acceptance Criteria\n- [ ] go test -bench=BenchmarkCrumbsGet -benchmem ./internal/sqlite/... runs without error\n- [ ] go test -bench=BenchmarkCrumbsSet -benchmem ./internal/sqlite/... completes for create and update\n- [ ] go test -bench=BenchmarkCrumbsFetch -benchmem ./internal/sqlite/... completes for all filter types\n- [ ] go test -bench=. -benchmem ./internal/sqlite/... \u003e baseline.txt captures full suite\n- [ ] baseline.txt contains ns/op, B/op, allocs/op for all benchmarks\n- [ ] All benchmarks execute without error\n- [ ] Variance under 10% across multiple runs\n- [ ] Baseline file committed to repository","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:46.208119-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:59:00.862367-05:00","closed_at":"2026-02-12T22:59:00.862367-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-3fc","title":"Update SPECIFICATIONS.md roadmap summary for completed release 03.0","description":"## Required Reading\n- docs/SPECIFICATIONS.md (specifications document)\n- docs/road-map.yaml (updated roadmap, dependency)\n- .claude/rules/specification-format.md (specification format rule)\n\n## Files to Create/Modify\n- docs/SPECIFICATIONS.md (update)\n\n## Requirements\nRegenerate the Roadmap Summary table in SPECIFICATIONS.md to reflect the completed release 03.0. Update the table row for release 03.0 from \"2 / 4\" use cases and \"in progress\" status to \"4 / 4\" use cases and \"done\" status.\n\n## Design Decisions\n- Follow specification-format rule for table structure\n- Only update the Roadmap Summary table; do not modify other sections unless they reference release status\n\n## Acceptance Criteria\n- [ ] Roadmap Summary table updated with release 03.0 showing 4/4 use cases done\n- [ ] Release 03.0 status changed to \"done\"\n- [ ] Table formatting preserved (markdown table with headers)\n- [ ] File saved and committed","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.45279-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:25:27.037956-05:00","closed_at":"2026-02-13T01:25:27.037956-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-3fc","depends_on_id":"generation-2026-02-12-07-13-55-ukh","type":"blocks","created_at":"2026-02-13T01:09:08.318779-05:00","created_by":"petardjukic"}],"comments":[{"id":30,"issue_id":"generation-2026-02-12-07-13-55-3fc","author":"petardjukic","text":"duration: 1m14s | tokens: in=27 out=3579 | loc: +4 -4 files=2","created_at":"2026-02-13T06:25:26Z"}]}
{"id":"generation-2026-02-12-07-13-55-3st","title":"Implement config.yaml loading with Viper","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R7 config.yaml, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (F4 load config.yaml, F6 create on first run, S6-S8)\n- cmd/cupboard/root.go (existing flag handling)\n- internal/paths/paths.go (after task 3 — ResolveConfigDir)\n\n## Files to Create/Modify\n- cmd/cupboard/config.go (create) — Viper-based config loading\n- cmd/cupboard/root.go (modify) — integrate config loading into PersistentPreRunE\n\n## Requirements\n- Load config.yaml from resolved config directory using Viper\n- Config file fields: backend (string, default \"sqlite\"), data_dir (string, optional)\n- Create config directory on first run if it does not exist\n- Create default config.yaml on first run if config dir exists but file does not\n- Missing config.yaml is not an error (use defaults)\n- Integrate into root command's PersistentPreRunE so all subcommands benefit\n- Pass resolved data_dir from config.yaml to resolveDataDir pipeline\n\n## Design Decisions\n- Use spf13/viper for config file parsing (per go-style standard ecosystem)\n- Config loading happens once in PersistentPreRunE, not per-command\n- Keep it minimal: only load data_dir and backend from config.yaml\n\n## Acceptance Criteria\n- [ ] config.yaml is loaded from resolved config directory\n- [ ] data_dir from config.yaml is respected when no --data-dir flag provided\n- [ ] Missing config.yaml uses defaults without error\n- [ ] Config directory created on first run if absent\n- [ ] Default config.yaml created on first run if absent\n- [ ] PersistentPreRunE integrates config loading for all commands","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.089282-05:00","created_by":"petardjukic","updated_at":"2026-02-12T14:58:24.741554-05:00","closed_at":"2026-02-12T14:58:24.741554-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-3st","depends_on_id":"generation-2026-02-12-07-13-55-a31","type":"blocks","created_at":"2026-02-12T12:08:19.032953-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-40r","title":"Add property enforcement CLI validation tests (S10-S15)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S10-S15 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 10-15)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3 generic table commands)\n- cmd/cupboard/set.go (set command patterns)\n- cmd/cupboard/list.go (list command patterns)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (CLI test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (modify) — add CLI-based tests\n- docs/road-map.yaml (modify) — mark rel02.0-uc001-property-enforcement as done\n\n## Requirements\n- Test creating property via CLI: cupboard set properties (S10)\n- Test listing properties via CLI: cupboard list properties (S11)\n- Test creating crumb via CLI shows auto-initialized properties (S12)\n- Test defining new property via CLI backfills existing crumbs (S13)\n- Test category operations via CLI: cupboard set categories, cupboard list categories (S14-S15)\n- Use os/exec to run cupboard binary, parse JSON output\n\n## Design Decisions\n- Extend the existing property enforcement test file with CLI test functions\n- Use --json flag for machine-readable output verification\n- Build cupboard binary once per test suite, reuse across test cases\n\n## Acceptance Criteria\n- [ ] CLI tests cover S10-S15 from the use case\n- [ ] Tests verify JSON output contains expected property values\n- [ ] Tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] road-map.yaml updated to mark rel02.0-uc001 as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.918917-05:00","created_by":"petardjukic","updated_at":"2026-02-12T19:06:45.009236-05:00","closed_at":"2026-02-12T19:06:45.009236-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-40r","depends_on_id":"generation-2026-02-12-07-13-55-p57","type":"blocks","created_at":"2026-02-12T17:46:33.45282-05:00","created_by":"petardjukic"}],"comments":[{"id":2,"issue_id":"generation-2026-02-12-07-13-55-40r","author":"petardjukic","text":"duration: 6m54s | tokens: in=51 out=20146 | loc: +363 -6 files=3","created_at":"2026-02-13T00:06:44Z"}]}
{"id":"generation-2026-02-12-07-13-55-57l","title":"Define Config struct, Cupboard interface, and Table interface in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R1-R3, R7-R8)\n- docs/ARCHITECTURE.md § Main Interface, § Design Decisions\n\n## Files to Create/Modify\n- pkg/types/config.go (create) - Config struct with Backend, DataDir fields; config validation errors (ErrBackendEmpty, ErrBackendUnknown, ErrSyncStrategyUnknown, ErrBatchSizeInvalid, ErrBatchIntervalInvalid); Validate() method\n- pkg/types/cupboard.go (create) - Cupboard interface with GetTable, Attach, Detach; standard table name constants; cupboard lifecycle errors (ErrCupboardDetached, ErrAlreadyAttached, ErrTableNotFound)\n- pkg/types/table.go (create) - Table interface with Get, Set, Delete, Fetch; table operation errors (ErrNotFound, ErrInvalidID, ErrInvalidData, ErrInvalidFilter); Filter type alias\n\n## Requirements\n- Config struct with Backend (string) and DataDir (string) fields per prd001 R1\n- Config.Validate() checks Backend not empty, Backend recognized, DataDir not empty when Backend is \"sqlite\"\n- Cupboard interface: GetTable(name string) (Table, error), Attach(config Config) error, Detach() error\n- Table interface: Get(id string) (any, error), Set(id string, data any) (string, error), Delete(id string) error, Fetch(filter map[string]any) ([]any, error)\n- Standard table name constants: crumbs, trails, properties, metadata, links, stashes\n- All sentinel errors defined per prd001 R7 with errors.New\n- Filter type alias: type Filter = map[string]any\n\n## Design Decisions\n- Interfaces in pkg/types (shared contract layer); implementations in internal/\n- Config struct, not interface, for serialization compatibility\n- Sentinel errors for errors.Is compatibility\n\n## Acceptance Criteria\n- [ ] Config struct compiles with Backend and DataDir fields\n- [ ] Config.Validate() returns correct errors for empty/unknown backend, empty DataDir\n- [ ] Cupboard interface compiles with GetTable, Attach, Detach\n- [ ] Table interface compiles with Get, Set, Delete, Fetch\n- [ ] All 6 standard table name constants defined\n- [ ] All sentinel errors from prd001 R7.1-R7.3 defined\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.592955-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:21:38.136407-05:00","closed_at":"2026-02-12T07:21:38.136407-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-58c","title":"Implement integration tests for rel03.1-uc001-self-hosting-with-epics","description":"## Required Reading\n- docs/specs/use-cases/rel03.1-uc001-self-hosting-with-epics.yaml (use case definition)\n- docs/specs/test-suites/test-rel03.1-uc001-self-hosting-with-epics.yaml (test cases to implement)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail lifecycle)\n- docs/specs/product-requirements/prd007-links-interface.yaml (belongs_to links)\n- tests/integration/test_rel02_1_uc003_self_hosting_test.go (flat self-hosting pattern)\n- tests/integration/test_rel03_0_uc001_trail_exploration_test.go (trail usage pattern, dependency)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_1_uc001_self_hosting_with_epics_test.go (create)\n\n## Requirements\nImplement the 24 test cases from test-rel03.1-uc001-self-hosting-with-epics.yaml that validate:\n- Create trail as epic container (TC01-TC03)\n- Associate task crumbs with epic trail via belongs_to links (TC04-TC06)\n- Query epic membership using links table (TC07-TC09)\n- Move tasks between epics by updating belongs_to links (TC10-TC12)\n- Complete epic and verify tasks become permanent (TC13-TC15)\n- Abandon epic and verify cascade deletion of tasks (TC16-TC18)\n- Verify epic lifecycle matches trail lifecycle semantics (TC19-TC21)\n- End-to-end epic workflow (TC22-TC24)\n\n## Design Decisions\n- Use table-driven test pattern with subtests\n- Model epics as trails in active state with belongs_to links to task crumbs\n- Validate epic-as-container semantics: trail lifecycle controls grouped tasks\n- Follow self-hosting test pattern from test_rel02_1_uc003_self_hosting_test.go for realistic workflow\n\n## Acceptance Criteria\n- [ ] All 24 test cases from test-rel03.1-uc001-self-hosting-with-epics.yaml implemented\n- [ ] Table-driven test structure with one row per test case\n- [ ] Tests pass: go test -v ./tests/integration -run TestSelfHostingWithEpics\n- [ ] Test file saved as test_rel03_1_uc001_self_hosting_with_epics_test.go\n- [ ] Assertions verify success criteria from use case\n- [ ] Realistic workflow demonstrated: create epic, add tasks, complete/abandon epic","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.582098-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:30:13.476126-05:00","closed_at":"2026-02-13T01:30:13.476126-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-58c","depends_on_id":"generation-2026-02-12-07-13-55-bul","type":"blocks","created_at":"2026-02-13T01:09:08.438375-05:00","created_by":"petardjukic"}],"comments":[{"id":31,"issue_id":"generation-2026-02-12-07-13-55-58c","author":"petardjukic","text":"duration: 4m46s | tokens: in=59 out=17684 | loc: +645 -1 files=2","created_at":"2026-02-13T06:30:13Z"}]}
{"id":"generation-2026-02-12-07-13-55-5mn","title":"Implement cupboard close command (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R5.6 close command)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R4.3 Pebble method)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F12-F13 close)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test case 9)\n- cmd/cupboard/create.go (command pattern reference)\n- pkg/types/crumb.go (Crumb.Pebble method)\n\n## Files to Create/Modify\n- cmd/cupboard/close.go (create) — close command implementation\n- cmd/cupboard/root.go (modify) — register close command\n\n## Requirements\n- Implement `cupboard close \u003cid\u003e [--json]` command\n- Retrieve crumb via Table.Get, type-assert to *Crumb\n- Call crumb.Pebble() to transition to pebble state (requires taken state)\n- Persist via Table.Set with the crumb's ID\n- Human-readable output: \"Closed \u003cid\u003e\"\n- JSON output (with --json flag): full crumb object\n- Exit 0 on success\n- Exit 1 if crumb not found or invalid state transition\n- Error messages follow prd009 R9 format\n\n## Design Decisions\n- Use attachBackend helper from existing commands\n- Get-modify-set pattern: retrieve entity, call entity method, persist\n- Pebble() enforces state transition rules (must be in taken state)\n- Human-readable output by default, JSON with --json flag\n\n## Acceptance Criteria\n- [ ] `cupboard close \u003cid\u003e` sets state to pebble and exits 0\n- [ ] `cupboard close \u003cid\u003e --json` outputs JSON with pebble state\n- [ ] `cupboard close \u003cnonexistent-id\u003e` exits 1 with \"not found\" error\n- [ ] `cupboard close \u003cid\u003e` from non-taken state exits 1 with state transition error\n- [ ] Human-readable output prints \"Closed \u003cid\u003e\"\n- [ ] Command registered in root.go init()\n- [ ] Error messages written to stderr\n- [ ] Success output written to stdout","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:45.765269-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:28:04.59578-05:00","closed_at":"2026-02-12T22:28:04.59578-05:00","close_reason":"Closed","comments":[{"id":7,"issue_id":"generation-2026-02-12-07-13-55-5mn","author":"petardjukic","text":"duration: 2m5s | tokens: in=60 out=5491 | loc: +84 -1 files=3","created_at":"2026-02-13T03:28:04Z"}]}
{"id":"generation-2026-02-12-07-13-55-5n8","title":"Complete link filtering and query test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (test cases TC11-TC14)\n- docs/specs/product-requirements/prd007-links-interface.yaml (R4: Filter keys, R3.6: Fetch)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (flow F11-F14)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (existing test structure)\n- internal/sqlite/links_table.go (Fetch implementation)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (add test cases for S6, S7, S8)\n\n## Requirements\nImplement integration test cases validating:\n1. Fetch by link_type filter (success criterion S6)\n   - Create links of multiple types (belongs_to, child_of, branches_from)\n   - Fetch with filter: {\"link_type\": \"belongs_to\"}\n   - Verify only belongs_to links returned\n2. Fetch by from_id filter (success criterion S7)\n   - Create multiple links originating from same entity\n   - Fetch with filter: {\"from_id\": \u003centity_id\u003e}\n   - Verify all links from that entity returned\n3. Fetch by to_id filter (success criterion S8)\n   - Create multiple links targeting same entity\n   - Fetch with filter: {\"to_id\": \u003centity_id\u003e}\n   - Verify all links to that entity returned\n4. Fetch with combined filters\n   - Create links with various combinations\n   - Fetch with filter: {\"link_type\": \"child_of\", \"from_id\": \u003ccrumb_id\u003e}\n   - Verify only links matching all criteria returned (AND semantics)\n\nTest cases must validate prd007-links-interface R4 (filter keys and AND semantics).\n\n## Design Decisions\n- Use table-driven tests to cover multiple filter combinations\n- Create a diverse set of links (different types, from/to IDs) as test fixtures\n- Validate filter results by checking length and verifying each returned link matches criteria\n- Test empty filter (returns all links) and unknown filter keys (ignored per R4.4)\n\n## Acceptance Criteria\n- [ ] TestLinkManagement_FetchByLinkTypeReturnsOnlyMatchingLinks passes\n- [ ] TestLinkManagement_FetchByFromIDReturnsLinksFromEntity passes\n- [ ] TestLinkManagement_FetchByToIDReturnsLinksToEntity passes\n- [ ] TestLinkManagement_FetchWithCombinedFiltersUsesAND passes\n- [ ] Tests validate prd007-links-interface R4.2 (AND semantics for multiple keys)\n- [ ] All tests pass: go test -v ./tests/integration -run TestLinkManagement","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.133364-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:57:04.258444-05:00","closed_at":"2026-02-13T01:57:04.258444-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-5n8","depends_on_id":"generation-2026-02-12-07-13-55-dtl","type":"blocks","created_at":"2026-02-13T01:50:43.689628-05:00","created_by":"petardjukic"}],"comments":[{"id":39,"issue_id":"generation-2026-02-12-07-13-55-5n8","author":"petardjukic","text":"duration: 2m47s | tokens: in=31 out=9386 | loc: +242 -1 files=2","created_at":"2026-02-13T06:57:04Z"}]}
{"id":"generation-2026-02-12-07-13-55-5w8","title":"Unit tests for pkg/types: Config, Crumb, Trail entity methods","description":"## Required Reading\n- pkg/types/config.go (Config struct, Validate)\n- pkg/types/crumb.go (Crumb struct, state methods, property methods)\n- pkg/types/trail.go (Trail struct, Complete, Abandon)\n- docs/specs/test-suites/test-rel01.0-uc001-cupboard-lifecycle.yaml (config validation test cases)\n- docs/specs/test-suites/test-rel01.0-uc003-crumb-lifecycle.yaml (state transition test cases)\n\n## Files to Create/Modify\n- pkg/types/config_test.go (create) - Table-driven tests for Config.Validate: valid config, empty backend, unknown backend, empty DataDir for sqlite\n- pkg/types/crumb_test.go (create) - Table-driven tests for SetState (valid states, invalid state, idempotent), Pebble (from taken OK, from other states fails), Dust (from any state OK, idempotent), property methods (SetProperty, GetProperty, ClearProperty)\n- pkg/types/trail_test.go (create) - Table-driven tests for Complete (from active OK, from other states fails), Abandon (from active OK, from other states fails)\n\n## Requirements\n- Use testify/assert for assertions\n- Table-driven tests: each YAML test case maps to one row\n- Test edge cases: zero values, nil Properties map, empty strings\n- Test all error conditions return correct sentinel errors\n\n## Design Decisions\n- Tests in pkg/types package (white-box testing of entity methods)\n- Use testify for readable assertions\n\n## Acceptance Criteria\n- [ ] Config validation tests cover all error paths\n- [ ] Crumb state transition tests cover all valid/invalid transitions\n- [ ] Crumb property method tests cover set/get/clear/not-found\n- [ ] Trail lifecycle tests cover Complete and Abandon\n- [ ] All tests pass: go test ./pkg/types/...\n- [ ] No test uses hardcoded UUIDs (generate or use constants)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.54853-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:50:06.634981-05:00","closed_at":"2026-02-12T07:50:06.634981-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-5w8","depends_on_id":"generation-2026-02-12-07-13-55-eow","type":"blocks","created_at":"2026-02-12T07:18:37.516488-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-68l","title":"Define SQLite backend configuration and constructor in internal/sqlite","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R1 directory layout, R4 startup, R16 sync strategy)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R1 Config, R4 Attach)\n- pkg/types/config.go (Config struct)\n- pkg/types/cupboard.go (Cupboard interface)\n\n## Files to Create/Modify\n- internal/sqlite/backend.go (create) - SQLiteBackend struct implementing Cupboard interface; SQLiteConfig struct with SyncStrategy, BatchSize, BatchInterval; NewBackend() constructor; GetTable, Attach, Detach method stubs; attached/detached state tracking\n- internal/sqlite/schema.go (create) - SQL schema DDL strings (all 9 CREATE TABLE statements, all 12 CREATE INDEX statements from prd002 R3)\n\n## Requirements\n- SQLiteBackend struct with: db connection, attached flag, mutex for state, map of table accessors, config\n- NewBackend() returns *SQLiteBackend (not attached)\n- Attach(config): validate config, create DataDir if needed, create empty JSONL files if needed, delete existing cupboard.db, create new cupboard.db with schema, mark as attached; return ErrAlreadyAttached if already attached\n- Detach(): mark as detached, close db; idempotent\n- GetTable(name): return table accessor from map or ErrTableNotFound; return ErrCupboardDetached if detached\n- Schema DDL as const strings per prd002 R3.2 and R3.3\n\n## Design Decisions\n- Use modernc.org/sqlite (pure Go, no CGO) per architecture doc\n- Single backend.go for the struct and lifecycle; schema.go for DDL constants\n- Table accessors created during Attach and cached\n\n## Acceptance Criteria\n- [ ] SQLiteBackend implements Cupboard interface (compile check)\n- [ ] NewBackend returns unattached backend\n- [ ] Attach creates DataDir and JSONL files\n- [ ] Attach creates cupboard.db with correct schema\n- [ ] Detach closes connection and marks detached\n- [ ] GetTable returns ErrTableNotFound for unknown names\n- [ ] GetTable returns ErrCupboardDetached after Detach\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.991338-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:30:16.365319-05:00","closed_at":"2026-02-12T07:30:16.365319-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-68l","depends_on_id":"generation-2026-02-12-07-13-55-eow","type":"blocks","created_at":"2026-02-12T07:18:37.109887-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-6dx","title":"Implement metadata, stashes table accessors and JSONL loading","description":"## Required Reading\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (Metadata entity, schemas)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (Stash entity, history, operations)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R4 startup sequence, R9 built-in properties seeding)\n- internal/sqlite/backend.go (Attach method)\n\n## Files to Create/Modify\n- internal/sqlite/metadata_table.go (create) - metadataTable implementing Table; Fetch supports filter by table_name, crumb_id, property_id, content_contains, limit, offset\n- internal/sqlite/stashes_table.go (create) - stashesTable implementing Table; Set handles version increment and history append to stash_history; stash_history JSONL persistence\n- internal/sqlite/loader.go (create) - JSONL loading functions for startup: loadAllJSONL reads each JSONL file and inserts into SQLite tables; seedBuiltInProperties creates priority/type/description/owner/labels properties and categories if properties.jsonl is empty per prd002 R9\n- internal/sqlite/backend.go (modify) - Wire Attach to call loader, create all 6 table accessors, store in map\n\n## Requirements\n- metadataTable: hydrate/dehydrate Metadata per prd002 R14.5; Fetch with schema name, crumb_id, content_contains filters\n- stashesTable: hydrate/dehydrate Stash per prd002 R14.7; Set increments Version, records StashHistoryEntry, persists to stashes.jsonl and stash_history.jsonl\n- Loader: read each JSONL file line by line, parse JSON, insert into SQLite; skip malformed lines with warning; seed built-in properties per prd002 R9\n- Wire all 6 table accessors into backend.Attach\n\n## Design Decisions\n- Stash history append-only: never rewrite stash_history.jsonl, only append\n- Built-in properties seeded only if properties.jsonl is empty (first run)\n- Loader is transactional per prd002 R4.4\n\n## Acceptance Criteria\n- [ ] metadataTable implements Table with filtering\n- [ ] stashesTable implements Table with version/history tracking\n- [ ] Loader reads JSONL files into SQLite on Attach\n- [ ] Built-in properties seeded on first startup\n- [ ] Attach creates all 6 table accessors\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.409817-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:47:31.443682-05:00","closed_at":"2026-02-12T07:47:31.443682-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-6dx","depends_on_id":"generation-2026-02-12-07-13-55-ny9","type":"blocks","created_at":"2026-02-12T07:18:37.415895-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-6ep","title":"Add integration tests for configuration loading precedence","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc003-configuration-loading.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (S1-S9 success criteria)\n- internal/paths/paths.go (path resolution functions)\n- cmd/cupboard/config.go (config loading)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc003_configuration_loading_test.go (create)\n\n## Requirements\n- Test platform default paths return expected values (S1)\n- Test CRUMBS_CONFIG_DIR env overrides config directory (S2)\n- Test CRUMBS_DATA_DIR env overrides data directory (S3)\n- Test --config-dir flag overrides env and default (S4)\n- Test --data-dir flag overrides config.yaml and default (S5)\n- Test missing config.yaml uses defaults without error (S6)\n- Test config.yaml data_dir is respected when no flag (S7)\n- Test config directory created on first run (S8)\n- Test commands work with each override method (S9)\n- Use os/exec to run cupboard binary with various flag/env combinations\n- Use temp directories for isolation\n\n## Design Decisions\n- Set env vars with t.Setenv for automatic cleanup\n- Each test case creates its own temp directory\n- Write config.yaml to temp dir for config file tests\n\n## Acceptance Criteria\n- [ ] All 9 success criteria (S1-S9) have test coverage\n- [ ] Tests use table-driven pattern where applicable\n- [ ] Tests pass on macOS (current platform)\n- [ ] Each test is independent and uses isolated temp dirs","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.813863-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:28:59.606714-05:00","closed_at":"2026-02-12T12:28:59.606714-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-6ep","depends_on_id":"generation-2026-02-12-07-13-55-6y0","type":"blocks","created_at":"2026-02-12T08:33:20.64595-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-6rc","title":"Extract shared CLI helpers: parseEntityJSON to helpers.go","description":"## Required Reading\n- cmd/cupboard/helpers.go (existing attachBackend, validTableNames, error checkers)\n- cmd/cupboard/set.go (parseEntityJSON currently lives here)\n- cmd/cupboard/get.go, list.go, delete.go (verify no other duplicated patterns)\n- pkg/types/cupboard.go (standard table name constants)\n- pkg/types/*.go (all entity structs)\n\n## Files to Create/Modify\n- cmd/cupboard/helpers.go (modify) — move parseEntityJSON here\n- cmd/cupboard/set.go (modify) — remove parseEntityJSON, use from helpers\n\n## Requirements\n- Move `parseEntityJSON(tableName string, data []byte) (any, error)` from set.go to helpers.go\n- Verify no other duplicated logic exists across the four command files (get, set, list, delete)\n- Follow go-style rule: no duplicated code, extract when pattern appears twice\n\n## Design Decisions\n- helpers.go already contains attachBackend, validTableNames, and error checkers\n- parseEntityJSON is only used by set.go today but belongs in shared helpers for future reuse\n\n## Acceptance Criteria\n- [ ] parseEntityJSON lives in helpers.go\n- [ ] set.go imports it from helpers (same package, no import needed)\n- [ ] All four commands (get, set, list, delete) use shared helpers where applicable\n- [ ] `go build ./cmd/cupboard` succeeds\n- [ ] All existing tests still pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.69291-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:35:18.404296-05:00","closed_at":"2026-02-12T12:35:18.404296-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-6rc","depends_on_id":"generation-2026-02-12-07-13-55-dc3","type":"blocks","created_at":"2026-02-12T12:08:18.839964-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-6y0","title":"Implement config.yaml loading with Viper","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R7 config.yaml, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (F4 load config.yaml, F6 create on first run, S6-S8)\n- cmd/cupboard/root.go (existing flag handling)\n- internal/paths/paths.go (after task 6 — ResolveConfigDir)\n\n## Files to Create/Modify\n- cmd/cupboard/config.go (create) — Viper-based config loading\n- cmd/cupboard/root.go (modify) — integrate config loading into PersistentPreRunE\n\n## Requirements\n- Load config.yaml from resolved config directory using Viper\n- Config file fields: backend (string, default \"sqlite\"), data_dir (string, optional)\n- Create config directory on first run if it does not exist\n- Create default config.yaml on first run if config dir exists but file does not\n- Missing config.yaml is not an error (use defaults)\n- Integrate into root command's PersistentPreRunE so all subcommands benefit\n- Pass resolved data_dir from config.yaml to resolveDataDir pipeline\n\n## Design Decisions\n- Use spf13/viper for config file parsing (per go-style standard ecosystem)\n- Config loading happens once in PersistentPreRunE, not per-command\n- Keep it minimal: only load data_dir and backend from config.yaml\n\n## Acceptance Criteria\n- [ ] config.yaml is loaded from resolved config directory\n- [ ] data_dir from config.yaml is respected when no --data-dir flag provided\n- [ ] Missing config.yaml uses defaults without error\n- [ ] Config directory created on first run if absent\n- [ ] Default config.yaml created on first run if absent\n- [ ] PersistentPreRunE integrates config loading for all commands","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.675509-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:23:52.543312-05:00","closed_at":"2026-02-12T12:23:52.543312-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-6y0","depends_on_id":"generation-2026-02-12-07-13-55-rpi","type":"blocks","created_at":"2026-02-12T08:33:20.548002-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-748","title":"Add integration tests for metadata table CRUD (rel02.1-uc004)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc004-metadata-lifecycle.yaml (F1-F14 flows, S1-S12)\n- docs/specs/test-suites/test-rel02.1-uc004-metadata-lifecycle.yaml (all test cases)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (R1-R10)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (integration test pattern)\n- internal/sqlite/metadata_table.go (metadata table implementation)\n- pkg/types/metadata.go (Metadata struct)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_1_uc004_metadata_lifecycle_test.go (create)\n\n## Requirements\n- Test metadata creation via Table.Set with empty ID (S1)\n- Test multiple metadata entries accumulate for same crumb (S2)\n- Test comments schema stores plain text (S3)\n- Test attachments schema stores JSON (S4)\n- Test metadata retrieval via Table.Get (S5)\n- Test filter by schema (S6)\n- Test filter by crumb_id (S7)\n- Test combining filters (S8)\n- Test ErrNotFound for nonexistent ID (S9)\n- Test ErrInvalidID for empty ID (S10)\n- Test cascade delete when parent crumb deleted (S11-S12)\n- Use table-driven tests mapping to YAML test cases\n- Test via Go API (Cupboard.GetTable, Table.Set/Get/Fetch), not CLI\n\n## Design Decisions\n- Integration tests use real SQLite backend with temp directories\n- Each test case starts from preconditions (fresh cupboard)\n- Verify metadata content and fields match what was created\n- Test both built-in schemas (comments, attachments)\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S12 from the use case\n- [ ] Tests use table-driven pattern\n- [ ] All tests pass with go test ./tests/integration/... -run TestMetadataLifecycle\n- [ ] Tests verify UUID v7 generation for metadata\n- [ ] Tests verify multiple entries for same crumb\n- [ ] Tests verify cascade delete removes all metadata\n- [ ] Tests are independent (each uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:45.912046-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:31:10.035145-05:00","closed_at":"2026-02-12T22:31:10.035145-05:00","close_reason":"Closed","comments":[{"id":8,"issue_id":"generation-2026-02-12-07-13-55-748","author":"petardjukic","text":"duration: 3m4s | tokens: in=31 out=11616 | loc: +683 -1 files=2","created_at":"2026-02-13T03:31:09Z"}]}
{"id":"generation-2026-02-12-07-13-55-755","title":"Wire CLI with cobra: init and version commands using Cupboard","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (init, version commands)\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (config/data directory defaults)\n- docs/specs/use-cases/rel01.0-uc004-scaffolding-validation.yaml (CLI version, tables accessible)\n- cmd/cupboard/main.go (existing entry point)\n- pkg/crumbs/version.go (version constant)\n\n## Files to Create/Modify\n- cmd/cupboard/main.go (modify) - Replace print-only main with cobra root command\n- cmd/cupboard/root.go (create) - Root cobra command with --config-dir, --data-dir, --json global flags\n- cmd/cupboard/init.go (create) - Init command: creates data directory, initializes backend (Attach + Detach), seeds built-in properties\n- cmd/cupboard/version.go (create) - Version command: prints version string\n\n## Requirements\n- Root command \"cupboard\" with persistent flags: --config-dir, --data-dir, --json, --help, --version\n- \"cupboard init\" creates .crumbs-db directory (or custom data-dir), calls Attach to initialize backend and JSONL files, then Detach\n- \"cupboard version\" prints version string from pkg/crumbs/version.go\n- Exit codes: 0 success, 1 user error, 2 system error per prd009\n- Config/data directory defaults per prd010: $(CWD)/.crumbs for config, $(CWD)/.crumbs-db for data\n\n## Design Decisions\n- Use cobra for CLI framework per go-style rule\n- Minimal CLI: only init and version for release 01.0\n- Wire real SQLiteBackend in init command\n\n## Acceptance Criteria\n- [ ] cupboard version prints version and exits 0\n- [ ] cupboard init creates data directory with JSONL files\n- [ ] cupboard init seeds built-in properties\n- [ ] cupboard --help shows available commands\n- [ ] go build ./cmd/cupboard succeeds\n- [ ] go install ./cmd/cupboard succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.814753-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:01:19.208259-05:00","closed_at":"2026-02-12T08:01:19.208259-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-755","depends_on_id":"generation-2026-02-12-07-13-55-6dx","type":"blocks","created_at":"2026-02-12T07:18:37.712143-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-7bk","title":"Add FetchStashHistory method to stashes table","description":"## Required Reading\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R7.6: backend must provide method to query history by stash ID)\n- internal/sqlite/stashes_table.go (existing implementation)\n- pkg/types/stash.go (StashHistoryEntry struct)\n\n## Files to Create/Modify\n- internal/sqlite/stashes_table.go (modify: add FetchStashHistory method)\n\n## Requirements\n- Add FetchStashHistory(stashID string) method to stashesTable struct\n- Method must:\n  - Return ([]types.StashHistoryEntry, error)\n  - Return ErrInvalidID if stashID is empty\n  - Return ErrCupboardDetached if backend not attached\n  - Query stash_history table WHERE stash_id = ? ORDER BY version ASC\n  - Hydrate rows into []types.StashHistoryEntry\n  - Return empty slice (not nil) if no history entries exist\n- Method signature matches prd008-stash-interface R7.6 example\n\n## Design Decisions\n- Implement as a method on stashesTable (not exported through Table interface)\n- Tests will type-assert to *sqlite.Table to call this method\n- Order by version ASC per R7.6 to show mutation sequence\n- Use same hydration pattern as other table Get/Fetch methods\n\n## Acceptance Criteria\n- [ ] FetchStashHistory method exists in internal/sqlite/stashes_table.go\n- [ ] Method signature: func (st *stashesTable) FetchStashHistory(stashID string) ([]types.StashHistoryEntry, error)\n- [ ] Returns ErrInvalidID for empty stashID\n- [ ] Returns ErrCupboardDetached if backend detached\n- [ ] Returns entries ordered by version ASC\n- [ ] Returns empty slice if no entries found\n- [ ] Builds without errors\n- [ ] Code follows go-style: no duplication, clear variable names, proper error wrapping","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:33:39.943946-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:47:06.278001-05:00","closed_at":"2026-02-13T01:47:06.278001-05:00","close_reason":"Closed","comments":[{"id":36,"issue_id":"generation-2026-02-12-07-13-55-7bk","author":"petardjukic","text":"duration: 54s | tokens: in=24 out=2429 | loc: +47 -1 files=2","created_at":"2026-02-13T06:47:06Z"}]}
{"id":"generation-2026-02-12-07-13-55-7gs","title":"Implement JSONL forward-compatibility for regeneration (rel02.0-uc002)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S4 forward compatibility)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases 1-4)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R2 JSONL format)\n- internal/sqlite/loader.go (JSONL parsing)\n- pkg/types/ (entity struct definitions)\n\n## Files to Create/Modify\n- internal/sqlite/loader.go (modify) — verify unknown JSON fields are tolerated\n- internal/sqlite/loader_test.go (modify or create) — forward compatibility tests\n\n## Requirements\n- JSONL loader must tolerate unknown fields in entity JSON (Go default json.Unmarshal behavior)\n- Verify that entity structs can be loaded from JSONL with extra fields\n- Verify that adding new fields to entity structs does not break loading old JSONL\n- Unit tests with JSONL containing future fields that don't exist in current structs\n\n## Design Decisions\n- Go's json.Unmarshal silently ignores unknown fields by default (verify this is the case)\n- Write explicit tests confirming this behavior to prevent regressions\n- Test both direct unmarshaling and through the loader pipeline\n\n## Acceptance Criteria\n- [ ] JSONL loader does not error on unknown fields\n- [ ] Unit tests verify loading JSONL with future fields\n- [ ] Existing JSONL round-trip tests continue to pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.649173-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:29:54.37002-05:00","closed_at":"2026-02-12T18:29:54.37002-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-7ow","title":"Implement metadata table in SQLite backend (rel02.1-uc004)","description":"## Required Reading\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (R1-R10)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R2.8 metadata table schema)\n- docs/specs/use-cases/rel02.1-uc004-metadata-lifecycle.yaml (touchpoints T1-T9)\n- internal/sqlite/properties_table.go (table accessor pattern reference)\n- internal/sqlite/schema.go (DDL patterns)\n- pkg/types/metadata.go (Metadata struct)\n\n## Files to Create/Modify\n- internal/sqlite/metadata_table.go (create) — metadata table accessor implementing Table interface\n- internal/sqlite/backend.go (modify) — register metadata table in buildTables\n- pkg/types/cupboard.go (modify) — add TableMetadata constant\n\n## Requirements\n- Add `TableMetadata = \"metadata\"` constant to pkg/types/cupboard.go\n- Create metadataTable implementing types.Table for metadata\n  - Get: retrieve metadata by ID, hydrate to *types.Metadata\n  - Set: create (empty ID) or update metadata; generate UUID v7; validate CrumbID exists; validate TableName is registered schema\n  - Delete: metadata is append-only per prd005 R8, return ErrOperationNotSupported\n  - Fetch: query metadata with optional filters (schema, crumb_id); combine filters with AND\n  - Persist to metadata.jsonl after mutations\n- Implement cascade delete trigger: when crumb deleted, delete all its metadata\n- Register metadataTable in buildTables map in backend.go\n- Seed built-in schemas (comments, attachments) per prd005 R3\n\n## Design Decisions\n- Follow the same table accessor pattern as propertiesTable and crumbsTable\n- Set validates CrumbID exists by querying crumbs table\n- Set validates TableName against registered schemas table\n- Fetch supports schema and crumb_id filters, ANDed together\n- Delete returns ErrOperationNotSupported (append-only)\n- Cascade delete uses ON DELETE CASCADE in schema or manual trigger\n\n## Acceptance Criteria\n- [ ] TableMetadata constant exists in pkg/types/cupboard.go\n- [ ] metadataTable implements types.Table with Get, Set, Delete, Fetch\n- [ ] Set generates UUID v7 for new metadata entries\n- [ ] Set validates CrumbID exists and returns ErrNotFound if crumb missing\n- [ ] Set validates TableName against schemas table\n- [ ] Fetch filters by schema and crumb_id with AND logic\n- [ ] Delete returns ErrOperationNotSupported\n- [ ] Cascade delete removes all metadata when parent crumb deleted\n- [ ] Built-in schemas (comments, attachments) seeded on attach\n- [ ] Existing tests continue to pass (go test ./...)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:46.057373-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:34:52.929854-05:00","closed_at":"2026-02-12T22:34:52.929854-05:00","close_reason":"Closed","comments":[{"id":9,"issue_id":"generation-2026-02-12-07-13-55-7ow","author":"petardjukic","text":"duration: 3m42s | tokens: in=98 out=7546 | loc: +2 -2 files=2","created_at":"2026-02-13T03:34:52Z"}]}
{"id":"generation-2026-02-12-07-13-55-7up","title":"Add integration tests for generic table CLI commands","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc004-generic-table-cli.yaml (test cases to implement)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (success criteria S1-S12)\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (existing test patterns)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (existing test patterns)\n- cmd/cupboard/get.go, set.go, list.go, delete.go (commands under test)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (create) — CLI integration tests\n\n## Requirements\n- Implement table-driven tests exercising the cupboard CLI binary via os/exec\n- Build cupboard binary in TestMain or test setup, use temp directory for data\n- Test cases per test suite YAML:\n  - Get: valid entity returns JSON (S1), missing entity exit 1 (S2), unknown table exit 1 with valid names (S3)\n  - Set: create with empty ID returns JSON with generated ID (S4), update with existing ID (S5), invalid JSON exit 1 (S6)\n  - List: all entities returns JSON array (S7), with State=draft filter (S8), invalid filter exit 1 (S9)\n  - Delete: removes entity prints confirmation (S10), missing entity exit 1 (S11)\n  - Cross-table: commands work for crumbs, trails, links (S12)\n- Each test case uses a fresh cupboard init in a temp directory\n\n## Design Decisions\n- Use os/exec.Command to run the built binary (true CLI integration test)\n- Build binary once in TestMain, store path in package-level var\n- Helper: runCupboard(t, args...) (stdout, stderr, exitCode) for clean test assertions\n\n## Acceptance Criteria\n- [ ] All 12 success criteria (S1-S12) have at least one test case\n- [ ] Tests use table-driven pattern\n- [ ] Tests build and run the cupboard binary via os/exec\n- [ ] Tests pass with `go test ./tests/integration/... -run TestGenericTableCLI`\n- [ ] Each test case is independent (uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.392357-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:17:14.794723-05:00","closed_at":"2026-02-12T12:17:14.794723-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-7up","depends_on_id":"generation-2026-02-12-07-13-55-qg7","type":"blocks","created_at":"2026-02-12T08:33:20.45016-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-8ku","title":"Complete stash creation and value operations test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (test cases TC2-TC7)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R1-R4: Stash struct, types, creation, value methods)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (flow F2-F7)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (existing test structure)\n- internal/sqlite/stashes_table.go (implementation to test)\n- pkg/types/stash.go (Stash entity methods)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (add test cases for S2, S3, S4)\n\n## Requirements\nImplement integration test cases validating:\n1. Create all five stash types (success criterion S2)\n   - Create resource stash with {\"uri\": string, \"kind\": string}\n   - Create artifact stash with {\"path\": string, \"producer\": string}\n   - Create context stash with arbitrary key-value pairs\n   - Create counter stash with {\"value\": 0}\n   - Create lock stash with nil value\n   - Verify each stash has correct type, Version=1, CreatedAt set\n2. SetValue and GetValue operations (success criteria S3, S4)\n   - Create context stash\n   - Call SetValue with new value\n   - Verify Version increments\n   - Call GetValue and verify value matches\n   - Verify SetValue on lock type returns ErrInvalidStashType\n\nTest cases must validate prd008-stash-interface R2 (stash types), R3 (creation), and R4 (value methods).\n\n## Design Decisions\n- Use table-driven tests for creating all five stash types\n- Validate Version starts at 1 and increments on SetValue (prd008-stash-interface R1.6)\n- Test SetValue error handling for lock type (prd008-stash-interface R4.2)\n- Verify CreatedAt, LastOperation fields populated correctly\n\n## Acceptance Criteria\n- [ ] TestStashOperations_CreateAllStashTypes passes (validates S2)\n- [ ] TestStashOperations_SetValueUpdatesValueAndVersion passes (validates S3)\n- [ ] TestStashOperations_GetValueReturnsCurrentValue passes (validates S4)\n- [ ] TestStashOperations_SetValueOnLockTypeReturnsError passes\n- [ ] Tests validate prd008-stash-interface R2.1 (all five types)\n- [ ] Tests validate prd008-stash-interface R4.2 (SetValue increments Version)\n- [ ] All tests pass: go test -v ./tests/integration -run TestStashOperations","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.391149-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:59:56.618788-05:00","closed_at":"2026-02-13T01:59:56.618788-05:00","close_reason":"Closed","comments":[{"id":41,"issue_id":"generation-2026-02-12-07-13-55-8ku","author":"petardjukic","text":"duration: 1m4s | tokens: in=30 out=2629 | loc: +1 -1 files=1","created_at":"2026-02-13T06:59:56Z"}]}
{"id":"generation-2026-02-12-07-13-55-8rm","title":"Implement issue-tracking CLI update command (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R5.5 update command)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F8 update, S5)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases for update)\n- cmd/cupboard/get.go (get command for reference)\n- cmd/cupboard/set.go (set command for reference)\n- cmd/cupboard/helpers.go (attachBackend helper)\n- pkg/types/crumb.go (Crumb struct, SetState method)\n\n## Files to Create/Modify\n- cmd/cupboard/update.go (create) — update command implementation\n- cmd/cupboard/root.go (modify) — register update command\n\n## Requirements\n- Implement `cupboard update \u003cid\u003e [--status \u003cstate\u003e] [--title \u003ctitle\u003e] [--json]`\n- Retrieve crumb via Table.Get, apply field changes, persist with Table.Set\n- --status flag sets crumb state using crumb.SetState method\n- --title flag updates crumb.Name field\n- --json flag outputs JSON representation of updated crumb\n- Exit 0 on success with confirmation message (\"Updated \u003cid\u003e\")\n- Exit 1 if crumb not found or invalid state value\n- Validate --status against valid states (draft, pending, ready, taken, pebble, dust)\n- Error messages follow prd009 R9 format (\"context: details\")\n\n## Design Decisions\n- Use attachBackend helper from existing commands\n- Get-modify-set pattern: retrieve entity, call entity methods, persist\n- Validation happens before calling entity methods\n- Human-readable output by default, JSON with --json flag\n\n## Acceptance Criteria\n- [ ] `cupboard update \u003cid\u003e --status in_progress` updates state and exits 0\n- [ ] `cupboard update \u003cid\u003e --title \"New name\"` updates name and exits 0\n- [ ] `cupboard update \u003cid\u003e --status in_progress --json` outputs JSON with updated state\n- [ ] `cupboard update \u003cnonexistent-id\u003e` exits 1 with \"not found\" error\n- [ ] `cupboard update \u003cid\u003e --status invalid` exits 1 with validation error listing valid states\n- [ ] Human-readable output prints \"Updated \u003cid\u003e\"\n- [ ] Command registered in root.go init()\n- [ ] Error messages written to stderr\n- [ ] Success output written to stdout","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T19:10:53.775284-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:23:03.382846-05:00","closed_at":"2026-02-12T22:23:03.382846-05:00","close_reason":"Closed","comments":[{"id":5,"issue_id":"generation-2026-02-12-07-13-55-8rm","author":"petardjukic","text":"duration: 1m41s | tokens: in=62 out=4371 | loc: +113 -1 files=3","created_at":"2026-02-13T03:23:03Z"}]}
{"id":"generation-2026-02-12-07-13-55-90v","title":"Add integration tests for property enforcement use case (S1-S9)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S1-S9 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 1-9)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (integration test patterns)\n- internal/sqlite/seed.go (built-in property seeding)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (create)\n\n## Requirements\n- Test built-in properties exist after attach (S1-S3)\n- Test auto-initialization on crumb creation (S4-S6)\n- Test backfill on property definition (S7-S9)\n- Use table-driven tests mapping to YAML test cases\n- Test via Go API (Cupboard.GetTable, Table.Set/Get/Fetch), not CLI\n\n## Design Decisions\n- Integration tests use the real SQLite backend with temp directories\n- Each test case starts from preconditions (fresh cupboard)\n- Verify property values by getting crumb and checking Properties map\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S9 from the use case\n- [ ] Tests use table-driven pattern\n- [ ] All tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] Tests are independent (each uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.806531-05:00","created_by":"petardjukic","updated_at":"2026-02-12T23:04:12.015156-05:00","closed_at":"2026-02-12T23:04:12.015156-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-90v","depends_on_id":"generation-2026-02-12-07-13-55-yzx","type":"blocks","created_at":"2026-02-12T14:57:07.879642-05:00","created_by":"petardjukic"}],"comments":[{"id":11,"issue_id":"generation-2026-02-12-07-13-55-90v","author":"petardjukic","text":"duration: 1m46s | tokens: in=34 out=3754 | loc: +1 -1 files=1","created_at":"2026-02-13T04:04:11Z"}]}
{"id":"generation-2026-02-12-07-13-55-92w","title":"Run mage stats and commit rel03.0 completion","description":"## Required Reading\n- .claude/rules/cupboard-workflow.md (commit message format with stats)\n- .claude/rules/beads-workflow.md (LOC and documentation tracking)\n- docs/road-map.yaml (release 03.0 now complete)\n\n## Files to Create/Modify\n- All modified files from tasks 0-11 (tests, docs)\n\n## Requirements\n1. Run mage stats to capture final LOC and documentation word counts\n2. Calculate delta from baseline (provided in summary: prod=5709, test=17819, docs=~68000 words)\n3. Create git commit with descriptive message and full stats block\n4. Verify all changes committed (git status clean)\n\n## Design Decisions\n- Use multi-line commit message with Stats block per memory/MEMORY.md format\n- Include both totals and deltas in stats\n- Commit message format:\n  ```\n  Complete release 03.0: link management and stash operations\n\n  - Add integration tests for link CRUD (belongs_to, child_of, branches_from, scoped_to)\n  - Add integration tests for stash operations (all five types, value/counter/lock ops, history)\n  - Add test helper createTestStash\n  - Update SPECIFICATIONS.md and road-map.yaml to mark rel03.0 complete\n\n  Stats:\n    go_production_loc: \u003ctotal\u003e (+\u003cdelta\u003e)\n    go_test_loc:       \u003ctotal\u003e (+\u003cdelta\u003e)\n    documentation_words: \u003ctotal\u003e (+\u003cdelta\u003e)\n  ```\n- Do NOT use condensed delta format\n\n## Acceptance Criteria\n- [ ] mage stats run and output captured\n- [ ] Stats block calculated with totals and deltas\n- [ ] Git commit created with descriptive message and stats\n- [ ] All modified files staged and committed\n- [ ] git status shows clean working tree\n- [ ] Commit message follows memory/MEMORY.md format (full Stats block)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:43.459469-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:14:07.433845-05:00","closed_at":"2026-02-13T02:14:07.433845-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-92w","depends_on_id":"generation-2026-02-12-07-13-55-r5w","type":"blocks","created_at":"2026-02-13T01:50:44.454145-05:00","created_by":"petardjukic"}],"comments":[{"id":49,"issue_id":"generation-2026-02-12-07-13-55-92w","author":"petardjukic","text":"duration: 40s | tokens: in=16 out=1562 | loc: +1 -1 files=1","created_at":"2026-02-13T07:14:07Z"}]}
{"id":"generation-2026-02-12-07-13-55-9eh","title":"Implement generic table CLI get command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.1 get command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R2 Cupboard interface, R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S1-S3 success criteria for get)\n- cmd/cupboard/root.go (existing CLI structure, global flags, resolveDataDir helper)\n- cmd/cupboard/init.go (pattern for backend initialization)\n- internal/sqlite/backend.go (NewBackend, Attach, GetTable)\n\n## Files to Create/Modify\n- cmd/cupboard/get.go (create) — get command implementation\n- cmd/cupboard/root.go (modify) — register get command\n\n## Requirements\n- Implement `cupboard get \u003ctable\u003e \u003cid\u003e` per prd009-cupboard-cli R3.1\n- Accept table name and entity ID as positional arguments (cobra.ExactArgs(2))\n- Resolve data dir, create backend, attach, get table, call Table.Get(id)\n- Output JSON object with 2-space indentation per R7.3\n- Exit 1 with \"unknown table\" message listing valid names if table not found\n- Exit 1 with \"entity not found\" message if entity not found\n- Exit 2 for system errors (backend initialization failures)\n- Error messages to stderr per R7.4\n\n## Design Decisions\n- Extract a shared helper function `attachBackend()` that resolves data dir, creates backend, and attaches — reuse across get/set/list/delete commands. Place in cmd/cupboard/helpers.go or inline in a shared file.\n- Use json.MarshalIndent for output formatting\n- Entity returned as `any` from Table.Get — marshal directly to JSON\n\n## Acceptance Criteria\n- [ ] `cupboard get crumbs \u003cvalid-id\u003e` returns JSON with exit 0\n- [ ] `cupboard get crumbs \u003cnonexistent-id\u003e` returns exit 1 with not-found message\n- [ ] `cupboard get unknown-table \u003cid\u003e` returns exit 1 with valid table names\n- [ ] Error messages written to stderr\n- [ ] JSON output uses 2-space indentation\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:18.715736-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:36:36.326814-05:00","closed_at":"2026-02-12T08:36:36.326814-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-9yb","title":"Add init command --config-dir support and config directory creation","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R1.2, R1.6 config directory creation)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (F6 create on first run, S8)\n- cmd/cupboard/init.go (existing init command)\n- cmd/cupboard/root.go (global flags)\n- internal/paths/paths.go (after task 3 — path resolution)\n\n## Files to Create/Modify\n- cmd/cupboard/init.go (modify) — create config directory alongside data directory\n\n## Requirements\n- When `cupboard init` runs, also create the config directory (resolved via --config-dir \u003e env \u003e default)\n- Create default config.yaml in config directory if it does not exist\n- Print both config and data directory paths on successful init\n- Integrate with internal/paths.ResolveConfigDir\n\n## Design Decisions\n- init already creates the data directory; extend it to also create config directory\n- Use os.MkdirAll for idempotent directory creation\n- Default config.yaml contains only backend: sqlite\n\n## Acceptance Criteria\n- [ ] `cupboard init` creates config directory\n- [ ] `cupboard init` creates default config.yaml with backend: sqlite\n- [ ] `cupboard init --config-dir=/tmp/cfg` uses specified config directory\n- [ ] Existing data directory creation still works\n- [ ] `go build ./cmd/cupboard` succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.612596-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:11:48.742575-05:00","closed_at":"2026-02-12T15:11:48.742575-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-9yb","depends_on_id":"generation-2026-02-12-07-13-55-3st","type":"blocks","created_at":"2026-02-12T12:08:19.320851-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-a1t","title":"Implement crumbs table accessor with Get, Set, Delete, Fetch","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R12-R15 table routing, interface impl, hydration, persistence)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R3 creation, R6-R10 retrieval/update/delete/filter/query)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface, R8 UUID v7)\n- internal/sqlite/backend.go (SQLiteBackend, schema)\n- pkg/types/crumb.go (Crumb struct)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_table.go (create) - crumbsTable struct implementing Table interface; Get (query by ID, hydrate to *Crumb), Set (create with UUID v7 if empty ID, update if exists; validate Name non-empty; dehydrate to SQL), Delete (remove crumb + cascade property values/metadata/links), Fetch (build WHERE from filter map, hydrate results)\n- internal/sqlite/jsonl.go (create) - JSONL read/write helpers: readJSONL(path) ([]json.RawMessage, error), writeJSONL(path, records) with atomic write pattern (temp file, fsync, rename); loadCrumbsJSONL, persistCrumbsJSONL\n\n## Requirements\n- crumbsTable.Get: query crumbs table by crumb_id, hydrate row to *Crumb per prd002 R14.2, return ErrNotFound/ErrInvalidID\n- crumbsTable.Set: type-assert data to *Crumb, validate Name non-empty (ErrInvalidName), generate UUID v7 if CrumbID empty, set CreatedAt/UpdatedAt/State=draft on create, INSERT or UPDATE, persist to crumbs.jsonl atomically\n- crumbsTable.Delete: delete from crumbs table + cascade (crumb_properties, metadata, links where from_id or to_id), persist affected JSONL files, return ErrNotFound/ErrInvalidID\n- crumbsTable.Fetch: support filters (states, trail_id, parent_id, limit, offset), order by created_at DESC, return []any of *Crumb\n- JSONL helpers: atomic write (write temp, fsync, rename), read line-by-line skipping empty/malformed\n- UUID v7 generation using google/uuid package\n\n## Design Decisions\n- Each table accessor owns its JSONL persistence\n- Atomic write pattern per prd002 R5.2\n- Filter keys map to SQL WHERE clauses; trail_id and parent_id require JOIN on links table\n\n## Acceptance Criteria\n- [ ] crumbsTable implements Table interface\n- [ ] Get returns hydrated *Crumb or ErrNotFound\n- [ ] Set creates crumb with UUID v7 and correct defaults\n- [ ] Set updates existing crumb\n- [ ] Delete cascades to properties, metadata, links\n- [ ] Fetch with empty filter returns all crumbs\n- [ ] Fetch respects states, limit, offset filters\n- [ ] JSONL atomic write pattern works (temp, fsync, rename)\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.124514-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:33:42.169793-05:00","closed_at":"2026-02-12T07:33:42.169793-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-a1t","depends_on_id":"generation-2026-02-12-07-13-55-68l","type":"blocks","created_at":"2026-02-12T07:18:37.208079-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-a31","title":"Implement configuration loading with platform defaults and precedence chain","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R1-R2 directory structure, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (flow F1-F7, success criteria S1-S9)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R6 global flags)\n- cmd/cupboard/root.go (existing resolveDataDir, global flags)\n\n## Files to Create/Modify\n- internal/paths/paths.go (create) — platform-specific default paths and resolution functions\n- internal/paths/paths_test.go (create) — unit tests for path resolution\n- cmd/cupboard/root.go (modify) — replace resolveDataDir with paths.ResolveDataDir, add resolveConfigDir\n\n## Requirements\n- Implement DefaultConfigDir() and DefaultDataDir() per prd010 R1.2 and R2.2:\n  - Linux: XDG_CONFIG_HOME/crumbs and XDG_DATA_HOME/crumbs (fallback ~/.config/crumbs and ~/.local/share/crumbs)\n  - macOS: ~/Library/Application Support/crumbs (both config and data)\n  - Windows: %APPDATA%/crumbs (both config and data)\n- Implement ResolveConfigDir(flag, env string) string: flag \u003e CRUMBS_CONFIG_DIR env \u003e DefaultConfigDir()\n- Implement ResolveDataDir(flag, configYAMLValue, env string) string: flag \u003e config.yaml data_dir \u003e CRUMBS_DATA_DIR env \u003e DefaultDataDir()\n- For CWD-relative defaults: when --data-dir is empty and no config or env override, use $(CWD)/.crumbs-db (current behavior preserved)\n\n## Design Decisions\n- Use runtime.GOOS for platform detection\n- Use os.UserHomeDir() and os.UserConfigDir() for cross-platform home paths\n- Keep CWD-relative defaults as the primary mode (matching current behavior)\n\n## Acceptance Criteria\n- [ ] DefaultConfigDir returns correct path per platform\n- [ ] DefaultDataDir returns correct path per platform\n- [ ] ResolveConfigDir follows flag \u003e env \u003e default precedence\n- [ ] ResolveDataDir follows flag \u003e config \u003e env \u003e default precedence\n- [ ] Unit tests verify each precedence level\n- [ ] root.go resolveDataDir uses the new paths package","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.95817-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:38:03.114987-05:00","closed_at":"2026-02-12T12:38:03.114987-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-a4s","title":"Implement generic table CLI list command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.4 list command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface, Filter type)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S7-S9 success criteria for list)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n- internal/sqlite/crumbs_table.go (Fetch filter keys: states, trail_id, parent_id, limit, offset)\n\n## Files to Create/Modify\n- cmd/cupboard/list.go (create) — list command implementation\n- cmd/cupboard/root.go (modify) — register list command\n\n## Requirements\n- Implement `cupboard list \u003ctable\u003e [key=value...]` per prd009-cupboard-cli R3.4\n- Accept table name as first arg, remaining args as key=value filter pairs\n- Parse filters: split on '=' to get key and value; exit 1 for malformed filters\n- Special handling: if key is \"states\" or \"State\", wrap value in []string for the filter map\n- Call Table.Fetch(filter) and output JSON array with 2-space indentation\n- Empty results output `[]` (not null)\n- Exit 1 with \"unknown table\" for invalid table, exit 1 with \"invalid filter\" for bad syntax\n\n## Design Decisions\n- Filters passed as positional args after table name (not flags) for simplicity\n- The filter map is passed directly to Table.Fetch — each table implementation handles its own filter keys\n\n## Acceptance Criteria\n- [ ] `cupboard list crumbs` returns JSON array of all crumbs\n- [ ] `cupboard list crumbs State=draft` returns filtered results\n- [ ] `cupboard list crumbs` on empty table returns `[]`\n- [ ] `cupboard list crumbs bad-filter` returns exit 1 with expected format message\n- [ ] `cupboard list unknown-table` returns exit 1 with valid table names\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:18.992567-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:40:58.649132-05:00","closed_at":"2026-02-12T08:40:58.649132-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-a4s","depends_on_id":"generation-2026-02-12-07-13-55-9eh","type":"blocks","created_at":"2026-02-12T08:33:20.155811-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-a7y","title":"Add integration tests for flat self-hosting workflow","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc005-flat-self-hosting.yaml (test cases: init, create, list, get, update, delete, end-to-end workflows, persistence)\n- docs/specs/use-cases/rel01.1-uc005-flat-self-hosting.yaml (S1-S10 success criteria)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (after task 5 — CLI test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc005_flat_self_hosting_test.go (create)\n\n## Requirements\n- Test full issue-tracking workflow using only generic table commands:\n  - Initialize cupboard (S1)\n  - Create crumb with set (S2)\n  - List all crumbs (S3)\n  - List with State=draft filter (S4)\n  - Update state to taken (S5)\n  - Update state to pebble/close (S6)\n  - Get crumb details (S7)\n  - Do-work cycle: create → list draft → claim (taken) → close (pebble) (S8)\n  - Make-work cycle: list existing → create multiple new crumbs (S9)\n  - JSONL persistence survives database deletion (S10)\n- Use os/exec to run cupboard binary\n- Parse JSON output to extract CrumbIDs for subsequent operations\n\n## Design Decisions\n- Tests mirror the do-work.sh and make-work.sh workflow patterns\n- Each end-to-end test runs the full sequence in a single temp directory\n- JSON parsing with encoding/json for output verification\n\n## Acceptance Criteria\n- [ ] All 10 success criteria (S1-S10) have test coverage\n- [ ] Do-work cycle test runs full create → claim → close workflow\n- [ ] Make-work cycle test creates multiple crumbs and verifies count\n- [ ] JSONL persistence test deletes .db file and verifies data survives\n- [ ] Tests pass with `go test ./tests/integration/... -run TestFlatSelfHosting`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.957723-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:33:33.395426-05:00","closed_at":"2026-02-12T12:33:33.395426-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-a7y","depends_on_id":"generation-2026-02-12-07-13-55-7up","type":"blocks","created_at":"2026-02-12T08:33:20.748175-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-adl","title":"Update road-map.yaml use case statuses to reflect actual implementation state","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- All existing issue descriptions (from beads)\n- cmd/cupboard/ directory (verify which commands exist)\n- internal/paths/ directory (verify if paths package exists)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — correct use case statuses\n\n## Requirements\n- Review each use case marked 'done' in road-map.yaml and verify that:\n  - The code is actually implemented and passes tests\n  - Integration tests exist\n- If a use case is marked 'done' but code or tests are missing, change status to appropriate value\n- Specifically verify:\n  - rel01.1-uc003-configuration-loading: marked 'done' but internal/paths does not exist and config.go not implemented\n  - rel01.1-uc004-generic-table-cli: marked 'done' but delete command not implemented\n- Update statuses to reflect ground truth\n\n## Acceptance Criteria\n- [ ] road-map.yaml use case statuses match actual implementation state\n- [ ] No use case marked 'done' that lacks implementation or tests","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.742837-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:17:26.762506-05:00","closed_at":"2026-02-12T15:17:26.762506-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-aem","title":"Implement DefineCategory and GetCategories with backend persistence (prd004 R7-R8)","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R7 DefineCategory, R8 GetCategories, R2 Category struct)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S12-S15, F15-F18)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases for S12-S15)\n- pkg/types/property.go (DefineCategory and GetCategories stubs, Category struct)\n- pkg/types/cupboard.go (Cupboard interface, table names)\n- internal/sqlite/backend.go (buildTables, categories table in schema)\n- internal/sqlite/schema.go (categories DDL)\n- internal/sqlite/seed.go (category seeding pattern)\n- internal/sqlite/properties_table.go (property table accessor pattern)\n\n## Files to Create/Modify\n- pkg/types/property.go (modify) — complete DefineCategory to persist via Cupboard.GetTable(\"categories\").Set and GetCategories to query via Cupboard.GetTable(\"categories\").Fetch\n- pkg/types/cupboard.go (modify) — add TableCategories constant\n- internal/sqlite/categories_table.go (create) — categories table accessor implementing Table interface (Get, Set, Delete, Fetch) with duplicate name checking, ordinal ordering\n- internal/sqlite/categories_table_test.go (create) — unit tests for categories table\n- internal/sqlite/backend.go (modify) — register categories table in buildTables\n\n## Requirements\n- Add `TableCategories = \"categories\"` constant to pkg/types/cupboard.go\n- Create categories_table.go implementing types.Table for categories\n  - Get: retrieve category by ID, hydrate to *types.Category\n  - Set: create (empty ID) or update category; generate UUID v7; validate PropertyID exists; validate name unique within property (ErrDuplicateName); validate property is categorical (ErrInvalidValueType)\n  - Delete: remove category by ID with ErrNotFound if absent\n  - Fetch: query categories with optional filters (property_id); order by ordinal ASC, name ASC\n  - Persist to categories.jsonl after mutations\n- Complete Property.DefineCategory: call Cupboard.GetTable(\"categories\").Set to persist; return populated Category with CategoryID\n- Complete Property.GetCategories: call Cupboard.GetTable(\"categories\").Fetch with property_id filter; convert to []*Category slice; return ordered results\n- Register categoriesTable in buildTables map in backend.go\n\n## Design Decisions\n- Follow the same table accessor pattern as propertiesTable (internal/sqlite/properties_table.go)\n- DefineCategory validates type and name, creates Category struct, delegates persistence to categories table via Cupboard\n- GetCategories delegates to categories table Fetch with property_id filter\n- Ordering (ordinal ASC, name ASC) is enforced in the SQL query in Fetch\n- Duplicate name check uses SQL query scoped to property_id\n\n## Acceptance Criteria\n- [ ] TableCategories constant exists in pkg/types/cupboard.go\n- [ ] categoriesTable implements types.Table with Get, Set, Delete, Fetch\n- [ ] DefineCategory persists category and returns *Category with populated CategoryID\n- [ ] GetCategories returns categories ordered by ordinal ASC, name ASC\n- [ ] DefineCategory returns ErrDuplicateName for duplicate name within property\n- [ ] DefineCategory returns ErrInvalidValueType for non-categorical property\n- [ ] GetCategories returns ErrInvalidValueType for non-categorical property\n- [ ] GetCategories returns empty slice for property with no categories\n- [ ] Unit tests pass for all category operations\n- [ ] Existing tests continue to pass (go test ./...)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T18:59:49.534894-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:21:21.79275-05:00","closed_at":"2026-02-12T22:21:21.79275-05:00","close_reason":"Closed","comments":[{"id":4,"issue_id":"generation-2026-02-12-07-13-55-aem","author":"petardjukic","text":"duration: 5m31s | tokens: in=44 out=19211 | loc: +861 -4 files=6","created_at":"2026-02-13T03:21:21Z"}]}
{"id":"generation-2026-02-12-07-13-55-b17","title":"Add integration tests for configuration loading precedence","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc003-configuration-loading.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (S1-S9 success criteria)\n- internal/paths/paths.go (path resolution functions)\n- cmd/cupboard/config.go (config loading)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc003_configuration_loading_test.go (create)\n\n## Requirements\n- Test platform default paths return expected values (S1)\n- Test CRUMBS_CONFIG_DIR env overrides config directory (S2)\n- Test CRUMBS_DATA_DIR env overrides data directory (S3)\n- Test --config-dir flag overrides env and default (S4)\n- Test --data-dir flag overrides config.yaml and default (S5)\n- Test missing config.yaml uses defaults without error (S6)\n- Test config.yaml data_dir is respected when no flag (S7)\n- Test config directory created on first run (S8)\n- Test commands work with each override method (S9)\n- Use os/exec to run cupboard binary with various flag/env combinations\n- Use temp directories for isolation\n\n## Design Decisions\n- Set env vars with cmd.Env for subprocess isolation (not t.Setenv, which affects the test process)\n- Each test case creates its own temp directory\n- Write config.yaml to temp dir for config file tests\n\n## Acceptance Criteria\n- [ ] All 9 success criteria (S1-S9) have test coverage\n- [ ] Tests use table-driven pattern where applicable\n- [ ] Tests pass on macOS (current platform)\n- [ ] Each test is independent and uses isolated temp dirs","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.219391-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:03:28.49137-05:00","closed_at":"2026-02-12T15:03:28.49137-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-b17","depends_on_id":"generation-2026-02-12-07-13-55-3st","type":"blocks","created_at":"2026-02-12T12:08:19.129217-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-b31","title":"Add test helper for creating test stashes","description":"## Required Reading\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (existing test structure)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (existing test helpers pattern)\n- pkg/types/stash.go (Stash entity)\n\n## Files to Create/Modify\n- tests/integration/helpers_test.go (add createTestStash function)\n\n## Requirements\nAdd a test helper function createTestStash to reduce boilerplate in stash tests:\n1. Accept testing.T, stashes table, stash type, and optional name\n2. Create a stash with generated or provided name\n3. Call Table.Set to persist\n4. Return the created *types.Stash\n5. Use require.NoError for all assertions (fail fast on error)\n\nPattern should match existing helpers (createTestCrumb, createTestTrail).\n\n## Design Decisions\n- Follow existing helper pattern in helpers_test.go\n- Accept stash type as parameter (resource, artifact, context, counter, lock)\n- Generate unique name if not provided (using test name + counter)\n- Initialize stash with appropriate default value based on type\n- Use require.NoError to fail fast on creation errors\n\n## Acceptance Criteria\n- [ ] createTestStash function added to helpers_test.go\n- [ ] Function signature: createTestStash(t *testing.T, table types.Table, stashType string, name ...string) *types.Stash\n- [ ] Function creates stash with correct type and default value\n- [ ] Function persists stash via Table.Set\n- [ ] Function returns populated *types.Stash with StashID, Version, CreatedAt\n- [ ] Function can be used in link and stash tests\n- [ ] All tests pass: go test -v ./tests/integration","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.94433-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:09:23.792483-05:00","closed_at":"2026-02-13T02:09:23.792483-05:00","close_reason":"Closed","comments":[{"id":45,"issue_id":"generation-2026-02-12-07-13-55-b31","author":"petardjukic","text":"duration: 5m14s | tokens: in=51 out=14583 | loc: +89 -35 files=3","created_at":"2026-02-13T07:09:23Z"}]}
{"id":"generation-2026-02-12-07-13-55-b6c","title":"Implement cupboard comments add command (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R5.7 comments add command)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (R1-R4 metadata structure)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F10-F11 comments)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases for comments)\n- cmd/cupboard/create.go (command pattern reference)\n- pkg/types/metadata.go (Metadata struct)\n\n## Files to Create/Modify\n- cmd/cupboard/comments.go (create) — comments add subcommand implementation\n- cmd/cupboard/root.go (modify) — register comments command\n\n## Requirements\n- Implement `cupboard comments add \u003cid\u003e \u003ctext\u003e` command\n- Retrieve crumb via Table.Get to validate it exists\n- Create Metadata entry with TableName=\"comments\", CrumbID=id, Content=text\n- Persist via GetTable(\"metadata\").Set with empty ID to generate UUID v7\n- Output \"Added comment to \u003cid\u003e\" on success\n- Exit 1 if crumb not found or other error\n- Error messages follow prd009 R9 format (\"context: details\")\n- Error output to stderr, success to stdout\n\n## Design Decisions\n- Use attachBackend helper from existing commands\n- Validate crumb exists before creating metadata entry\n- Follow cobra command pattern from other commands\n- Comments schema uses TableName=\"comments\" per prd005 R3\n\n## Acceptance Criteria\n- [ ] `cupboard comments add \u003cid\u003e \"text\"` creates metadata entry and exits 0\n- [ ] `cupboard comments add \u003cnonexistent-id\u003e \"text\"` exits 1 with \"crumb not found\" error\n- [ ] Error messages written to stderr\n- [ ] Success output written to stdout\n- [ ] Command registered in root.go init()\n- [ ] Metadata entry has correct CrumbID, TableName, Content, and generated UUID v7","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:45.617889-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:25:58.378583-05:00","closed_at":"2026-02-12T22:25:58.378583-05:00","close_reason":"Closed","comments":[{"id":6,"issue_id":"generation-2026-02-12-07-13-55-b6c","author":"petardjukic","text":"duration: 2m54s | tokens: in=44 out=6128 | loc: +84 -1 files=4","created_at":"2026-02-13T03:25:58Z"}]}
{"id":"generation-2026-02-12-07-13-55-bo3","title":"Update road-map.yaml to mark rel02.1-uc002 as done","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- docs/specs/use-cases/rel02.1-uc002-table-benchmarks.yaml (use case to mark done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel02.1-uc002 status to done\n\n## Requirements\n- Change rel02.1-uc002-table-benchmarks status from \"not_started\" to \"done\"\n- Verify benchmark suite runs successfully\n- Verify baseline.txt committed to repository\n- Commit change with message referencing use case completion\n\n## Design Decisions\n- Only mark done after all benchmarks implemented and baseline captured\n- Atomic change (single use case status update)\n\n## Acceptance Criteria\n- [ ] rel02.1-uc002-table-benchmarks status is \"done\" in road-map.yaml\n- [ ] All benchmarks run without error\n- [ ] baseline.txt exists in repository with full benchmark results\n- [ ] Change committed with descriptive message","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.69286-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:55:33.066536-05:00","closed_at":"2026-02-13T00:55:33.066536-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-bo3","depends_on_id":"generation-2026-02-12-07-13-55-c08","type":"blocks","created_at":"2026-02-12T22:15:48.683687-05:00","created_by":"petardjukic"}],"comments":[{"id":22,"issue_id":"generation-2026-02-12-07-13-55-bo3","author":"petardjukic","text":"duration: 50s | tokens: in=37 out=1815 | loc: +2 -2 files=2","created_at":"2026-02-13T05:55:32Z"}]}
{"id":"generation-2026-02-12-07-13-55-bpu","title":"Implement property auto-initialization on crumb creation","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R4 auto-initialization)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R2 creation)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S4-S6 auto-initialization)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 4-6)\n- internal/sqlite/crumbs_table.go (Set method)\n- internal/sqlite/properties_table.go (property operations)\n- pkg/types/crumb.go (Crumb struct, Properties field)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_table.go (modify) — add auto-initialization in Set when creating new crumb\n- internal/sqlite/crumbs_table_test.go (modify or create) — tests for auto-init\n\n## Requirements\n- When Table.Set creates a new crumb (empty ID), auto-initialize all defined properties with their type defaults\n- Type defaults per prd004: categorical=first category or null, text=\"\", integer=0, boolean=false, timestamp=null, list=[]\n- Properties must be persisted to crumb_properties table\n- Crumb.Properties map must be populated after creation\n- If crumb already has a property value set explicitly, do not override with default\n\n## Design Decisions\n- Auto-init happens inside the Set transaction so it is atomic\n- Query properties table for all defined properties, compute defaults, insert into crumb_properties\n- Only on create (empty ID), not on update\n\n## Acceptance Criteria\n- [ ] New crumb has all defined properties initialized with type defaults\n- [ ] Explicitly set property values are not overridden\n- [ ] Properties appear in Crumb.Properties map after Get\n- [ ] Unit tests verify auto-init for each value type\n- [ ] Existing tests continue to pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.53792-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:59:00.998206-05:00","closed_at":"2026-02-12T22:59:00.998206-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-bpu","depends_on_id":"generation-2026-02-12-07-13-55-mdx","type":"blocks","created_at":"2026-02-12T14:57:07.680208-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-bul","title":"Implement integration tests for rel03.0-uc004-trail-crumb-lifecycle","description":"## Required Reading\n- docs/specs/use-cases/rel03.0-uc004-trail-crumb-lifecycle.yaml (use case definition)\n- docs/specs/test-suites/test-rel03.0-uc004-trail-crumb-lifecycle.yaml (test cases to implement)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail lifecycle semantics)\n- docs/specs/product-requirements/prd007-links-interface.yaml (belongs_to cardinality)\n- pkg/types/trail.go (Complete and Abandon methods)\n- internal/sqlite/trails_table.go (cascadeTrailCompleted, cascadeTrailAbandoned)\n- tests/integration/test_rel03_0_uc001_trail_exploration_test.go (related test pattern, dependency)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc004_trail_crumb_lifecycle_test.go (create)\n\n## Requirements\nImplement the 28 test cases from test-rel03.0-uc004-trail-crumb-lifecycle.yaml that validate:\n- Crumbs associate with trails via belongs_to links in the links table (TC01-TC03)\n- A crumb can belong to at most one trail at a time (cardinality enforced) (TC04-TC06)\n- Fetch with belongs_to filter returns all crumbs belonging to a trail (TC07-TC09)\n- Crumbs can be moved between trails by deleting and recreating belongs_to links (TC10-TC12)\n- trail.Complete() followed by Table.Set removes all belongs_to links for that trail (TC13-TC15)\n- After completion, crumbs persist and have no belongs_to links (they are permanent) (TC16-TC18)\n- trail.Abandon() followed by Table.Set deletes all crumbs that belong to the trail (TC19-TC21)\n- Cascade deletion removes crumb properties, metadata, and all links involving the crumb (TC22-TC24)\n- Trail remains in database after abandonment (for audit) but has no associated crumbs (TC25-TC26)\n- Complete and Abandon require trail to be in active state (ErrInvalidState otherwise) (TC27-TC28)\n\n## Design Decisions\n- Use table-driven test pattern: one TestTrailCrumbLifecycle function with subtests for each YAML test case\n- Test cardinality constraint by attempting to create duplicate belongs_to links and asserting unique constraint violation\n- Verify cascade deletion by querying crumb_properties, metadata, and links tables after trail abandonment\n- Use transactions for setup to ensure atomic test state initialization\n- Follow existing test patterns from test_rel03_0_uc001_trail_exploration_test.go\n\n## Acceptance Criteria\n- [ ] All 28 test cases from test-rel03.0-uc004-trail-crumb-lifecycle.yaml implemented\n- [ ] Table-driven test structure with one row per test case\n- [ ] Tests pass: go test -v ./tests/integration -run TestTrailCrumbLifecycle\n- [ ] Test file saved as test_rel03_0_uc004_trail_crumb_lifecycle_test.go\n- [ ] Assertions verify success criteria S1-S10 from use case\n- [ ] Cascade deletion verified across all affected tables (crumbs, crumb_properties, metadata, links)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.06306-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:22:40.446883-05:00","closed_at":"2026-02-13T01:22:40.446883-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-bul","depends_on_id":"generation-2026-02-12-07-13-55-z5j","type":"blocks","created_at":"2026-02-13T01:09:07.942595-05:00","created_by":"petardjukic"}],"comments":[{"id":27,"issue_id":"generation-2026-02-12-07-13-55-bul","author":"petardjukic","text":"duration: 7m35s | tokens: in=49 out=32520 | loc: +1877 -1 files=2","created_at":"2026-02-13T06:22:40Z"}]}
{"id":"generation-2026-02-12-07-13-55-bw9","title":"Create test suite for rel03.0-uc003-stash-operations","description":"## Required Reading\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (use case spec with flow and success criteria)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (Stash entity, types, methods, history)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (SQLite schema, stash_history table)\n- pkg/types/stash.go (Stash struct, methods: SetValue, GetValue, Increment, Acquire, Release)\n- internal/sqlite/stashes_table.go (existing implementation)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (example table-driven test structure)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (create)\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (create)\n\n## Requirements\n- Create YAML test suite spec per test-case-format rule with:\n  - id: test-rel03.0-uc003-stash-operations\n  - traces: [rel03.0-uc003-stash-operations]\n  - preconditions: Cupboard attached with SQLite backend, stashes table accessible\n  - test_cases covering all flow steps F1-F23 from the use case\n- Write Go integration test file with table-driven tests validating:\n  - Stash creation for all five types (resource, artifact, context, counter, lock) (S1-S2)\n  - SetValue updates value and increments Version, returns ErrInvalidStashType for lock (S3-S4)\n  - GetValue returns current value or nil (S4)\n  - Increment adds delta to counter, increments Version, returns ErrInvalidStashType for non-counter (S5-S6)\n  - Acquire sets holder and increments Version, returns ErrLockHeld if held by different holder (S7)\n  - Acquire by same holder succeeds (reentrant) (S8)\n  - Release clears lock and increments Version, returns ErrNotLockHolder if wrong holder (S9)\n  - Version starts at 1 and increments on every mutation (S10)\n  - Fetch with stash_type and name filters returns correct results (S11-S12)\n  - Delete removes stash and subsequent Get returns ErrNotFound (S13)\n  - History entries created for each mutation and queryable by stash ID (S14-S15)\n\n## Design Decisions\n- Use table-driven tests to avoid repeating setup/teardown logic\n- Each YAML test case maps to one row in the Go table\n- Test each stash type with concrete value examples from prd008-stash-interface R2.1\n- Test counter operations with both positive and negative deltas\n- Test lock contention and reentrant acquire\n- Validate history tracking by calling FetchStashHistory (backend method)\n\n## Acceptance Criteria\n- [ ] YAML test suite exists at docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml\n- [ ] Go test file exists at tests/integration/test_rel03_0_uc003_stash_operations_test.go\n- [ ] All success criteria S1-S15 from the use case have corresponding test cases\n- [ ] Tests pass: go test -v ./tests/integration -run TestStashOperations\n- [ ] Test file uses table-driven pattern per go-style rule\n- [ ] YAML traces field references rel03.0-uc003-stash-operations\n- [ ] History queries use FetchStashHistory method from internal/sqlite stashes table","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:33:39.814275-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:46:11.92997-05:00","closed_at":"2026-02-13T01:46:11.92997-05:00","close_reason":"Closed","comments":[{"id":35,"issue_id":"generation-2026-02-12-07-13-55-bw9","author":"petardjukic","text":"duration: 7m41s | tokens: in=44 out=34337 | loc: +1083 -1 files=3","created_at":"2026-02-13T06:46:11Z"}]}
{"id":"generation-2026-02-12-07-13-55-c08","title":"Add benchmark suite for properties table operations (rel02.1-uc002)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc002-table-benchmarks.yaml (property benchmark requirements)\n- docs/specs/test-suites/test-rel02.1-uc002-table-benchmarks.yaml (property test cases)\n- internal/sqlite/properties_table.go (implementation to benchmark)\n- internal/sqlite/crumbs_bench_test.go (benchmark pattern from crumbs suite)\n\n## Files to Create/Modify\n- internal/sqlite/properties_bench_test.go (create) — benchmark suite for properties table\n\n## Requirements\n- Implement property Get benchmarks at scale: BenchmarkPropertiesGet10, Get100, Get1000\n- Implement property Set benchmarks for create: BenchmarkPropertiesSetCreate10, SetCreate100\n- Implement property Fetch benchmarks: BenchmarkPropertiesFetchAll, FetchByValueType\n- Implement category Get benchmarks: BenchmarkCategoriesGet10, Get100\n- Implement category Fetch benchmarks: BenchmarkCategoriesFetchByProperty\n- Seed properties and categories before b.ResetTimer()\n- Measure JSONL sync overhead for properties.jsonl and categories.jsonl\n\n## Design Decisions\n- Follow same pattern as crumbs benchmarks\n- Properties have fewer expected than crumbs, so smaller scale (10, 100, 1000 vs 10000)\n- Categories benchmarks measure ordinal ordering performance\n- Use temp directories per benchmark suite\n\n## Acceptance Criteria\n- [ ] go test -bench=BenchmarkProperties -benchmem ./internal/sqlite/... runs without error\n- [ ] go test -bench=BenchmarkCategories -benchmem ./internal/sqlite/... runs without error\n- [ ] All benchmarks report ns/op, B/op, allocs/op\n- [ ] Benchmarks execute without error\n- [ ] Results appended to baseline.txt","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:46.353664-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:37:36.329322-05:00","closed_at":"2026-02-13T00:37:36.329322-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-c08","depends_on_id":"generation-2026-02-12-07-13-55-3cu","type":"blocks","created_at":"2026-02-12T22:15:48.245908-05:00","created_by":"petardjukic"}],"comments":[{"id":15,"issue_id":"generation-2026-02-12-07-13-55-c08","author":"petardjukic","text":"duration: 1h21m22s | tokens: in=38 out=7085 | loc: +285 -1 files=3","created_at":"2026-02-13T05:37:36Z"}]}
{"id":"generation-2026-02-12-07-13-55-c14","title":"Update .claude/rules with cupboard workflow (rel02.1-uc003)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (F8 agent workflow rule)\n- .claude/rules/beads-workflow.md (current workflow reference)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (CLI commands)\n\n## Files to Create/Modify\n- .claude/rules/cupboard-workflow.md (create) — cupboard workflow for agents\n- .claude/rules/beads-workflow.md (modify) — deprecate or reference cupboard\n\n## Requirements\n- Document cupboard commands for agent workflow:\n  - `cupboard ready` to find available work\n  - `cupboard show \u003cid\u003e` to view issue details\n  - `cupboard update \u003cid\u003e --status in_progress` to claim work\n  - `cupboard comments add \u003cid\u003e \"tokens: \u003ccount\u003e\"` to log token usage\n  - `cupboard close \u003cid\u003e` to close work\n- Document landing the plane workflow with cupboard\n- Document token tracking per issue\n- Document LOC and documentation tracking per issue\n- Document commit message format with stats block\n- Document offline workflow (no git push)\n- Include quick reference section\n\n## Design Decisions\n- New rule file instead of modifying beads-workflow to keep migration path clear\n- Examples use real cupboard CLI syntax\n- Workflow instructions match beads pattern for agent familiarity\n- Emphasize --json flag for machine-readable output\n\n## Acceptance Criteria\n- [ ] cupboard-workflow.md created with complete workflow instructions\n- [ ] Quick reference section lists all commands\n- [ ] Token tracking section explains comment format\n- [ ] Stats tracking section explains mage stats usage\n- [ ] Commit message format documented with examples\n- [ ] Offline workflow clarified (commit works, no push)\n- [ ] beads-workflow.md updated to reference cupboard as migration path","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.074544-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:45:32.099318-05:00","closed_at":"2026-02-13T00:45:32.099318-05:00","close_reason":"Closed","comments":[{"id":18,"issue_id":"generation-2026-02-12-07-13-55-c14","author":"petardjukic","text":"duration: 1m53s | tokens: in=32 out=4293 | loc: +224 -1 files=3","created_at":"2026-02-13T05:45:32Z"}]}
{"id":"generation-2026-02-12-07-13-55-c5f","title":"Mark rel01.1-uc001-go-install as done and add JSONL roundtrip test (rel01.1-uc002)","description":"## Required Reading\n- docs/specs/use-cases/rel01.1-uc002-jsonl-git-roundtrip.yaml (S1-S14 success criteria)\n- docs/specs/test-suites/test-rel01.1-uc002-jsonl-git-roundtrip.yaml (28 test cases)\n- tests/integration/test_rel01_1_uc001_go_install_test.go (already exists and passes)\n- internal/sqlite/backend.go (Attach/Detach, sync strategies)\n- internal/sqlite/jsonl.go (JSONL persistence)\n- internal/sqlite/loader.go (JSONL loading on startup)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R4 startup, R5 persistence, R14 sync)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc002_jsonl_git_roundtrip_test.go (create)\n- docs/road-map.yaml (modify) — mark rel01.1-uc001 as done (tests already pass), mark rel01.1-uc002 as done after tests pass\n\n## Requirements\n- S1-S5: JSONL files created, content correct, committable to git, cupboard.db gitignored\n- S6-S9: Database deletion and rebuild (delete cupboard.db, re-attach, verify data intact)\n- S10-S11: State changes persist to JSONL and survive rebuild cycles\n- S12: on_close sync strategy defers writes until Detach\n- S13: batch sync strategy flushes at threshold\n- S14: immediate sync strategy (default) persists every write\n- Test via Go API (Cupboard.Attach, GetTable, Table.Set/Get/Fetch/Delete) with temp dirs\n- Simulate git roundtrip by creating data, deleting DB, and re-attaching\n\n## Design Decisions\n- Use Go API directly (not git CLI) for roundtrip simulation\n- Create JSONL data, delete cupboard.db file, re-Attach to verify reload\n- Test sync strategies by configuring Backend with different SyncStrategy values\n- Table-driven tests grouped by success criteria\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S14 from the use case\n- [ ] Tests pass with go test ./tests/integration/... -run TestJSONLGitRoundtrip\n- [ ] road-map.yaml marks rel01.1-uc001 as done and rel01.1-uc002 as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.108552-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:10:48.471563-05:00","closed_at":"2026-02-12T18:10:48.471563-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-cc8","title":"Update road-map.yaml to mark rel02.1-uc001 as done","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (use case to mark done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel02.1-uc001 status to done\n\n## Requirements\n- Change rel02.1-uc001-issue-tracking-cli status from \"not_started\" to \"done\"\n- Verify all success criteria from use case are implemented\n- Commit change with message referencing use case completion\n\n## Design Decisions\n- Only mark done after all CLI commands implemented and tests pass\n- Atomic change (single use case status update)\n\n## Acceptance Criteria\n- [ ] rel02.1-uc001-issue-tracking-cli status is \"done\" in road-map.yaml\n- [ ] All seven issue-tracking CLI commands implemented\n- [ ] Integration tests pass for the use case\n- [ ] Change committed with descriptive message","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.361958-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:53:46.985928-05:00","closed_at":"2026-02-13T00:53:46.985928-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-cc8","depends_on_id":"generation-2026-02-12-07-13-55-di2","type":"blocks","created_at":"2026-02-12T22:15:48.447028-05:00","created_by":"petardjukic"}],"comments":[{"id":20,"issue_id":"generation-2026-02-12-07-13-55-cc8","author":"petardjukic","text":"duration: 1m35s | tokens: in=39 out=2322 | loc: +2 -2 files=2","created_at":"2026-02-13T05:53:46Z"}]}
{"id":"generation-2026-02-12-07-13-55-czg","title":"Add integration tests for regeneration compatibility (S1-S8)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S8 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases)\n- internal/sqlite/loader.go (JSONL loading with forward compat)\n- tests/integration/test_rel01_1_uc002_jsonl_git_roundtrip_test.go (roundtrip test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc002_regeneration_compatibility_test.go (create)\n\n## Requirements\n- Test that JSONL files with unknown fields load without error (S1-S2)\n- Test that crumb data survives a simulated regeneration cycle (S3-S4)\n- Test that adding a new property to existing JSONL data works (S5)\n- Test that removing a field from struct still loads old JSONL (S6)\n- Test concurrent JSONL access from two cupboard instances (S7, if applicable)\n- Test that JSONL files remain valid after write-back with new struct version (S8)\n\n## Design Decisions\n- Simulate regeneration by creating JSONL files with extra fields, then loading\n- Use real SQLite backend with temp directories\n- Test both loader.go directly and via Cupboard.Attach\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S8 from the use case\n- [ ] Tests pass with go test ./tests/integration/... -run TestRegenerationCompatibility\n- [ ] road-map.yaml updated to mark rel02.0-uc002-regeneration-compatibility as done (after all tests pass)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.208654-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:56:20.66421-05:00","closed_at":"2026-02-12T17:56:20.66421-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-czg","depends_on_id":"generation-2026-02-12-07-13-55-2j0","type":"blocks","created_at":"2026-02-12T14:57:08.182681-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-dc3","title":"Implement generic table CLI delete command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.3 delete command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S10-S11 success criteria for delete)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n- cmd/cupboard/helpers.go (attachBackend, error checkers)\n\n## Files to Create/Modify\n- cmd/cupboard/delete.go (create) — delete command implementation\n- cmd/cupboard/root.go (modify) — register delete command\n\n## Requirements\n- Implement `cupboard delete \u003ctable\u003e \u003cid\u003e` per prd009-cupboard-cli R3.3\n- Accept table name and entity ID as positional arguments (cobra.ExactArgs(2))\n- Call Table.Delete(id) and output \"Deleted \u003ctable\u003e/\u003cid\u003e\" on success\n- Exit 1 with \"entity not found\" for missing entity\n- Exit 1 with \"unknown table\" for invalid table name\n- Error messages to stderr\n\n## Design Decisions\n- Reuse attachBackend() helper from helpers.go\n- Reuse isTableNotFound() and isEntityNotFound() helpers\n- Follow the pattern established by get.go\n\n## Acceptance Criteria\n- [ ] `cupboard delete crumbs \u003cvalid-id\u003e` removes entity, prints confirmation, exit 0\n- [ ] `cupboard delete crumbs \u003cnonexistent-id\u003e` returns exit 1 with not-found message\n- [ ] `cupboard delete unknown-table \u003cid\u003e` returns exit 1 with valid table names\n- [ ] Command registered in root.go init()\n- [ ] `go build ./cmd/cupboard` succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.556295-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:34:27.588474-05:00","closed_at":"2026-02-12T12:34:27.588474-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-di2","title":"Add integration test for issue-tracking CLI end-to-end flow (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F1-F14 flows, S1-S10)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (all test cases)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (CLI test pattern)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_1_uc001_issue_tracking_cli_test.go (create)\n\n## Requirements\n- Build cupboard binary once for test suite\n- Test F1: Initialize cupboard with config.yaml and CUPBOARD_CONFIG env var\n- Test F2-F4: Create task, epic with various flags; verify JSON output\n- Test F5: List all crumbs via cupboard list --json\n- Test F6: Show specific crumb via cupboard show \u003cid\u003e\n- Test F7: Find available work via cupboard ready --json --type task\n- Test F8-F9: Update task status via cupboard update and verify with show\n- Test F10-F11: Add comment and verify it appears in show output\n- Test F12-F14: Close task and verify state change, exclusion from ready\n- Use os/exec to run cupboard binary\n- Parse JSON output to verify expected fields and values\n- Use temp directories for each test case\n\n## Design Decisions\n- Integration tests run real cupboard binary, not library calls\n- Each test case starts from fresh cupboard (temp data directory)\n- Tests verify both JSON output and human-readable output where applicable\n- Tests use table-driven pattern mapping to YAML test cases\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S10 from the use case\n- [ ] Tests build cupboard binary once per suite\n- [ ] Tests use temp directories and clean up\n- [ ] Tests verify JSON output structure and values\n- [ ] Tests verify state transitions (draft → ready → taken → pebble)\n- [ ] Tests verify filters (ready excludes closed, type filter works)\n- [ ] All tests pass with go test ./tests/integration/... -run TestIssueTrackingCLI\n- [ ] Tests are independent and can run in any order","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.221341-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:52:10.94139-05:00","closed_at":"2026-02-13T00:52:10.94139-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-di2","depends_on_id":"generation-2026-02-12-07-13-55-b6c","type":"blocks","created_at":"2026-02-12T22:15:48.347635-05:00","created_by":"petardjukic"}],"comments":[{"id":19,"issue_id":"generation-2026-02-12-07-13-55-di2","author":"petardjukic","text":"duration: 6m38s | tokens: in=50 out=23694 | loc: +718 -1 files=2","created_at":"2026-02-13T05:52:10Z"}]}
{"id":"generation-2026-02-12-07-13-55-dse","title":"Create test suite for rel03.0-uc002-link-management","description":"## Required Reading\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (use case spec with flow and success criteria)\n- docs/specs/product-requirements/prd007-links-interface.yaml (Link entity, CRUD, filter keys, uniqueness)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (SQLite schema, indexes)\n- pkg/types/link.go (Link struct and constants)\n- internal/sqlite/links_table.go (existing implementation)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (example table-driven test structure)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (create)\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (create)\n\n## Requirements\n- Create YAML test suite spec per test-case-format rule with:\n  - id: test-rel03.0-uc002-link-management\n  - traces: [rel03.0-uc002-link-management]\n  - preconditions: Cupboard attached with SQLite backend, crumbs/trails/stashes tables accessible\n  - test_cases covering all flow steps F1-F19 from the use case\n- Write Go integration test file with table-driven tests validating:\n  - Link creation via Table.Set generates UUID v7 (S1)\n  - belongs_to, child_of, branches_from, scoped_to link types work correctly (S2-S5)\n  - Fetch with link_type, from_id, to_id filters returns correct results (S6-S8)\n  - Delete removes link and subsequent Get returns ErrNotFound (S9-S10)\n  - Uniqueness constraint enforced for (link_type, from_id, to_id)\n  - All link CRUD operations work through Table interface\n\n## Design Decisions\n- Use table-driven tests to avoid repeating setup/teardown logic\n- Each YAML test case maps to one row in the Go table\n- Create prerequisite entities (crumbs, trails, stashes) in test setup\n- Test all four link types with concrete examples\n- Validate filter combinations (single key, multiple keys ANDed)\n\n## Acceptance Criteria\n- [ ] YAML test suite exists at docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml\n- [ ] Go test file exists at tests/integration/test_rel03_0_uc002_link_management_test.go\n- [ ] All success criteria S1-S10 from the use case have corresponding test cases\n- [ ] Tests pass: go test -v ./tests/integration -run TestLinkManagement\n- [ ] Test file uses table-driven pattern per go-style rule\n- [ ] YAML traces field references rel03.0-uc002-link-management","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:33:39.685323-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:38:30.417519-05:00","closed_at":"2026-02-13T01:38:30.417519-05:00","close_reason":"Closed","comments":[{"id":34,"issue_id":"generation-2026-02-12-07-13-55-dse","author":"petardjukic","text":"duration: 4m50s | tokens: in=73 out=17825 | loc: +714 -1 files=2","created_at":"2026-02-13T06:38:30Z"}]}
{"id":"generation-2026-02-12-07-13-55-dtl","title":"Complete link CRUD test coverage (branches_from, scoped_to)","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (test cases TC7-TC10)\n- docs/specs/product-requirements/prd007-links-interface.yaml (R2: Link types, R3: CRUD)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (flow F7-F10)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (existing test structure)\n- internal/sqlite/links_table.go (implementation to test)\n- pkg/types/stash.go (Stash entity for scoped_to tests)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (add test cases for S4, S5)\n\n## Requirements\nImplement integration test cases validating:\n1. branches_from link creation and verification (success criterion S4)\n   - Create trail and crumb\n   - Create branches_from link (from_id=trail_id, to_id=crumb_id)\n   - Verify link indicates trail branch point\n   - Verify link is retrievable via Table.Get\n2. scoped_to link creation and verification (success criterion S5)\n   - Create stash and trail\n   - Create scoped_to link (from_id=stash_id, to_id=trail_id)\n   - Verify link scopes stash to trail\n   - Verify link is retrievable via Table.Get\n\nTest cases must follow table-driven pattern and validate prd007-links-interface R2 (link types and semantics).\n\n## Design Decisions\n- Use existing test helpers plus createTestStash for scoped_to tests\n- Follow existing test naming: TestLinkManagement_\u003cScenario\u003e\n- Each test case creates its own prerequisite entities to ensure isolation\n- Validate both successful link creation and retrieval in each test\n\n## Acceptance Criteria\n- [ ] TestLinkManagement_BranchesFromLinkIndicatesTrailBranchPoint passes\n- [ ] TestLinkManagement_ScopedToLinkScopesStashToTrail passes\n- [ ] Both test cases verify all Link struct fields (LinkID, LinkType, FromID, ToID, CreatedAt)\n- [ ] Test cases follow table-driven pattern per go-style rule\n- [ ] Tests validate prd007-links-interface R2.1 semantics for branches_from and scoped_to\n- [ ] All tests pass: go test -v ./tests/integration -run TestLinkManagement","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.003165-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:54:16.499561-05:00","closed_at":"2026-02-13T01:54:16.499561-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-dtl","depends_on_id":"generation-2026-02-12-07-13-55-gi1","type":"blocks","created_at":"2026-02-13T01:50:43.576449-05:00","created_by":"petardjukic"}],"comments":[{"id":38,"issue_id":"generation-2026-02-12-07-13-55-dtl","author":"petardjukic","text":"duration: 1m58s | tokens: in=33 out=5984 | loc: +77 -1 files=2","created_at":"2026-02-13T06:54:16Z"}]}
{"id":"generation-2026-02-12-07-13-55-e20","title":"Update road-map.yaml to mark rel02.1-uc004 as done","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- docs/specs/use-cases/rel02.1-uc004-metadata-lifecycle.yaml (use case to mark done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel02.1-uc004 status to done\n\n## Requirements\n- Change rel02.1-uc004-metadata-lifecycle status from \"not_started\" to \"done\"\n- Verify all success criteria from use case are implemented\n- Commit change with message referencing use case completion\n\n## Design Decisions\n- Only mark done after metadata table implemented and tests pass\n- Atomic change (single use case status update)\n\n## Acceptance Criteria\n- [ ] rel02.1-uc004-metadata-lifecycle status is \"done\" in road-map.yaml\n- [ ] Metadata table fully implemented with cascade delete\n- [ ] Integration tests pass for metadata lifecycle\n- [ ] Change committed with descriptive message","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.518002-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:54:42.688926-05:00","closed_at":"2026-02-13T00:54:42.688926-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-e20","depends_on_id":"generation-2026-02-12-07-13-55-748","type":"blocks","created_at":"2026-02-12T22:15:48.549556-05:00","created_by":"petardjukic"}],"comments":[{"id":21,"issue_id":"generation-2026-02-12-07-13-55-e20","author":"petardjukic","text":"duration: 55s | tokens: in=37 out=1774 | loc: +2 -2 files=2","created_at":"2026-02-13T05:54:42Z"}]}
{"id":"generation-2026-02-12-07-13-55-eow","title":"Define Crumb property methods and remaining entity structs in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R5 property methods)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail struct)\n- docs/specs/product-requirements/prd004-properties-interface.yaml (Property and Category structs)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (Metadata struct)\n- docs/specs/product-requirements/prd007-links-interface.yaml (Link struct)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (Stash struct)\n- pkg/types/crumb.go (existing Crumb struct)\n\n## Files to Create/Modify\n- pkg/types/crumb.go (modify) - Add property methods: SetProperty, GetProperty, GetProperties, ClearProperty\n- pkg/types/trail.go (create) - Trail struct with ID, State, CreatedAt, CompletedAt; Complete() and Abandon() methods\n- pkg/types/property.go (create) - Property struct, Category struct, value type constants, built-in property names\n- pkg/types/metadata.go (create) - Metadata struct, Schema struct, built-in schema constants\n- pkg/types/link.go (create) - Link struct, link type constants (belongs_to, child_of, branches_from, scoped_to)\n- pkg/types/stash.go (create) - Stash struct, StashHistoryEntry struct, stash type constants, stash methods\n- pkg/types/errors.go (create) - Entity-specific errors not already in table.go (ErrInvalidState, ErrInvalidTransition, ErrInvalidName, ErrPropertyNotFound, ErrTypeMismatch, ErrInvalidCategory, etc.)\n\n## Requirements\n- Crumb property methods per prd003 R5: SetProperty, GetProperty, GetProperties, ClearProperty\n- Trail struct per prd006: TrailID, State, CreatedAt, CompletedAt (*time.Time); Complete(), Abandon() methods\n- Property and Category structs per prd004\n- Metadata struct per prd005\n- Link struct with link type constants per prd007\n- Stash and StashHistoryEntry structs per prd008\n- All entity-specific sentinel errors from prd001 R7.3\n\n## Design Decisions\n- Keep entity errors centralized in errors.go for discoverability\n- Property methods on Crumb do basic checks (key exists in map); full validation deferred to Table.Set\n- Trail.Complete requires active state; Trail.Abandon requires active state per prd006\n\n## Acceptance Criteria\n- [ ] Crumb property methods compile and modify Properties map\n- [ ] Trail struct with lifecycle methods compiles\n- [ ] Property, Category, Metadata, Link, Stash structs all compile with correct fields\n- [ ] All entity-specific errors defined\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.858479-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:27:10.750698-05:00","closed_at":"2026-02-12T07:27:10.750698-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-eow","depends_on_id":"generation-2026-02-12-07-13-55-g72","type":"blocks","created_at":"2026-02-12T07:18:37.012621-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-fg1","title":"Update SPECIFICATIONS.md after completing rel02.1","description":"## Required Reading\n- docs/SPECIFICATIONS.md (current specifications summary)\n- docs/road-map.yaml (updated with rel02.1 done)\n- .claude/rules/specification-format.md (specification document format)\n- All rel02.1 use cases and test suites\n\n## Files to Create/Modify\n- docs/SPECIFICATIONS.md (modify) — regenerate to reflect rel02.1 completion\n\n## Requirements\n- Update roadmap summary table to show rel02.1 as done (4/4 use cases)\n- Verify all use cases in use case index reflect correct status\n- Verify traceability diagram includes all rel02.1 artifacts\n- Check for coverage gaps (should be none for rel02.1)\n- Regenerate by reading all files in specs/ and road-map.yaml\n- Do not rely on stale content from previous SPECIFICATIONS.md\n\n## Design Decisions\n- SPECIFICATIONS.md is a generated artifact, regenerate fully\n- Include all PRDs, use cases, test suites in indexes\n- Traceability diagram shows relationships between artifacts\n- Coverage gaps section lists any missing test suites or untraced PRDs\n\n## Acceptance Criteria\n- [ ] Roadmap summary shows rel02.1 as done with 4/4 use cases\n- [ ] Use case index shows all rel02.1 use cases as done\n- [ ] PRD-to-use-case mapping includes all rel02.1 touchpoints\n- [ ] Traceability diagram includes rel02.1 artifacts\n- [ ] Coverage gaps section updated (should be empty for rel02.1)\n- [ ] File follows specification-format.md structure\n- [ ] Change committed with descriptive message","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:48.131317-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:06:38.27777-05:00","closed_at":"2026-02-13T01:06:38.27777-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-fg1","depends_on_id":"generation-2026-02-12-07-13-55-hcg","type":"blocks","created_at":"2026-02-12T22:15:48.998169-05:00","created_by":"petardjukic"}],"comments":[{"id":25,"issue_id":"generation-2026-02-12-07-13-55-fg1","author":"petardjukic","text":"duration: 3m28s | tokens: in=44 out=15003 | loc: +10 -10 files=2","created_at":"2026-02-13T06:06:38Z"}]}
{"id":"generation-2026-02-12-07-13-55-g72","title":"Define Crumb entity struct and state transition methods in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R1, R2, R4)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R7.3 for entity method errors)\n- pkg/types/table.go (error types already defined)\n\n## Files to Create/Modify\n- pkg/types/crumb.go (create) - Crumb struct, state constants, state transition methods\n\n## Requirements\n- Crumb struct: CrumbID (string), Name (string), State (string), CreatedAt (time.Time), UpdatedAt (time.Time), Properties (map[string]any)\n- State constants: draft, pending, ready, taken, pebble, dust\n- Valid states set for validation\n- SetState(state string) error: validates state is valid, updates State and UpdatedAt; idempotent; returns ErrInvalidState for invalid state\n- Pebble() error: requires current state is \"taken\", sets State to pebble, updates UpdatedAt; returns ErrInvalidTransition otherwise\n- Dust() error: sets State to dust from any state, updates UpdatedAt; idempotent\n\n## Design Decisions\n- State as string (not Go enum) for JSON compatibility per prd003 R2.4\n- Entity methods modify struct in memory; caller calls Table.Set to persist\n- Use a validStates map for O(1) lookup\n\n## Acceptance Criteria\n- [ ] Crumb struct has all 6 fields per prd003 R1.1\n- [ ] 6 state constants defined\n- [ ] SetState validates and transitions correctly\n- [ ] Pebble requires \"taken\" state, returns ErrInvalidTransition otherwise\n- [ ] Dust works from any state, is idempotent\n- [ ] All methods update UpdatedAt\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.726714-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:22:46.725029-05:00","closed_at":"2026-02-12T07:22:46.725029-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-g72","depends_on_id":"generation-2026-02-12-07-13-55-57l","type":"blocks","created_at":"2026-02-12T07:18:36.913338-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-gi1","title":"Complete link CRUD test coverage (belongs_to, child_of)","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (test cases TC2-TC6)\n- docs/specs/product-requirements/prd007-links-interface.yaml (R1-R3: Link struct, types, CRUD)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (flow F1-F6)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (existing test structure)\n- internal/sqlite/links_table.go (implementation to test)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (add test cases for S2, S3)\n\n## Requirements\nImplement integration test cases validating:\n1. belongs_to link creation and verification (success criterion S2)\n   - Create crumb and trail\n   - Create belongs_to link (from_id=crumb_id, to_id=trail_id)\n   - Verify link fields: link_type, from_id, to_id, created_at\n   - Verify link is retrievable via Table.Get\n2. child_of link creation and verification (success criterion S3)\n   - Create parent and child crumbs\n   - Create child_of link (from_id=child, to_id=parent)\n   - Verify link establishes crumb hierarchy\n   - Verify link is retrievable via Table.Get\n\nTest cases must follow table-driven pattern and validate prd007-links-interface R2 (link types and semantics).\n\n## Design Decisions\n- Use existing test helpers (newAttachedBackend, createTestCrumb, createTestTrail)\n- Follow existing test naming: TestLinkManagement_\u003cScenario\u003e\n- Each test case creates its own prerequisite entities to ensure isolation\n- Validate both successful link creation and retrieval in each test\n\n## Acceptance Criteria\n- [ ] TestLinkManagement_BelongsToLinkAssociatesCrumbWithTrail passes\n- [ ] TestLinkManagement_ChildOfLinkEstablishesCrumbHierarchy passes\n- [ ] Both test cases verify all Link struct fields (LinkID, LinkType, FromID, ToID, CreatedAt)\n- [ ] Test cases follow table-driven pattern per go-style rule\n- [ ] Tests validate prd007-links-interface R2.1 semantics for belongs_to and child_of\n- [ ] All tests pass: go test -v ./tests/integration -run TestLinkManagement","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:41.867983-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:52:18.202605-05:00","closed_at":"2026-02-13T01:52:18.202605-05:00","close_reason":"Closed","comments":[{"id":37,"issue_id":"generation-2026-02-12-07-13-55-gi1","author":"petardjukic","text":"duration: 1m33s | tokens: in=27 out=4934 | loc: +77 -1 files=2","created_at":"2026-02-13T06:52:18Z"}]}
{"id":"generation-2026-02-12-07-13-55-grm","title":"Implement property auto-initialization on crumb creation","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R4 auto-initialization, R8 enforcement)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S4-S6 auto-init)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 4-6)\n- internal/sqlite/crumbs_table.go (Set method, lines 53-125)\n- internal/sqlite/properties_table.go (property operations, default value logic)\n- internal/sqlite/seed.go (built-in property seeding)\n- pkg/types/crumb.go (Crumb struct, Properties field)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_table.go (modify) — add auto-init in Set when creating new crumb (id == \"\")\n- internal/sqlite/crumbs_table_test.go (modify or create) — unit tests for auto-init\n\n## Requirements\n- When Set creates a new crumb (empty ID), query all defined properties\n- For each property, insert a crumb_properties row with the type default value\n- Type defaults per prd004: categorical=first category value, text=\"\", integer=0, boolean=false, timestamp=null, list=[]\n- Auto-init happens inside the Set transaction (atomic with crumb creation)\n- If crumb already has explicit property values in Properties map, do not override\n- Populate crumb.Properties map with initialized values before returning\n\n## Design Decisions\n- Auto-init runs within the same transaction as the INSERT\n- Query properties table for all defined properties, compute defaults using existing defaultValueJSON helper\n- Use INSERT OR IGNORE for crumb_properties to avoid conflicts\n- Only on create (id == \"\"), not on update\n\n## Acceptance Criteria\n- [ ] New crumb has all defined properties initialized with type defaults\n- [ ] Explicitly set property values are not overridden by defaults\n- [ ] Properties appear in Crumb.Properties map after Get\n- [ ] Unit tests verify auto-init for each value type\n- [ ] Existing crumb tests continue to pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.242959-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:16:10.083966-05:00","closed_at":"2026-02-12T18:16:10.083966-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-h6b","title":"Add scaffolding validation integration tests (rel01.0-uc004)","description":"## Required Reading\n- docs/specs/use-cases/rel01.0-uc004-scaffolding-validation.yaml (S1-S11 success criteria)\n- docs/specs/test-suites/test-rel01.0-uc004-scaffolding-validation.yaml (30 test cases)\n- pkg/types/ (entity structs: crumb.go, trail.go, property.go, category.go, stash.go, metadata.go, link.go)\n- pkg/types/cupboard.go (Cupboard and Table interfaces)\n- internal/sqlite/backend.go (SQLite backend satisfies Cupboard interface)\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc004_scaffolding_validation_test.go (create)\n- docs/road-map.yaml (modify) — mark rel01.0-uc004 as done\n\n## Requirements\n- S1-S2: Verify module path and go build succeeds\n- S3-S4: Verify cupboard version prints version string and lists use cases\n- S5: Compile-time checks for all 7 entity structs (Crumb, Trail, Property, Category, Stash, Metadata, Link)\n- S6-S8: Compile-time interface satisfaction (Table, Cupboard, SQLite backend)\n- S9: Standard table name constants exist for all 6 tables\n- S10-S11: GetTable succeeds for all 6 tables, returns ErrTableNotFound for unknown\n\n## Design Decisions\n- Use compile-time interface satisfaction checks (var _ Interface = (*Impl)(nil))\n- Use Go API (not CLI) for GetTable tests to complement existing CLI tests\n- Table-driven tests for entity struct compilation and GetTable\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S11 from the use case\n- [ ] All tests pass with go test ./tests/integration/... -run TestScaffoldingValidation\n- [ ] road-map.yaml updated to mark rel01.0-uc004 as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:31.830903-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:59:12.972563-05:00","closed_at":"2026-02-12T17:59:12.972563-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-hcg","title":"Update road-map.yaml to mark rel02.1-uc003 as done","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (use case to mark done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel02.1-uc003 status to done\n\n## Requirements\n- Change rel02.1-uc003-self-hosting status from \"not_started\" to \"done\"\n- Verify do-work.sh and make-work.sh scripts work end-to-end\n- Verify agent workflow documented in .claude/rules\n- Commit change with message referencing use case completion\n\n## Design Decisions\n- Only mark done after scripts validated and agent workflow documented\n- Atomic change (single use case status update)\n\n## Acceptance Criteria\n- [ ] rel02.1-uc003-self-hosting status is \"done\" in road-map.yaml\n- [ ] Scripts work end-to-end in integration test\n- [ ] Agent workflow documented\n- [ ] Change committed with descriptive message","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.99181-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:03:09.951243-05:00","closed_at":"2026-02-13T01:03:09.951243-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-hcg","depends_on_id":"generation-2026-02-12-07-13-55-01h","type":"blocks","created_at":"2026-02-12T22:15:48.896473-05:00","created_by":"petardjukic"}],"comments":[{"id":24,"issue_id":"generation-2026-02-12-07-13-55-hcg","author":"petardjukic","text":"duration: 1m1s | tokens: in=34 out=2353 | loc: +2 -2 files=2","created_at":"2026-02-13T06:03:09Z"}]}
{"id":"generation-2026-02-12-07-13-55-hlm","title":"Implement property backfill on property definition","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R5 backfill)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S7-S9 backfill)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 7-9)\n- internal/sqlite/properties_table.go (Set method, existing backfill logic)\n- internal/sqlite/crumbs_table.go (Fetch for all crumbs)\n\n## Files to Create/Modify\n- internal/sqlite/properties_table.go (modify) — verify and fix backfill logic in Set\n- internal/sqlite/properties_table_test.go (modify or create) — backfill-specific tests\n\n## Requirements\n- When Table.Set creates a new property (empty ID), backfill all existing crumbs with the property's type default\n- Insert crumb_properties row for each existing crumb that lacks a value for this property\n- Backfill must be atomic (within same transaction as property creation)\n- Backfill must not override existing values if a crumb already has this property\n- Verify existing backfill implementation handles edge cases: no crumbs exist, all crumbs already have value\n\n## Design Decisions\n- Backfill runs inside the property Set transaction\n- Use INSERT OR IGNORE to avoid overriding existing crumb_properties rows\n- Fetch all crumb IDs and batch-insert crumb_properties\n\n## Acceptance Criteria\n- [ ] Defining a new property backfills all existing crumbs with type default\n- [ ] Existing property values are not overridden during backfill\n- [ ] Backfill is atomic with property creation\n- [ ] Unit tests verify backfill with multiple existing crumbs\n- [ ] Unit tests verify no override of existing values","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.378307-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:19:29.006387-05:00","closed_at":"2026-02-12T18:19:29.006387-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-hlm","depends_on_id":"generation-2026-02-12-07-13-55-grm","type":"blocks","created_at":"2026-02-12T17:46:33.154782-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-hq6","title":"Create go-install use case test suite and validate module installability","description":"## Required Reading\n- docs/specs/use-cases/rel01.1-uc001-go-install.yaml (S1-S5 success criteria)\n- docs/specs/test-suites/test-rel01.1-uc001-go-install.yaml (if exists, otherwise create)\n- go.mod (module path, Go version)\n- cmd/cupboard/main.go (entry point)\n\n## Files to Create/Modify\n- docs/specs/test-suites/test-rel01.1-uc001-go-install.yaml (create if missing)\n- tests/integration/test_rel01_1_uc001_go_install_test.go (create)\n\n## Requirements\n- Create test suite YAML if it does not exist (per test-case-format rule)\n- Implement integration tests that validate:\n  - `go build ./cmd/cupboard` succeeds (S1 proxy — go install requires published module)\n  - `cupboard --help` prints usage showing available commands (S2)\n  - `cupboard init` creates data directory with JSONL files (S3)\n  - `cupboard set crumbs` and `cupboard list crumbs` round-trips a crumb (S4)\n  - No manual steps beyond build and run (S5)\n- Since we work offline, test `go build` instead of `go install` (module not published)\n\n## Design Decisions\n- Test go build as a proxy for go install since the module is not published yet\n- Verify --help output contains expected command names\n- Reuse test helpers from existing integration tests\n\n## Acceptance Criteria\n- [ ] Test suite YAML exists at docs/specs/test-suites/test-rel01.1-uc001-go-install.yaml\n- [ ] Integration test validates build, help, init, and round-trip\n- [ ] Tests pass with `go test ./tests/integration/... -run TestGoInstall`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.483161-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:09:39.809098-05:00","closed_at":"2026-02-12T15:09:39.809098-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-hto","title":"Update SPECIFICATIONS.md roadmap summary for completed release 03.1","description":"## Required Reading\n- docs/SPECIFICATIONS.md (specifications document)\n- docs/road-map.yaml (updated roadmap, dependency)\n- .claude/rules/specification-format.md (specification format rule)\n\n## Files to Create/Modify\n- docs/SPECIFICATIONS.md (update)\n\n## Requirements\nRegenerate the Roadmap Summary table in SPECIFICATIONS.md to reflect the completed release 03.1. Update the table row for release 03.1 from \"0 / 1\" use cases and \"not started\" status to \"1 / 1\" use cases and \"done\" status.\n\n## Design Decisions\n- Follow specification-format rule for table structure\n- Only update the Roadmap Summary table; do not modify other sections unless they reference release status\n\n## Acceptance Criteria\n- [ ] Roadmap Summary table updated with release 03.1 showing 1/1 use cases done\n- [ ] Release 03.1 status changed to \"done\"\n- [ ] Table formatting preserved\n- [ ] File saved and committed","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.84759-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:31:44.519487-05:00","closed_at":"2026-02-13T01:31:44.519487-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-hto","depends_on_id":"generation-2026-02-12-07-13-55-j67","type":"blocks","created_at":"2026-02-13T01:09:08.6282-05:00","created_by":"petardjukic"}],"comments":[{"id":33,"issue_id":"generation-2026-02-12-07-13-55-hto","author":"petardjukic","text":"duration: 49s | tokens: in=18 out=1986 | loc: +3 -3 files=2","created_at":"2026-02-13T06:31:44Z"}]}
{"id":"generation-2026-02-12-07-13-55-j67","title":"Mark rel03.1-uc001-self-hosting-with-epics as done in road-map.yaml","description":"## Required Reading\n- docs/road-map.yaml (roadmap status)\n- docs/specs/use-cases/rel03.1-uc001-self-hosting-with-epics.yaml (use case definition)\n- tests/integration/test_rel03_1_uc001_self_hosting_with_epics_test.go (completed tests, dependency)\n\n## Files to Create/Modify\n- docs/road-map.yaml (update)\n\n## Requirements\nUpdate the status of rel03.1-uc001-self-hosting-with-epics from \"not_started\" to \"done\" in road-map.yaml after all tests pass.\n\n## Design Decisions\nN/A - simple status update\n\n## Acceptance Criteria\n- [ ] rel03.1-uc001-self-hosting-with-epics status changed to \"done\" in road-map.yaml\n- [ ] Release 03.1 use cases count updated to 1/1 done\n- [ ] Release 03.1 status changed from \"not started\" to \"done\"\n- [ ] File saved and committed","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.713416-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:30:54.835107-05:00","closed_at":"2026-02-13T01:30:54.835107-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-j67","depends_on_id":"generation-2026-02-12-07-13-55-58c","type":"blocks","created_at":"2026-02-13T01:09:08.533991-05:00","created_by":"petardjukic"}],"comments":[{"id":32,"issue_id":"generation-2026-02-12-07-13-55-j67","author":"petardjukic","text":"duration: 41s | tokens: in=17 out=1534 | loc: +2 -2 files=2","created_at":"2026-02-13T06:30:54Z"}]}
{"id":"generation-2026-02-12-07-13-55-j7p","title":"Complete stash filtering, deletion, and history test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (test cases TC18-TC23)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R9: Filter map, R11: Deletion, R7: History)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (flow F18-F23)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (existing test structure)\n- internal/sqlite/stashes_table.go (Fetch, Delete, FetchStashHistory implementations)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (add test cases for S11, S12, S13, S14, S15)\n\n## Requirements\nImplement integration test cases validating:\n1. Fetch by stash_type filter (success criterion S11)\n   - Create stashes of multiple types\n   - Fetch with filter: {\"stash_type\": \"counter\"}\n   - Verify only counter stashes returned\n2. Fetch by name filter (success criterion S12)\n   - Create stashes with different names\n   - Fetch with filter: {\"name\": \"specific-stash\"}\n   - Verify only matching stash returned\n3. Delete stash (success criterion S13)\n   - Create a stash\n   - Call Table.Delete\n   - Verify subsequent Get returns ErrNotFound\n4. Stash history tracking (success criteria S14, S15)\n   - Create a stash (operation: create)\n   - Call SetValue (operation: set)\n   - Call Increment (operation: increment)\n   - Query history via FetchStashHistory\n   - Verify all three operations recorded with correct version, value snapshots\n   - Verify history entries ordered by version ascending\n\nTest cases must validate prd008-stash-interface R9 (filter keys), R11 (deletion), and R7 (history tracking).\n\n## Design Decisions\n- Use table-driven tests for various filter combinations\n- Validate history entries have correct version sequence (1, 2, 3)\n- Test FetchStashHistory returns entries ordered by version ascending\n- Verify each history entry has HistoryID, StashID, Version, Value, Operation, CreatedAt\n\n## Acceptance Criteria\n- [ ] TestStashOperations_FetchByStashTypeReturnsMatchingStashes passes (validates S11)\n- [ ] TestStashOperations_FetchByNameReturnsMatchingStash passes (validates S12)\n- [ ] TestStashOperations_DeleteRemovesStash passes (validates S13)\n- [ ] TestStashOperations_HistoryTracksAllMutations passes (validates S14)\n- [ ] TestStashOperations_HistoryOrderedByVersionAscending passes (validates S15)\n- [ ] Tests validate prd008-stash-interface R7.6 (FetchStashHistory method)\n- [ ] All tests pass: go test -v ./tests/integration -run TestStashOperations","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.81564-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:04:09.185841-05:00","closed_at":"2026-02-13T02:04:09.185841-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-j7p","depends_on_id":"generation-2026-02-12-07-13-55-sdw","type":"blocks","created_at":"2026-02-13T01:50:44.070086-05:00","created_by":"petardjukic"}],"comments":[{"id":44,"issue_id":"generation-2026-02-12-07-13-55-j7p","author":"petardjukic","text":"duration: 1m49s | tokens: in=29 out=5572 | loc: +125 -22 files=2","created_at":"2026-02-13T07:04:09Z"}]}
{"id":"generation-2026-02-12-07-13-55-kik","title":"Run full integration test suite and fix any failures","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (all test cases)\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (all test cases)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (all tests)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (all tests)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (fix failures)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (fix failures)\n- internal/sqlite/links_table.go (fix implementation bugs if needed)\n- internal/sqlite/stashes_table.go (fix implementation bugs if needed)\n\n## Requirements\n1. Run full integration test suite for rel03.0-uc002 and rel03.0-uc003\n2. Identify any test failures or panics\n3. Debug root causes (implementation bugs vs test bugs)\n4. Fix implementation or test issues\n5. Verify all tests pass\n6. Document any edge cases discovered during debugging\n\n## Design Decisions\n- Run tests with -v flag for verbose output\n- Use -run flag to isolate failing tests\n- Fix implementation bugs in internal/sqlite first\n- Fix test bugs in tests/integration second\n- Add debug logging if needed to diagnose issues\n- Use go test -race to catch race conditions\n\n## Acceptance Criteria\n- [ ] All link management tests pass: go test -v ./tests/integration -run TestLinkManagement\n- [ ] All stash operations tests pass: go test -v ./tests/integration -run TestStashOperations\n- [ ] No test failures, panics, or race conditions detected\n- [ ] Success criteria S1-S15 validated for both use cases\n- [ ] Test coverage for prd007-links-interface R1-R7 complete\n- [ ] Test coverage for prd008-stash-interface R1-R12 complete\n- [ ] All tests pass with -race flag: go test -race ./tests/integration","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:43.072431-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:11:12.274702-05:00","closed_at":"2026-02-13T02:11:12.274702-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-kik","depends_on_id":"generation-2026-02-12-07-13-55-j7p","type":"blocks","created_at":"2026-02-13T01:50:44.165039-05:00","created_by":"petardjukic"}],"comments":[{"id":46,"issue_id":"generation-2026-02-12-07-13-55-kik","author":"petardjukic","text":"duration: 1m48s | tokens: in=38 out=2368 | loc: +1 -1 files=1","created_at":"2026-02-13T07:11:12Z"}]}
{"id":"generation-2026-02-12-07-13-55-kyb","title":"Complete stash counter operations test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (test cases TC8-TC11)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R5: Counter operations)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (flow F8-F11)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (existing test structure)\n- pkg/types/stash.go (Increment method)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (add test cases for S5, S6)\n\n## Requirements\nImplement integration test cases validating:\n1. Increment with positive delta (success criterion S5)\n   - Create counter stash with initial value 0\n   - Call Increment(5)\n   - Verify returns 5 and Version increments\n   - Persist via Table.Set\n   - Retrieve and verify value is 5\n2. Increment with negative delta (success criterion S6)\n   - Create counter stash with value 10\n   - Call Increment(-3)\n   - Verify returns 7 and Version increments\n   - Persist and verify value is 7\n3. Multiple increments\n   - Create counter stash\n   - Call Increment(5), Increment(10), Increment(-2)\n   - Verify accumulated value is correct (13)\n4. Increment on non-counter type\n   - Create context stash\n   - Call Increment(1)\n   - Verify ErrInvalidStashType returned\n\nTest cases must validate prd008-stash-interface R5.2 (Increment method, type validation, version tracking).\n\n## Design Decisions\n- Use table-driven tests for various delta values (positive, negative, zero)\n- Validate Version increments on each Increment call\n- Test Increment error handling for non-counter types\n- Verify counter value persists correctly via Table.Set/Get roundtrip\n\n## Acceptance Criteria\n- [ ] TestStashOperations_IncrementWithPositiveDelta passes (validates S5)\n- [ ] TestStashOperations_IncrementWithNegativeDelta passes (validates S6)\n- [ ] TestStashOperations_MultipleIncrementsAccumulate passes\n- [ ] TestStashOperations_IncrementOnNonCounterReturnsError passes\n- [ ] Tests validate prd008-stash-interface R5.2 (Increment adds delta, increments Version)\n- [ ] All tests pass: go test -v ./tests/integration -run TestStashOperations","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.519452-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:01:24.342696-05:00","closed_at":"2026-02-13T02:01:24.342696-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-kyb","depends_on_id":"generation-2026-02-12-07-13-55-8ku","type":"blocks","created_at":"2026-02-13T01:50:43.881118-05:00","created_by":"petardjukic"}],"comments":[{"id":42,"issue_id":"generation-2026-02-12-07-13-55-kyb","author":"petardjukic","text":"duration: 1m27s | tokens: in=29 out=2919 | loc: +1 -1 files=1","created_at":"2026-02-13T07:01:24Z"}]}
{"id":"generation-2026-02-12-07-13-55-l8y","title":"Add integration tests for generic table CLI commands","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc004-generic-table-cli.yaml (test cases to implement)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (success criteria S1-S12)\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (existing test patterns)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (existing test patterns)\n- cmd/cupboard/get.go, set.go, list.go, delete.go (commands under test)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (create)\n\n## Requirements\n- Implement table-driven tests exercising the cupboard CLI binary via os/exec\n- Build cupboard binary in TestMain or test setup, use temp directory for data\n- Test cases per test suite YAML:\n  - Get: valid entity returns JSON (S1), missing entity exit 1 (S2), unknown table exit 1 with valid names (S3)\n  - Set: create with empty ID returns JSON with generated ID (S4), update with existing ID (S5), invalid JSON exit 1 (S6)\n  - List: all entities returns JSON array (S7), with State=draft filter (S8), invalid filter exit 1 (S9)\n  - Delete: removes entity prints confirmation (S10), missing entity exit 1 (S11)\n  - Cross-table: commands work for crumbs, trails, links (S12)\n- Each test case uses a fresh cupboard init in a temp directory\n\n## Design Decisions\n- Use os/exec.Command to run the built binary (true CLI integration test)\n- Build binary once in TestMain, store path in package-level var\n- Helper: runCupboard(t, args...) (stdout, stderr, exitCode) for clean test assertions\n\n## Acceptance Criteria\n- [ ] All 12 success criteria (S1-S12) have at least one test case\n- [ ] Tests use table-driven pattern\n- [ ] Tests build and run the cupboard binary via os/exec\n- [ ] Tests pass with `go test ./tests/integration/... -run TestGenericTableCLI`\n- [ ] Each test case is independent (uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.826149-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:36:29.82977-05:00","closed_at":"2026-02-12T12:36:29.82977-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-l8y","depends_on_id":"generation-2026-02-12-07-13-55-6rc","type":"blocks","created_at":"2026-02-12T12:08:18.937576-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-lgd","title":"Complete link update, deletion, and uniqueness test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (test cases TC15-TC18)\n- docs/specs/product-requirements/prd007-links-interface.yaml (R3.5: Delete, R5: Uniqueness, R1.5: Immutability)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (flow F15-F18)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (existing test structure)\n- internal/sqlite/links_table.go (Delete implementation, uniqueness check)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (add test cases for S9, S10, uniqueness)\n\n## Requirements\nImplement integration test cases validating:\n1. Link update (idempotent Set)\n   - Create a link\n   - Call Set with existing LinkID and updated fields\n   - Verify link is updated (prd007-links-interface R1.5: links are immutable after creation, but Set should be idempotent)\n2. Link deletion (success criterion S9)\n   - Create a link\n   - Call Table.Delete with link ID\n   - Verify subsequent Get returns ErrNotFound\n3. Delete nonexistent link (success criterion S10)\n   - Call Table.Delete with nonexistent ID\n   - Verify ErrNotFound returned\n4. Uniqueness constraint validation\n   - Create a link with (link_type, from_id, to_id)\n   - Attempt to create duplicate link with same (link_type, from_id, to_id)\n   - Verify error returned (prd007-links-interface R5.1, R5.2)\n\nTest cases must validate prd007-links-interface R5 (uniqueness constraint) and R7 (error handling).\n\n## Design Decisions\n- Use table-driven tests for delete scenarios\n- Validate error types with errors.Is per prd007-links-interface R7.2\n- Test uniqueness constraint for each link type\n- Verify Delete returns ErrInvalidID when id is empty\n\n## Acceptance Criteria\n- [ ] TestLinkManagement_SetWithExistingIDUpdatesLink passes (or verifies immutability error)\n- [ ] TestLinkManagement_DeleteRemovesLink passes\n- [ ] TestLinkManagement_DeleteNonexistentReturnsNotFound passes\n- [ ] TestLinkManagement_UniquenessConstraintEnforced passes\n- [ ] Tests validate prd007-links-interface R5.1 (unique link_type + from_id + to_id)\n- [ ] Tests validate prd007-links-interface R7 (error types: ErrNotFound, ErrInvalidID)\n- [ ] All tests pass: go test -v ./tests/integration -run TestLinkManagement","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.26211-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:58:51.4643-05:00","closed_at":"2026-02-13T01:58:51.4643-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-lgd","depends_on_id":"generation-2026-02-12-07-13-55-5n8","type":"blocks","created_at":"2026-02-13T01:50:43.78596-05:00","created_by":"petardjukic"}],"comments":[{"id":40,"issue_id":"generation-2026-02-12-07-13-55-lgd","author":"petardjukic","text":"duration: 1m47s | tokens: in=38 out=5296 | loc: +158 -1 files=2","created_at":"2026-02-13T06:58:51Z"}]}
{"id":"generation-2026-02-12-07-13-55-mdx","title":"Validate built-in property seeding on backend attach","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R3 built-in properties, R3.1-R3.5)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R3 startup, R3.4 built-in property seeding)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S1-S3 built-in properties exist after attach)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 1-3)\n- internal/sqlite/backend.go (Attach method)\n- internal/sqlite/properties_table.go (property operations)\n- pkg/types/property.go (Property struct)\n\n## Files to Create/Modify\n- internal/sqlite/seed.go (create) — built-in property seeding logic\n- internal/sqlite/seed_test.go (create) — unit tests for seeding\n\n## Requirements\n- On Attach, seed built-in properties if they do not already exist: priority (categorical), type (categorical), description (text), owner (text), labels (list)\n- Seed built-in categories for priority (highest, high, medium, low, lowest) and type (task, epic, bug, chore)\n- Seeding must be idempotent (re-attach does not duplicate properties)\n- Verify seeded properties are retrievable via GetTable(\"properties\").Fetch(nil)\n\n## Design Decisions\n- Extract seeding into seed.go to keep backend.go focused on lifecycle\n- Use Table.Set operations for seeding (dogfood the interface)\n- Check existence before inserting to ensure idempotency\n\n## Acceptance Criteria\n- [ ] After Attach, properties table contains 5 built-in properties\n- [ ] After Attach, categories exist for priority and type\n- [ ] Re-attach does not duplicate properties or categories\n- [ ] Unit tests cover seed and idempotency\n- [ ] go build ./cmd/cupboard succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.400236-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:26:04.288553-05:00","closed_at":"2026-02-12T15:26:04.288553-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-mdx","depends_on_id":"generation-2026-02-12-07-13-55-2ys","type":"blocks","created_at":"2026-02-12T14:57:07.581003-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-ny9","title":"Implement trails, links, and properties table accessors","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R5.5-R5.7 trail cascade, R12 table routing)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail entity)\n- docs/specs/product-requirements/prd007-links-interface.yaml (Link entity, types, uniqueness)\n- docs/specs/product-requirements/prd004-properties-interface.yaml (Property, Category entities)\n- internal/sqlite/crumbs_table.go (existing pattern)\n- internal/sqlite/jsonl.go (JSONL helpers)\n\n## Files to Create/Modify\n- internal/sqlite/trails_table.go (create) - trailsTable implementing Table; Get, Set (with cascade on state change: completed removes belongs_to links, abandoned cascades crumb deletion), Delete, Fetch\n- internal/sqlite/links_table.go (create) - linksTable implementing Table; Get, Set (validate uniqueness constraint link_type+from_id+to_id), Delete, Fetch (filter by link_type, from_id, to_id)\n- internal/sqlite/properties_table.go (create) - propertiesTable implementing Table; Get, Set (with backfill: creating property seeds defaults for all existing crumbs), Delete, Fetch\n\n## Requirements\n- trailsTable: hydrate/dehydrate Trail per prd002 R14.3; Set detects state change to completed (remove belongs_to links) or abandoned (cascade delete crumbs + their properties/metadata/links) per prd002 R5.6-R5.7\n- linksTable: hydrate/dehydrate Link per prd002 R14.6; Set validates uniqueness of (link_type, from_id, to_id); Fetch supports filter by link_type, from_id, to_id\n- propertiesTable: hydrate/dehydrate Property per prd002 R14.4; Set triggers backfill of crumb_properties for all existing crumbs when creating a new property\n- Each table persists to its JSONL file atomically\n\n## Design Decisions\n- Trail cascade runs inside the same SQLite transaction as the state update\n- Link uniqueness enforced at SQL level (UNIQUE constraint) and returned as appropriate error\n- Property backfill queries all crumbs and inserts default property values\n\n## Acceptance Criteria\n- [ ] trailsTable implements Table; cascade on completed/abandoned works\n- [ ] linksTable implements Table; uniqueness enforced\n- [ ] propertiesTable implements Table; backfill on creation works\n- [ ] All tables persist to JSONL atomically\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.260855-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:40:40.849524-05:00","closed_at":"2026-02-12T07:40:40.849524-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-ny9","depends_on_id":"generation-2026-02-12-07-13-55-a1t","type":"blocks","created_at":"2026-02-12T07:18:37.306381-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-p57","title":"Add integration tests for property enforcement (S1-S9)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S1-S9 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 1-9)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (integration test patterns)\n- internal/sqlite/seed.go (built-in property seeding)\n- internal/sqlite/crumbs_table.go (auto-init on creation)\n- internal/sqlite/properties_table.go (backfill on definition)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (create)\n\n## Requirements\n- Test built-in properties exist after attach (S1-S3): priority, type, description, owner, labels all present with correct value types\n- Test auto-initialization on crumb creation (S4-S6): new crumb has all properties initialized with type defaults\n- Test backfill on property definition (S7-S9): defining new property backfills all existing crumbs\n- Use table-driven tests mapping to YAML test cases\n- Test via Go API (Cupboard.GetTable, Table.Set/Get/Fetch)\n\n## Design Decisions\n- Integration tests use real SQLite backend with temp directories\n- Each test case starts from preconditions (fresh cupboard)\n- Verify property values by getting crumb and checking Properties map\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S9 from the use case\n- [ ] Tests use table-driven pattern\n- [ ] All tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] Tests are independent (each uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.514036-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:25:20.578965-05:00","closed_at":"2026-02-12T18:25:20.578965-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-p57","depends_on_id":"generation-2026-02-12-07-13-55-hlm","type":"blocks","created_at":"2026-02-12T17:46:33.255441-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-qg7","title":"Extract shared CLI helpers: attachBackend and entity JSON parsing","description":"## Required Reading\n- cmd/cupboard/get.go (after task 0 — backend initialization pattern)\n- cmd/cupboard/set.go (after task 1 — parseEntityJSON pattern)\n- cmd/cupboard/list.go (after task 2 — shared patterns)\n- cmd/cupboard/delete.go (after task 3 — shared patterns)\n- pkg/types/cupboard.go (standard table name constants)\n- pkg/types/*.go (all entity structs)\n\n## Files to Create/Modify\n- cmd/cupboard/helpers.go (create) — shared helper functions\n- cmd/cupboard/get.go (modify) — use shared helpers\n- cmd/cupboard/set.go (modify) — use shared helpers\n- cmd/cupboard/list.go (modify) — use shared helpers\n- cmd/cupboard/delete.go (modify) — use shared helpers\n\n## Requirements\n- Extract `attachBackend() (*sqlite.Backend, error)` that resolves data dir, creates backend, attaches with sqlite config\n- Extract `parseEntityJSON(tableName string, data []byte) (any, error)` that unmarshals JSON into the correct entity type based on table name\n- Extract `validTableNames` constant string for error messages listing valid tables\n- Deduplicate any repeated patterns across the four command files\n- Follow go-style rule: no duplicated code, extract when pattern appears twice\n\n## Acceptance Criteria\n- [ ] helpers.go contains attachBackend, parseEntityJSON, and validTableNames\n- [ ] All four commands (get, set, list, delete) use shared helpers\n- [ ] No duplicated backend initialization code across command files\n- [ ] All existing tests still pass\n- [ ] Each command file focuses on its specific logic only","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.259742-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:11:49.759987-05:00","closed_at":"2026-02-12T12:11:49.759987-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-qg7","depends_on_id":"generation-2026-02-12-07-13-55-vc2","type":"blocks","created_at":"2026-02-12T08:33:20.351836-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-r5w","title":"Update road-map.yaml to mark rel03.0 complete","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (now done)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (now done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (update release 03.0 use case status)\n\n## Requirements\nUpdate road-map.yaml to reflect completion of release 03.0:\n1. Change rel03.0-uc002 status from \"not_started\" to \"done\"\n2. Change rel03.0-uc003 status from \"not_started\" to \"done\"\n3. Verify all four use cases in release 03.0 are now marked \"done\"\n4. Verify done_when condition is met (\"An agent can explore implementation approaches with trails, abandoning failed attempts and completing successful ones\")\n\n## Design Decisions\n- Only update status fields (not descriptions or deliverables)\n- Verify no other changes needed in road-map.yaml\n- Follow YAML syntax per roadmap schema\n\n## Acceptance Criteria\n- [ ] rel03.0-uc002-link-management status: done\n- [ ] rel03.0-uc003-stash-operations status: done\n- [ ] All four use cases in release 03.0 marked done\n- [ ] YAML syntax valid (no parse errors)\n- [ ] File saved as docs/road-map.yaml","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:43.33117-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:13:26.403709-05:00","closed_at":"2026-02-13T02:13:26.403709-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-r5w","depends_on_id":"generation-2026-02-12-07-13-55-kik","type":"blocks","created_at":"2026-02-13T01:50:44.359137-05:00","created_by":"petardjukic"}],"comments":[{"id":48,"issue_id":"generation-2026-02-12-07-13-55-r5w","author":"petardjukic","text":"duration: 57s | tokens: in=28 out=2332 | loc: +1 -1 files=1","created_at":"2026-02-13T07:13:26Z"}]}
{"id":"generation-2026-02-12-07-13-55-rh1","title":"Create do-work.sh script for agent workflow (rel02.1-uc003)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (F5 do-work.sh script)\n- docs/specs/test-suites/test-rel02.1-uc003-self-hosting.yaml (do-work test cases)\n- docs/engineering/eng01-git-integration.md (git conventions)\n- docs/engineering/eng02-generation-workflow.md (generation lifecycle)\n- .claude/rules/beads-workflow.md (workflow reference)\n\n## Files to Create/Modify\n- scripts/do-work.sh (create) — agent workflow automation script\n\n## Requirements\n- Pick task: run `cupboard ready -n 1 --json --type task` and parse JSON to get task ID\n- Validate task exists and is in ready state\n- Create git worktree for the task (eng01 pattern)\n- Transition task to taken: `cupboard update \u003cid\u003e --status taken`\n- Invoke Claude Code or other agent with context\n- After agent completes, verify changes\n- Merge worktree back to main branch\n- Close task: `cupboard close \u003cid\u003e`\n- Clean up worktree\n- Handle errors at each step with meaningful messages\n- Exit 0 on success, non-zero on failure\n\n## Design Decisions\n- Script uses cupboard CLI commands, not library calls\n- All cupboard commands use --json for machine-readable output\n- Git worktree pattern per eng01-git-integration\n- Script is idempotent (can be re-run after failure)\n- Cleanup happens even on error (trap EXIT)\n\n## Acceptance Criteria\n- [ ] Script picks a ready task via cupboard ready\n- [ ] Script creates git worktree for task\n- [ ] Script transitions task to taken state\n- [ ] Script can invoke agent (placeholder for now)\n- [ ] Script merges worktree after completion\n- [ ] Script closes task on success\n- [ ] Script cleans up worktree on exit\n- [ ] Script handles errors and exits non-zero\n- [ ] Script uses --json flag for all cupboard commands","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:46.509891-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:39:28.084206-05:00","closed_at":"2026-02-13T00:39:28.084206-05:00","close_reason":"Closed","comments":[{"id":16,"issue_id":"generation-2026-02-12-07-13-55-rh1","author":"petardjukic","text":"duration: 1m51s | tokens: in=48 out=5158 | loc: +279 -1 files=2","created_at":"2026-02-13T05:39:27Z"}]}
{"id":"generation-2026-02-12-07-13-55-rpi","title":"Implement configuration loading with platform defaults and precedence chain","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R1-R2 directory structure, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (flow F1-F7, success criteria S1-S9)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R6 global flags)\n- cmd/cupboard/root.go (existing resolveDataDir, global flags)\n\n## Files to Create/Modify\n- internal/paths/paths.go (create) — platform-specific default paths and resolution functions\n- internal/paths/paths_test.go (create) — unit tests for path resolution\n- cmd/cupboard/root.go (modify) — replace resolveDataDir with paths.ResolveDataDir, add resolveConfigDir\n\n## Requirements\n- Implement DefaultConfigDir() and DefaultDataDir() per prd010 R1.2 and R2.2:\n  - Linux: XDG_CONFIG_HOME/crumbs and XDG_DATA_HOME/crumbs (fallback ~/.config/crumbs and ~/.local/share/crumbs)\n  - macOS: ~/Library/Application Support/crumbs (both config and data)\n  - Windows: %APPDATA%/crumbs (both config and data)\n- Implement ResolveConfigDir(flag, env string) string: flag \u003e CRUMBS_CONFIG_DIR env \u003e DefaultConfigDir()\n- Implement ResolveDataDir(flag, configYAMLValue, env string) string: flag \u003e config.yaml data_dir \u003e CRUMBS_DATA_DIR env \u003e DefaultDataDir()\n- For CWD-relative defaults: when --data-dir is empty and no config or env override, use $(CWD)/.crumbs-db (current behavior preserved)\n\n## Design Decisions\n- Use runtime.GOOS for platform detection\n- Use os.UserHomeDir() and os.UserConfigDir() for cross-platform home paths\n- Keep CWD-relative defaults as the primary mode (matching current behavior); platform defaults are used only when env/flag overrides are provided\n\n## Acceptance Criteria\n- [ ] DefaultConfigDir returns correct path per platform\n- [ ] DefaultDataDir returns correct path per platform\n- [ ] ResolveConfigDir follows flag \u003e env \u003e default precedence\n- [ ] ResolveDataDir follows flag \u003e config \u003e env \u003e default precedence\n- [ ] Unit tests verify each precedence level\n- [ ] root.go resolveDataDir uses the new paths package","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.528459-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:20:28.056822-05:00","closed_at":"2026-02-12T12:20:28.056822-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-sdw","title":"Complete stash lock operations test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (test cases TC12-TC17)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R6: Lock operations)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (flow F12-F17)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (existing test structure)\n- pkg/types/stash.go (Acquire and Release methods)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (add test cases for S7, S8, S9)\n\n## Requirements\nImplement integration test cases validating:\n1. Acquire lock (success criterion S7)\n   - Create lock stash with nil value\n   - Call Acquire('worker-1')\n   - Verify success, Version increments, Value contains holder and acquired_at\n   - Persist via Table.Set\n2. Reentrant acquire (success criterion S8)\n   - Create lock stash, acquire by 'worker-1'\n   - Call Acquire('worker-1') again\n   - Verify success without error (reentrant)\n3. Lock contention (success criterion S7)\n   - Create lock stash, acquire by 'worker-1'\n   - Call Acquire('worker-2')\n   - Verify ErrLockHeld returned\n4. Release lock (success criterion S9)\n   - Create lock stash, acquire by 'worker-1'\n   - Call Release('worker-1')\n   - Verify success, Value is nil, Version increments\n5. Wrong holder release\n   - Create lock stash, acquire by 'worker-1'\n   - Call Release('worker-2')\n   - Verify ErrNotLockHolder returned\n\nTest cases must validate prd008-stash-interface R6.2, R6.3 (Acquire/Release semantics, reentrant, error handling).\n\n## Design Decisions\n- Use table-driven tests for various lock scenarios\n- Validate Version increments on Acquire and Release\n- Test reentrant acquire (same holder)\n- Test lock contention (different holder)\n- Validate error types with errors.Is\n\n## Acceptance Criteria\n- [ ] TestStashOperations_AcquireSetsHolderAndIncrementsVersion passes (validates S7)\n- [ ] TestStashOperations_AcquireByCurrentHolderSucceeds passes (validates S8, reentrant)\n- [ ] TestStashOperations_AcquireByDifferentHolderReturnsLockHeld passes (validates S7)\n- [ ] TestStashOperations_ReleaseUnsetsLockAndIncrementsVersion passes (validates S9)\n- [ ] TestStashOperations_ReleaseByWrongHolderReturnsNotLockHolder passes\n- [ ] Tests validate prd008-stash-interface R6.2, R6.3 (Acquire/Release, reentrant, errors)\n- [ ] All tests pass: go test -v ./tests/integration -run TestStashOperations","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.685173-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:02:19.912764-05:00","closed_at":"2026-02-13T02:02:19.912764-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-sdw","depends_on_id":"generation-2026-02-12-07-13-55-kyb","type":"blocks","created_at":"2026-02-13T01:50:43.975705-05:00","created_by":"petardjukic"}],"comments":[{"id":43,"issue_id":"generation-2026-02-12-07-13-55-sdw","author":"petardjukic","text":"duration: 55s | tokens: in=21 out=2675 | loc: +1 -1 files=1","created_at":"2026-02-13T07:02:19Z"}]}
{"id":"generation-2026-02-12-07-13-55-u5h","title":"Implement issue-tracking CLI ready and show commands","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4.2 ready, R4.5 show commands)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F2 ready, F5 show, S3-S4, S7)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases 4-5, 8)\n- cmd/cupboard/list.go (list command for reference)\n- cmd/cupboard/get.go (get command for reference)\n\n## Files to Create/Modify\n- cmd/cupboard/ready.go (create) — ready command (list open crumbs)\n- cmd/cupboard/show.go (create) — show command (display crumb details with properties)\n- cmd/cupboard/root.go (modify) — register ready and show commands\n\n## Requirements\n- `cupboard ready [--type \u003ctype\u003e] [--json]` — list crumbs in ready state, optionally filtered by type\n- `cupboard show \u003cid\u003e [--json]` — display crumb with all properties, metadata, and links\n- ready outputs table format by default (id, type, title, priority) or JSON with --json\n- show outputs human-readable detail by default or JSON with --json\n- Exit 1 if show receives nonexistent ID\n\n## Design Decisions\n- ready filters by state=ready using Table.Fetch\n- show combines data from crumbs table, properties, and metadata\n- Reuse attachBackend helper\n\n## Acceptance Criteria\n- [ ] `cupboard ready` lists crumbs in ready state\n- [ ] `cupboard ready --type task` filters by type property\n- [ ] `cupboard show \u003cid\u003e` displays crumb details with properties\n- [ ] `cupboard show \u003cinvalid-id\u003e` exits 1\n- [ ] Both commands support --json flag\n- [ ] Commands registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.481002-05:00","created_by":"petardjukic","updated_at":"2026-02-12T23:16:13.895338-05:00","closed_at":"2026-02-12T23:16:13.895338-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-u5h","depends_on_id":"generation-2026-02-12-07-13-55-0c8","type":"blocks","created_at":"2026-02-12T14:57:08.383706-05:00","created_by":"petardjukic"}],"comments":[{"id":14,"issue_id":"generation-2026-02-12-07-13-55-u5h","author":"petardjukic","text":"duration: 3m1s | tokens: in=73 out=8324 | loc: +307 -1 files=5","created_at":"2026-02-13T04:16:13Z"}]}
{"id":"generation-2026-02-12-07-13-55-ugq","title":"Mark rel03.0-uc001-trail-exploration as done in road-map.yaml","description":"## Required Reading\n- docs/road-map.yaml (roadmap status)\n- docs/specs/use-cases/rel03.0-uc001-trail-exploration.yaml (use case definition)\n- tests/integration/test_rel03_0_uc001_trail_exploration_test.go (completed tests, dependency)\n\n## Files to Create/Modify\n- docs/road-map.yaml (update)\n\n## Requirements\nUpdate the status of rel03.0-uc001-trail-exploration from \"not_started\" to \"done\" in road-map.yaml after all tests pass.\n\n## Design Decisions\nN/A - simple status update\n\n## Acceptance Criteria\n- [ ] rel03.0-uc001-trail-exploration status changed to \"done\" in road-map.yaml\n- [ ] Release 03.0 use cases count updated to 3/4 done\n- [ ] File saved and committed","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.192413-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:23:23.840455-05:00","closed_at":"2026-02-13T01:23:23.840455-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-ugq","depends_on_id":"generation-2026-02-12-07-13-55-z5j","type":"blocks","created_at":"2026-02-13T01:09:08.057258-05:00","created_by":"petardjukic"}],"comments":[{"id":28,"issue_id":"generation-2026-02-12-07-13-55-ugq","author":"petardjukic","text":"duration: 43s | tokens: in=22 out=1558 | loc: +2 -2 files=2","created_at":"2026-02-13T06:23:23Z"}]}
{"id":"generation-2026-02-12-07-13-55-ukh","title":"Mark rel03.0-uc004-trail-crumb-lifecycle as done in road-map.yaml","description":"## Required Reading\n- docs/road-map.yaml (roadmap status)\n- docs/specs/use-cases/rel03.0-uc004-trail-crumb-lifecycle.yaml (use case definition)\n- tests/integration/test_rel03_0_uc004_trail_crumb_lifecycle_test.go (completed tests, dependency)\n\n## Files to Create/Modify\n- docs/road-map.yaml (update)\n\n## Requirements\nUpdate the status of rel03.0-uc004-trail-crumb-lifecycle from \"not_started\" to \"done\" in road-map.yaml after all tests pass.\n\n## Design Decisions\nN/A - simple status update\n\n## Acceptance Criteria\n- [ ] rel03.0-uc004-trail-crumb-lifecycle status changed to \"done\" in road-map.yaml\n- [ ] Release 03.0 use cases count updated to 4/4 done\n- [ ] Release 03.0 status changed from \"in progress\" to \"done\"\n- [ ] File saved and committed","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.321456-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:24:12.173515-05:00","closed_at":"2026-02-13T01:24:12.173515-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-ukh","depends_on_id":"generation-2026-02-12-07-13-55-bul","type":"blocks","created_at":"2026-02-13T01:09:08.167996-05:00","created_by":"petardjukic"}],"comments":[{"id":29,"issue_id":"generation-2026-02-12-07-13-55-ukh","author":"petardjukic","text":"duration: 48s | tokens: in=23 out=1875 | loc: +2 -2 files=2","created_at":"2026-02-13T06:24:12Z"}]}
{"id":"generation-2026-02-12-07-13-55-uss","title":"Implement generic table CLI delete command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.3 delete command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S10-S11 success criteria for delete)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n\n## Files to Create/Modify\n- cmd/cupboard/delete.go (create) — delete command implementation\n- cmd/cupboard/root.go (modify) — register delete command\n\n## Requirements\n- Implement `cupboard delete \u003ctable\u003e \u003cid\u003e` per prd009-cupboard-cli R3.3\n- Accept table name and entity ID as positional arguments (cobra.ExactArgs(2))\n- Call Table.Delete(id) and output \"Deleted \u003ctable\u003e/\u003cid\u003e\" on success\n- Exit 1 with \"entity not found\" for missing entity\n- Exit 1 with \"unknown table\" for invalid table name\n- Error messages to stderr\n\n## Design Decisions\n- Reuse attachBackend() helper from get command\n- Simple command: no JSON output needed for delete (human message only, unless --json flag added later)\n\n## Acceptance Criteria\n- [ ] `cupboard delete crumbs \u003cvalid-id\u003e` removes entity, prints confirmation, exit 0\n- [ ] `cupboard delete crumbs \u003cnonexistent-id\u003e` returns exit 1 with not-found message\n- [ ] `cupboard delete unknown-table \u003cid\u003e` returns exit 1 with valid table names\n- [ ] Cascade delete works (deleting crumb removes its properties, metadata, links)\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.125864-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:18:28.818797-05:00","closed_at":"2026-02-12T15:18:28.818797-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-uss","depends_on_id":"generation-2026-02-12-07-13-55-9eh","type":"blocks","created_at":"2026-02-12T08:33:20.253722-05:00","created_by":"petardjukic"}],"comments":[{"id":1,"issue_id":"generation-2026-02-12-07-13-55-uss","author":"petardjukic","text":"Duplicate of generation-2026-02-12-07-13-55-dc3 which already implemented the delete command. cmd/cupboard/delete.go exists and tests pass. Closing as stale.","created_at":"2026-02-12T20:18:25Z"}]}
{"id":"generation-2026-02-12-07-13-55-vc2","title":"Implement generic table CLI set command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.2 set command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S4-S6 success criteria for set)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n- internal/sqlite/crumbs_table.go (Set behavior: empty ID creates, existing ID updates)\n\n## Files to Create/Modify\n- cmd/cupboard/set.go (create) — set command implementation\n- cmd/cupboard/root.go (modify) — register set command\n\n## Requirements\n- Implement `cupboard set \u003ctable\u003e \u003cid\u003e \u003cjson\u003e` per prd009-cupboard-cli R3.2\n- Accept table name, ID, and JSON payload as positional arguments (cobra.ExactArgs(3))\n- Empty string ID (\"\") creates a new entity; non-empty ID updates existing\n- Parse JSON payload into appropriate entity struct based on table name\n- Call Table.Set(id, entity) and output the result as pretty-printed JSON\n- Exit 1 with parse error details for invalid JSON\n- Exit 1 with \"unknown table\" message for invalid table name\n- Error messages to stderr\n\n## Design Decisions\n- Need a `parseEntityJSON(tableName string, data []byte) (any, error)` function that unmarshals JSON into the correct entity type (*types.Crumb, *types.Trail, etc.) based on table name\n- Reuse attachBackend() helper from get command\n\n## Acceptance Criteria\n- [ ] `cupboard set crumbs \"\" '{\"Name\":\"Test\",\"State\":\"draft\"}'` creates crumb, returns JSON with CrumbID\n- [ ] `cupboard set crumbs \u003cid\u003e \u003cjson\u003e` updates existing crumb\n- [ ] `cupboard set crumbs \"\" '{invalid}'` returns exit 1 with parse error\n- [ ] `cupboard set unknown-table \"\" '{}'` returns exit 1 with valid table names\n- [ ] Works across table types: crumbs, trails, links, properties, metadata, stashes\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:18.85488-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:38:54.810489-05:00","closed_at":"2026-02-12T08:38:54.810489-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-vc2","depends_on_id":"generation-2026-02-12-07-13-55-9eh","type":"blocks","created_at":"2026-02-12T08:33:20.056952-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-xa1","title":"Add integration tests for regeneration compatibility (S1-S8)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S8 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases)\n- internal/sqlite/loader.go (JSONL loading with forward compat)\n- internal/sqlite/loader_test.go (unit-level forward compat tests from task 6)\n- tests/integration/test_rel01_1_uc002_jsonl_git_roundtrip_test.go (roundtrip test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc002_regeneration_compatibility_test.go (create)\n- docs/road-map.yaml (modify) — mark rel02.0-uc002 as done\n\n## Requirements\n- Test JSONL files with unknown fields load without error (S1-S2)\n- Test crumb data survives simulated regeneration cycle (S3-S4)\n- Test adding a new property to existing JSONL data works (S5)\n- Test removing a field from struct still loads old JSONL (S6)\n- Test JSONL files remain valid after write-back with new struct version (S8)\n\n## Design Decisions\n- Simulate regeneration by creating JSONL files with extra fields, then loading via Cupboard.Attach\n- Use real SQLite backend with temp directories\n- Test both loader.go directly and via full Cupboard.Attach cycle\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S8 from the use case\n- [ ] Tests pass with go test ./tests/integration/... -run TestRegenerationCompatibility\n- [ ] road-map.yaml updated to mark rel02.0-uc002 as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.783514-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:33:37.420193-05:00","closed_at":"2026-02-12T18:33:37.420193-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-xa1","depends_on_id":"generation-2026-02-12-07-13-55-7gs","type":"blocks","created_at":"2026-02-12T17:46:33.353106-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-xgh","title":"Update SPECIFICATIONS.md with rel03.0 status","description":"## Required Reading\n- docs/SPECIFICATIONS.md (current content)\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (now complete)\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (now complete)\n- docs/road-map.yaml (release 03.0 status)\n- .claude/rules/specification-format.md (SPECIFICATIONS format rules)\n\n## Files to Create/Modify\n- docs/SPECIFICATIONS.md (regenerate)\n\n## Requirements\nRegenerate SPECIFICATIONS.md to reflect completion of rel03.0-uc002 and rel03.0-uc003:\n1. Update Roadmap Summary table (release 03.0: 4/4 use cases done)\n2. Verify Use Case Index reflects correct status for rel03.0-uc002 and rel03.0-uc003 (done)\n3. Verify Test Suite Index includes test-rel03.0-uc002 and test-rel03.0-uc003\n4. Update PRD-to-Use-Case Mapping for prd007 and prd008\n5. Update Traceability Diagram to include rel03.0-uc002 and rel03.0-uc003\n6. Check Coverage Gaps section (should be empty if all use cases have test suites)\n\n## Design Decisions\n- Follow specification-format rule for structure and tables\n- Read all files in docs/specs/* to build accurate tables\n- Use PlantUML inline format for Traceability Diagram\n- Verify all links are relative paths from docs/\n\n## Acceptance Criteria\n- [ ] Roadmap Summary shows release 03.0 as 4/4 use cases done\n- [ ] Use Case Index shows rel03.0-uc002 and rel03.0-uc003 as done\n- [ ] Test Suite Index includes test-rel03.0-uc002 and test-rel03.0-uc003 with correct trace references\n- [ ] PRD-to-Use-Case Mapping includes prd007→rel03.0-uc002 and prd008→rel03.0-uc003\n- [ ] Traceability Diagram shows all PRDs, use cases, and test suites in release 03.0\n- [ ] Coverage Gaps section is empty or lists only unscheduled use cases\n- [ ] File follows specification-format rule (all required sections present)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:43.202012-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:12:28.555572-05:00","closed_at":"2026-02-13T02:12:28.555572-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-xgh","depends_on_id":"generation-2026-02-12-07-13-55-kik","type":"blocks","created_at":"2026-02-13T01:50:44.265032-05:00","created_by":"petardjukic"}],"comments":[{"id":47,"issue_id":"generation-2026-02-12-07-13-55-xgh","author":"petardjukic","text":"duration: 1m16s | tokens: in=29 out=3172 | loc: +3 -3 files=2","created_at":"2026-02-13T07:12:28Z"}]}
{"id":"generation-2026-02-12-07-13-55-xka","title":"Create make-work.sh script for issue creation (rel02.1-uc003)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (F6 make-work.sh script)\n- docs/specs/test-suites/test-rel02.1-uc003-self-hosting.yaml (make-work test cases)\n- .claude/rules/crumb-format.md (issue format)\n- scripts/do-work.sh (workflow script reference)\n\n## Files to Create/Modify\n- scripts/make-work.sh (create) — issue creation script\n\n## Requirements\n- Accept JSON file path as argument containing proposed issues\n- Read JSON file with array of issue objects (index, title, description, dependency)\n- For each issue, create crumb via `cupboard create --type task --title \"...\" --description \"...\"`\n- Parse JSON output to get created crumb ID\n- Store mapping of index to crumb ID for dependency resolution\n- If issue has dependency (dependency != -1), create child_of link\n- List existing issues: `cupboard list --json`\n- Display summary of created issues\n- Commit JSONL changes to git per eng01-git-integration\n- Exit 0 on success\n\n## Design Decisions\n- Script uses cupboard CLI commands via --json flag\n- Dependencies reference by index in input JSON, resolved to IDs\n- child_of links created via cupboard commands (or direct table access)\n- Script validates input JSON before processing\n- Dry-run mode supported with --dry-run flag\n\n## Acceptance Criteria\n- [ ] Script reads JSON file with proposed issues\n- [ ] Script creates crumbs via cupboard create for each issue\n- [ ] Script resolves dependencies and creates child_of links\n- [ ] Script lists created issues with IDs\n- [ ] Script commits JSONL files to git\n- [ ] Script validates JSON structure before processing\n- [ ] Script supports --dry-run mode\n- [ ] Script exits 0 on success, non-zero on error","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:46.824966-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:43:38.052841-05:00","closed_at":"2026-02-13T00:43:38.052841-05:00","close_reason":"Closed","comments":[{"id":17,"issue_id":"generation-2026-02-12-07-13-55-xka","author":"petardjukic","text":"duration: 4m9s | tokens: in=50 out=12144 | loc: +434 -1 files=2","created_at":"2026-02-13T05:43:37Z"}]}
{"id":"generation-2026-02-12-07-13-55-xxi","title":"Integration tests for SQLite backend: Cupboard lifecycle and crumbs CRUD","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc001-cupboard-lifecycle.yaml (all test cases)\n- docs/specs/test-suites/test-rel01.0-uc002-table-crud.yaml (all test cases)\n- docs/specs/test-suites/test-rel01.0-uc003-crumb-lifecycle.yaml (all test cases)\n- internal/sqlite/backend.go (SQLiteBackend)\n- internal/sqlite/crumbs_table.go (crumbsTable)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (create) - Table-driven tests: Attach with valid config, Attach with invalid config, Detach idempotent, GetTable for all standard names, GetTable for unknown name, operations after Detach return ErrCupboardDetached\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (create) - Table-driven tests: Set creates crumb with UUID v7, Get retrieves by ID, Get returns ErrNotFound, Delete removes crumb, Delete cascades, Fetch with empty filter, Fetch with state filter, Fetch with limit/offset, JSONL persistence after Set/Delete\n- tests/integration/test_rel01_0_uc003_crumb_lifecycle_test.go (create) - Table-driven tests: create draft crumb, transition through states, Pebble from taken, Pebble from non-taken fails, Dust from any state, persist and reload state\n\n## Requirements\n- Use t.TempDir() for DataDir isolation\n- Each test creates a fresh SQLiteBackend, Attaches, runs test cases, Detaches\n- Verify JSONL files are written correctly (read back and parse)\n- Test JSONL roundtrip: Attach, write data, Detach, delete cupboard.db, re-Attach, verify data loaded from JSONL\n- Use testify for assertions\n\n## Design Decisions\n- Integration tests in tests/integration/ per project layout\n- Each test suite file maps to one use case YAML\n- Table-driven tests with shared setup/teardown\n\n## Acceptance Criteria\n- [ ] Cupboard lifecycle tests cover attach/detach/error paths\n- [ ] CRUD tests cover all Table operations\n- [ ] Crumb lifecycle tests cover state machine\n- [ ] JSONL roundtrip test verifies data survives db deletion\n- [ ] All tests pass: go test ./tests/integration/...","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.681468-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:56:58.226051-05:00","closed_at":"2026-02-12T07:56:58.226051-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-xxi","depends_on_id":"generation-2026-02-12-07-13-55-6dx","type":"blocks","created_at":"2026-02-12T07:18:37.614696-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-12-07-13-55-yzx","title":"Implement property backfill on property definition","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R5 backfill)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S7-S9 backfill)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 7-9)\n- internal/sqlite/properties_table.go (Set method)\n- internal/sqlite/crumbs_table.go (Fetch for all crumbs)\n\n## Files to Create/Modify\n- internal/sqlite/properties_table.go (modify) — add backfill logic in Set when creating new property\n- internal/sqlite/properties_table_test.go (modify or create) — tests for backfill\n\n## Requirements\n- When Table.Set creates a new property (empty ID), backfill all existing crumbs with the property's type default\n- Insert crumb_properties row for each existing crumb that lacks a value for this property\n- Backfill must be atomic (within same transaction as property creation)\n- Backfill must not override existing values if a crumb already has this property\n\n## Design Decisions\n- Backfill runs inside the property Set transaction\n- Use INSERT OR IGNORE to avoid overriding existing crumb_properties rows\n- Fetch all crumb IDs and batch-insert crumb_properties in one SQL statement\n\n## Acceptance Criteria\n- [ ] Defining a new property backfills all existing crumbs with type default\n- [ ] Existing property values are not overridden during backfill\n- [ ] Backfill is atomic with property creation\n- [ ] Unit tests verify backfill with multiple existing crumbs\n- [ ] Unit tests verify no override of existing values","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.671983-05:00","created_by":"petardjukic","updated_at":"2026-02-12T23:02:25.258436-05:00","closed_at":"2026-02-12T23:02:25.258436-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-12-07-13-55-yzx","depends_on_id":"generation-2026-02-12-07-13-55-bpu","type":"blocks","created_at":"2026-02-12T14:57:07.780688-05:00","created_by":"petardjukic"}],"comments":[{"id":10,"issue_id":"generation-2026-02-12-07-13-55-yzx","author":"petardjukic","text":"duration: 2m15s | tokens: in=46 out=4419 | loc: +92 -1 files=2","created_at":"2026-02-13T04:02:25Z"}]}
{"id":"generation-2026-02-12-07-13-55-z0q","title":"Add crumbs table benchmark tests (rel01.0-uc005)","description":"## Required Reading\n- docs/specs/use-cases/rel01.0-uc005-crumbs-table-benchmarks.yaml (S1-S10 success criteria)\n- docs/specs/test-suites/test-rel01.0-uc005-crumbs-table-benchmarks.yaml (16 test cases)\n- internal/sqlite/crumbs_table.go (Get, Set, Delete, Fetch implementations)\n- internal/sqlite/backend.go (Attach for setup)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc005_crumbs_table_benchmarks_test.go (create)\n- docs/road-map.yaml (modify) — mark rel01.0-uc005 as done\n\n## Requirements\n- Benchmark Get at 4 scales: 10, 100, 1000, 10000 crumbs (S5)\n- Benchmark Set create at 2 scales: 10, 1000 existing crumbs (S6)\n- Benchmark Set update at 2 scales: 10, 1000 crumbs (S7)\n- Benchmark Delete at 2 scales: 10, 1000 crumbs (S8)\n- Benchmark Fetch all at 2 scales: 100, 1000 crumbs (S9)\n- Benchmark Fetch with state filter at 2 scales: 100, 1000 crumbs (S10)\n- Each benchmark reports ns/op, B/op, allocs/op (S1-S4)\n\n## Design Decisions\n- Use Go benchmark framework (testing.B) with -benchmem\n- Use StopTimer/StartTimer for Delete to exclude setup cost\n- Random ID selection for Get/Update benchmarks\n- Each benchmark function creates a fresh cupboard with temp directory\n\n## Acceptance Criteria\n- [ ] 16 benchmark functions covering all operations and scales\n- [ ] Benchmarks run with go test ./tests/integration/... -bench=BenchmarkCrumbs -benchmem\n- [ ] road-map.yaml updated to mark rel01.0-uc005 as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:31.968722-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:04:53.362107-05:00","closed_at":"2026-02-12T18:04:53.362107-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-12-07-13-55-z5j","title":"Implement integration tests for rel03.0-uc001-trail-exploration","description":"## Required Reading\n- docs/specs/use-cases/rel03.0-uc001-trail-exploration.yaml (use case definition)\n- docs/specs/test-suites/test-rel03.0-uc001-trail-exploration.yaml (test cases to implement)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail entity contract)\n- docs/specs/product-requirements/prd007-links-interface.yaml (links semantics)\n- pkg/types/trail.go (Trail entity and Complete/Abandon methods)\n- internal/sqlite/trails_table.go (cascade implementation)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (table-driven test pattern example)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc001_trail_exploration_test.go (create)\n\n## Requirements\nImplement the 26 test cases from test-rel03.0-uc001-trail-exploration.yaml that validate:\n- Trail creation via Table.Set starts in draft state by default (TC01)\n- Trail state transitions from draft to active (TC02)\n- belongs_to links associate crumbs with trails (TC03-TC05)\n- Querying links table returns crumbs on that trail (TC06-TC07)\n- Deleting belongs_to link disassociates without deleting the crumb (TC08-TC10)\n- Trail.Abandon() then Table.Set deletes trail crumbs atomically (TC11-TC16)\n- Crumbs removed from trail before abandon survive (TC17-TC18)\n- Trail.Complete() then Table.Set removes belongs_to links (TC19-TC21)\n- Completed trail crumbs remain queryable (TC22-TC23)\n- Trail state is completed or abandoned after respective operations (TC24-TC26)\n\n## Design Decisions\n- Use Go table-driven tests per test-case-format rule: one TestTrailExploration function with subtests for each YAML test case\n- Each test case row has: name, setup (trail/crumb creation), operation (Complete/Abandon/query), and assertions\n- Share cupboard setup across test cases: create fresh temp dir, attach backend, get tables\n- Use testify/assert for assertions to match existing tests\n- Follow the pattern from test_rel01_0_uc002_table_crud_test.go for table-driven structure\n\n## Acceptance Criteria\n- [ ] All 26 test cases from test-rel03.0-uc001-trail-exploration.yaml implemented\n- [ ] Table-driven test structure with one row per test case\n- [ ] Tests pass: go test -v ./tests/integration -run TestTrailExploration\n- [ ] Test file saved as test_rel03_0_uc001_trail_exploration_test.go\n- [ ] Assertions verify success criteria S1-S10 from use case","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:06.92422-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:15:05.124872-05:00","closed_at":"2026-02-13T01:15:05.124872-05:00","close_reason":"Closed","comments":[{"id":26,"issue_id":"generation-2026-02-12-07-13-55-z5j","author":"petardjukic","text":"duration: 5m56s | tokens: in=38 out=24609 | loc: +1387 -1 files=2","created_at":"2026-02-13T06:15:05Z"}]}
