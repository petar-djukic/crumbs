{"id":"generation-2026-02-11-17-20-lr9","title":"Define Cupboard and Table interfaces with Config and error types in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (full PRD: Config, Cupboard, Table, errors)\n- docs/ARCHITECTURE.md § System Overview, § Main Interfaces, § Design Decisions (Decision 1, 9)\n- pkg/crumbs/version.go (existing public package)\n\n## Files to Create/Modify\n- pkg/types/config.go (create) — Config struct, SQLiteConfig struct, config validation errors (ErrBackendEmpty, ErrBackendUnknown, ErrSyncStrategyUnknown, ErrBatchSizeInvalid, ErrBatchIntervalInvalid), Validate() method\n- pkg/types/cupboard.go (create) — Cupboard interface (GetTable, Attach, Detach), standard table name constants (crumbs, trails, properties, metadata, links, stashes), cupboard lifecycle errors (ErrCupboardDetached, ErrAlreadyAttached, ErrTableNotFound)\n- pkg/types/table.go (create) — Table interface (Get, Set, Delete, Fetch), table operation errors (ErrNotFound, ErrInvalidID, ErrInvalidData), entity method errors (ErrInvalidState, ErrInvalidTransition, ErrInvalidName, ErrPropertyNotFound, ErrTypeMismatch, ErrInvalidCategory, ErrInvalidStashType, ErrLockHeld, ErrNotLockHolder, ErrInvalidHolder, ErrAlreadyInTrail, ErrNotInTrail, ErrSchemaNotFound, ErrInvalidContent, ErrInvalidFilter)\n\n## Requirements\n- Config struct with Backend (string) and DataDir (string) fields per R1.1\n- Config.Validate() method that fails per R1.2 (empty/unknown backend) and R1.3 (empty DataDir for sqlite)\n- Config validation errors as sentinel errors per R1.4\n- Cupboard interface with GetTable(name string) (Table, error), Attach(config Config) error, Detach() error per R2.1-R2.2\n- Standard table name constants (\"crumbs\", \"trails\", \"properties\", \"metadata\", \"links\", \"stashes\") per R2.5\n- Table interface with Get(id string) (any, error), Set(id string, data any) (string, error), Delete(id string) error, Fetch(filter map[string]any) ([]any, error) per R3.1\n- All sentinel errors from R7.1 (cupboard.go), R7.2 (table.go), R7.3 (table.go)\n- All errors must work with errors.Is per constraints\n\n## Design Decisions\n- pkg/types holds only interfaces and types, no implementation (go-style rule: pkg/ is shared public API)\n- Use sentinel errors (var Err... = errors.New(\"...\")) per prd001 R7\n- Table name constants as string constants, not an enum type\n- No SQLiteConfig fields yet (defer to prd002-sqlite-backend task); include the struct as a placeholder with a comment\n\n## Acceptance Criteria\n- [ ] Config struct compiles with Backend and DataDir fields\n- [ ] Config.Validate() returns appropriate errors for empty backend, unknown backend, empty DataDir\n- [ ] Cupboard interface compiles with GetTable, Attach, Detach signatures\n- [ ] Table interface compiles with Get, Set, Delete, Fetch signatures matching prd001 R3\n- [ ] All 6 standard table names defined as constants\n- [ ] All 18 sentinel errors defined and usable with errors.Is\n- [ ] go build ./... passes\n- [ ] go vet ./... passes","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-11T17:23:38.201524-05:00","created_by":"petardjukic","updated_at":"2026-02-11T17:26:44.984707-05:00","closed_at":"2026-02-11T17:26:44.984707-05:00","close_reason":"Closed"}
