{"id":"generation-2026-02-11-21-06-10-4lq","title":"Define Cupboard and Table interfaces with Config and sentinel errors in pkg/","description":"## Required Reading\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (full PRD: Config struct R1, Cupboard interface R2, Table interface R3, error types R7, UUID v7 R8)\n- docs/ARCHITECTURE.md § System Overview, § Main Interfaces, § Design Decisions (Decision 1: Interface Design, Decision 2: Table Accessor Pattern)\n- docs/specs/use-cases/rel01.0-uc001-cupboard-lifecycle.yaml (validates these interfaces)\n- docs/specs/use-cases/rel01.0-uc004-scaffolding-validation.yaml (validates compilation and table names)\n\n## Files to Create/Modify\n- pkg/types/config.go (create) — Config struct with Backend and DataDir fields, config validation function, config validation errors (ErrBackendEmpty, ErrBackendUnknown, ErrSyncStrategyUnknown, ErrBatchSizeInvalid, ErrBatchIntervalInvalid)\n- pkg/types/cupboard.go (create) — Cupboard interface (GetTable, Attach, Detach), cupboard lifecycle errors (ErrCupboardDetached, ErrAlreadyAttached, ErrTableNotFound), standard table name constants\n- pkg/types/table.go (create) — Table interface (Get, Set, Delete, Fetch), table operation errors (ErrNotFound, ErrInvalidID, ErrInvalidData), entity method errors (ErrInvalidState, ErrInvalidTransition, ErrInvalidName, ErrPropertyNotFound, ErrTypeMismatch, ErrInvalidCategory, ErrInvalidStashType, ErrLockHeld, ErrNotLockHolder, ErrInvalidHolder, ErrAlreadyInTrail, ErrNotInTrail, ErrSchemaNotFound, ErrInvalidContent, ErrInvalidFilter), Filter type alias\n- pkg/types/doc.go (create) — Package documentation linking to prd001-cupboard-core\n\n## Requirements\n- Define Config struct per prd001 R1 (Backend string, DataDir string)\n- Define Config.Validate() method per prd001 R1.2-R1.4\n- Define Cupboard interface per prd001 R2 (GetTable, Attach, Detach)\n- Define Table interface per prd001 R3 (Get, Set returning (string, error), Delete, Fetch)\n- Define Filter type alias (map[string]any) per prd003 R9.1\n- Define all sentinel errors per prd001 R7 (cupboard lifecycle errors in cupboard.go, table operation and entity method errors in table.go, config validation errors in config.go)\n- Define standard table name constants per prd001 R2.5 (crumbs, trails, properties, metadata, links, stashes)\n- All errors must be sentinel errors compatible with errors.Is\n\n## Design Decisions\n- pkg/types/ is the shared contract layer: interfaces only, no implementation\n- Follow Go conventions: accept interfaces, return concrete types\n- Table interface uses any for entity types (callers type-assert)\n- Config uses struct (not interface) since it is data, not behavior\n- Error variables use var (not const) per Go idiom for sentinel errors\n- Standard table names as string constants for compile-time checks\n\n## Acceptance Criteria\n- [ ] Config struct has Backend and DataDir fields\n- [ ] Config.Validate() returns appropriate errors for empty backend, unknown backend, empty DataDir\n- [ ] Cupboard interface has GetTable(string) (Table, error), Attach(Config) error, Detach() error\n- [ ] Table interface has Get(string) (any, error), Set(string, any) (string, error), Delete(string) error, Fetch(map[string]any) ([]any, error)\n- [ ] All 20 sentinel errors defined and checkable with errors.Is\n- [ ] Standard table name constants defined (6 names)\n- [ ] Filter type alias defined\n- [ ] go build ./pkg/types/ compiles without errors\n- [ ] Package doc comment references prd001-cupboard-core","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-11T21:09:11.709133-05:00","created_by":"petardjukic","updated_at":"2026-02-11T21:09:11.709133-05:00"}
